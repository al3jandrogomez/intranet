
(function(j){if(typeof j.org==="undefined"){j.org={}}else{if(typeof j.org!=="object"){throw new Error("Name org already exists and it's not an object")}}if(typeof j.org.pkijs==="undefined"){j.org.pkijs={}}else{if(typeof j.org.pkijs!=="object"){throw new Error("Name org.pkijs already exists and it's not an object but "+(typeof j.org.pkijs))}}if(typeof j.org.pkijs.asn1==="undefined"){j.org.pkijs.asn1={}}else{if(typeof j.org.pkijs.asn1!=="object"){throw new Error("Name org.pkijs.asn1 already exists and it's not an object but "+(typeof j.org.pkijs.asn1))}}var h={};function d(n,o){var m=0;for(var p=(n.length-1);p>=0;p--){m+=n[(n.length-1)-p]*Math.pow(2,o*p)}return m}function e(u,n,o){o=o||(-1);var v=0;var q=Math.pow(2,n);for(var s=1;s<8;s++){if(u<q){var m;if(o<0){m=new ArrayBuffer(s);v=s}else{if(o<s){return(new ArrayBuffer(0))}m=new ArrayBuffer(o);v=o}var p=new Uint8Array(m);for(var r=(s-1);r>=0;r--){var t=Math.pow(2,r*n);p[v-r-1]=Math.floor(u/t);u-=(p[v-r-1])*t}return m}q*=Math.pow(2,n)}}function a(u){var q=(u<0)?(u*(-1)):u;var m=128;for(var t=1;t<8;t++){if(q<=m){if(u<0){var s=m-q;var o=e(s,8,t);var p=new Uint8Array(o);p[0]|=128;return o}else{var o=e(q,8,t);var p=new Uint8Array(o);if(p[0]&128){var n=i(o);var v=new Uint8Array(n);o=new ArrayBuffer(o.byteLength+1);p=new Uint8Array(o);for(var r=0;r<n.byteLength;r++){p[r+1]=v[r]}p[0]=0}return o}}m*=Math.pow(2,8)}return(new ArrayBuffer(0))}function b(){var q=new Uint8Array(this.value_hex);if(this.value_hex.byteLength>=2){var w=(q[0]==255)&&(q[1]&128);var v=(q[0]==0)&&((q[1]&128)==0);if(w||v){this.warnings.push("Needlessly long format")}}var o=new ArrayBuffer(this.value_hex.byteLength);var u=new Uint8Array(o);for(var t=0;t<this.value_hex.byteLength;t++){u[t]=0}u[0]=(q[0]&128);var n=d(u,8);var p=new ArrayBuffer(this.value_hex.byteLength);var m=new Uint8Array(p);for(var s=0;s<this.value_hex.byteLength;s++){m[s]=q[s]}m[0]&=127;var r=d(m,8);return(r-n)}function i(m){if(f(m,0,m.byteLength)===false){return(new ArrayBuffer(0))}var p=new Uint8Array(m);var q=new ArrayBuffer(m.byteLength);var o=new Uint8Array(q);for(var n=0;n<m.byteLength;n++){o[n]=p[n]}return q}function l(m,s,p){if(f(m,s,p)===false){return(new ArrayBuffer(0))}var q=new Uint8Array(m,s,p);var r=new ArrayBuffer(p);var o=new Uint8Array(r);for(var n=0;n<p;n++){o[n]=q[n]}return r}function k(q,n){var r=new Uint8Array(q);var p=new Uint8Array(n);var t=new ArrayBuffer(q.byteLength+n.byteLength);var s=new Uint8Array(t);for(var o=0;o<q.byteLength;o++){s[o]=r[o]}for(var m=0;m<n.byteLength;m++){s[q.byteLength+m]=p[m]}return t}function f(m,o,n){if((m instanceof ArrayBuffer)===false){this.error='Wrong parameter: input_buffer must be "ArrayBuffer"';return false}if(m.byteLength===0){this.error="Wrong parameter: input_buffer has zero length";return false}if(o<0){this.error="Wrong parameter: input_offset less than zero";return false}if(n<0){this.error="Wrong parameter: input_length less than zero";return false}if((m.byteLength-o-n)<0){this.error="End of input reached before message was fully decoded (inconsistent offset and length values)";return false}return true}function g(n,s,p){if(f(n,s,p)===false){return""}var m="";var q=new Uint8Array(n,s,p);for(var o=0;o<q.length;o++){var r=q[o].toString(16).toUpperCase();m=m+((r.length===1)?" 0":" ")+r}return m}h.base_block=function(){if(arguments[0] instanceof Object){this.block_length=j.org.pkijs.getValue(arguments[0],"block_length",0);this.error=j.org.pkijs.getValue(arguments[0],"error",new String());this.warnings=j.org.pkijs.getValue(arguments[0],"warnings",new Array());if("value_before_decode" in arguments[0]){this.value_before_decode=i(arguments[0].value_before_decode)}else{this.value_before_decode=new ArrayBuffer(0)}}else{this.block_length=0;this.error=new String();this.warnings=new Array();this.value_before_decode=new ArrayBuffer(0)}};h.base_block.prototype.block_name=function(){return"base_block"};h.base_block.prototype.toJSON=function(){return{block_name:h.base_block.prototype.block_name.call(this),block_length:this.block_length,error:this.error,warnings:this.warnings,value_before_decode:j.org.pkijs.bufferToHexCodes(this.value_before_decode,0,this.value_before_decode.byteLength)}};h.hex_block=function(){h.base_block.call(this,arguments[0]);if(arguments[0] instanceof Object){this.is_hex_only=j.org.pkijs.getValue(arguments[0],"is_hex_only",false);if("value_hex" in arguments[0]){this.value_hex=i(arguments[0].value_hex)}else{this.value_hex=new ArrayBuffer(0)}}else{this.is_hex_only=false;this.value_hex=new ArrayBuffer(0)}};h.hex_block.prototype=new h.base_block();h.hex_block.constructor=h.hex_block;h.hex_block.prototype.block_name=function(){return"hex_block"};h.hex_block.prototype.fromBER=function(n,r,q){if(f.call(this,n,r,q)===false){return(-1)}var p=new Uint8Array(n,r,q);if(p.length==0){this.warnings.push("Zero buffer length");return r}this.value_hex=new ArrayBuffer(q);var m=new Uint8Array(this.value_hex);for(var o=0;o<p.length;o++){m[o]=p[o]}this.block_length=q;return(r+q)};h.hex_block.prototype.toBER=function(p){if(typeof p==="undefined"){p=false}if(this.is_hex_only!==true){this.error='Flag "is_hex_only" is not set, abort';return(new ArrayBuffer(0))}var q=new ArrayBuffer(this.value_hex.byteLength);if(p===true){return q}var o=new Uint8Array(q);var n=new Uint8Array(this.value_hex);for(var m=0;m<n.length;m++){o[m]=n[m]}return q};h.hex_block.prototype.toJSON=function(){var m=h.base_block.prototype.toJSON.call(this);m.block_name=h.hex_block.prototype.block_name.call(this);m.is_hex_only=this.is_hex_only;m.value_hex=j.org.pkijs.bufferToHexCodes(this.value_hex,0,this.value_hex.byteLength);return m};h.identification_block=function(){h.hex_block.call(this,arguments[0]);this.tag_class=(-1);this.tag_number=(-1);this.is_constructed=false;if(arguments[0] instanceof Object){if("id_block" in arguments[0]){this.is_hex_only=j.org.pkijs.getValue(arguments[0].id_block,"is_hex_only",false);this.value_hex=j.org.pkijs.getValue(arguments[0].id_block,"value_hex",new ArrayBuffer(0));this.tag_class=j.org.pkijs.getValue(arguments[0].id_block,"tag_class",(-1));this.tag_number=j.org.pkijs.getValue(arguments[0].id_block,"tag_number",(-1));this.is_constructed=j.org.pkijs.getValue(arguments[0].id_block,"is_constructed",false)}}};h.identification_block.prototype=new h.hex_block();h.identification_block.constructor=h.identification_block;h.identification_block.prototype.block_name=function(){return"identification_block"};h.identification_block.prototype.toBER=function(u){if(typeof u==="undefined"){u=false}var t=0;switch(this.tag_class){case 1:t|=0;break;case 2:t|=64;break;case 3:t|=128;break;case 4:t|=192;break;default:this.error="Unknown tag class";return(new ArrayBuffer(0))}if(this.is_constructed){t|=32}if((this.tag_number<31)&&(!this.is_hex_only)){var m=new ArrayBuffer(1);var p=new Uint8Array(m);if(!u){var q=this.tag_number;q&=31;t|=q;p[0]=t}return m}else{if(this.is_hex_only===false){var s=e(this.tag_number,7);var o=new Uint8Array(s);var v=s.byteLength;var m=new ArrayBuffer(v+1);var p=new Uint8Array(m);p[0]=(t|31);if(!u){for(var r=0;r<(v-1);r++){p[r+1]=o[r]|128}p[v]=o[v-1]}return m}else{var m=new ArrayBuffer(this.value_hex.byteLength+1);var p=new Uint8Array(m);p[0]=(t|31);if(u===false){var n=new Uint8Array(this.value_hex);for(var r=0;r<(n.length-1);r++){p[r+1]=n[r]|128}p[this.value_hex.byteLength]=n[n.length-1]}return m}}};h.identification_block.prototype.fromBER=function(x,w,s){if(f.call(this,x,w,s)===false){return(-1)}var v=new Uint8Array(x,w,s);if(v.length==0){this.error="Zero buffer length";return(-1)}var p=v[0]&192;switch(p){case 0:this.tag_class=(1);break;case 64:this.tag_class=(2);break;case 128:this.tag_class=(3);break;case 192:this.tag_class=(4);break;default:this.error="Unknown tag class";return(-1)}if((v[0]&32)==32){this.is_constructed=true}else{this.is_constructed=false}this.is_hex_only=false;var n=v[0]&31;if(n!=31){this.tag_number=(n);this.block_length=1}else{var r=1;this.value_hex=new ArrayBuffer(255);var u=255;var q=new Uint8Array(this.value_hex);while(v[r]&128){q[r-1]=v[r]&127;r++;if(r>=v.length){this.error="End of input reached before message was fully decoded";return(-1)}if(r==u){u+=255;var m=new ArrayBuffer(u);var t=new Uint8Array(m);for(var o=0;o<q.length;o++){t[o]=q[o]}this.value_hex=new ArrayBuffer(u);q=new Uint8Array(this.value_hex)}}this.block_length=(r+1);q[r-1]=v[r]&127;var m=new ArrayBuffer(r);var t=new Uint8Array(m);for(var o=0;o<r;o++){t[o]=q[o]}this.value_hex=new ArrayBuffer(r);q=new Uint8Array(this.value_hex);q.set(t);if(this.block_length<=9){this.tag_number=d(q,7)}else{this.is_hex_only=true;this.warnings.push("Tag too long, represented as hex-coded")}}if(((this.tag_class==1))&&(this.is_constructed)){switch(this.tag_number){case 1:case 2:case 5:case 6:case 9:case 14:case 23:case 24:case 31:case 32:case 33:case 34:this.error="Constructed encoding used for primitive type";return(-1);default:}}return(w+this.block_length)};h.identification_block.prototype.toJSON=function(){var m=h.hex_block.prototype.toJSON.call(this);m.block_name=h.identification_block.prototype.block_name.call(this);m.tag_class=this.tag_class;m.tag_number=this.tag_number;m.is_constructed=this.is_constructed;return m};h.length_block=function(){h.base_block.call(this,arguments[0]);this.is_indefinite_form=false;this.long_form_used=false;this.length=(0);if(arguments[0] instanceof Object){if("len_block" in arguments[0]){this.is_indefinite_form=j.org.pkijs.getValue(arguments[0].len_block,"is_indefinite_form",false);this.long_form_used=j.org.pkijs.getValue(arguments[0].len_block,"long_form_used",false);this.length=j.org.pkijs.getValue(arguments[0].len_block,"length",0)}}};h.length_block.prototype=new h.base_block();h.length_block.constructor=h.length_block;h.length_block.prototype.block_name=function(){return"length_block"};h.length_block.prototype.fromBER=function(m,s,r){if(f.call(this,m,s,r)===false){return(-1)}var o=new Uint8Array(m,s,r);if(o.length==0){this.error="Zero buffer length";return(-1)}if(o[0]==255){this.error="Length block 0xFF is reserved by standard";return(-1)}if(o[0]==128){this.is_indefinite_form=true}else{this.is_indefinite_form=false}if(this.is_indefinite_form==true){this.block_length=1;return(s+this.block_length)}if(o[0]&128){this.long_form_used=true}else{this.long_form_used=false}if(this.long_form_used==false){this.length=(o[0]);this.block_length=1;return(s+this.block_length)}var q=o[0]&127;if(q>8){this.error="Too big integer";return(-1)}if((q+1)>o.length){this.error="End of input reached before message was fully decoded";return(-1)}var p=new Uint8Array(q);for(var n=0;n<q;n++){p[n]=o[n+1]}if(p[q-1]==0){this.warnings.push("Needlessly long encoded length")}this.length=d(p,8);if(this.long_form_used&&(this.length<=127)){this.warnings.push("Unneccesary usage of long length form")}this.block_length=q+1;return(s+this.block_length)};h.length_block.prototype.toBER=function(q){if(typeof q==="undefined"){q=false}if(this.length>127){this.long_form_used=true}if(this.is_indefinite_form){var r=new ArrayBuffer(1);if(q===false){var p=new Uint8Array(r);p[0]=128}return r}if(this.long_form_used===true){var n=e(this.length,8);if(n.byteLength>127){this.error="Too big length";return(new ArrayBuffer(0))}var r=new ArrayBuffer(n.byteLength+1);if(q===true){return r}var m=new Uint8Array(n);var p=new Uint8Array(r);p[0]=n.byteLength|128;for(var o=0;o<n.byteLength;o++){p[o+1]=m[o]}return r}else{var r=new ArrayBuffer(1);if(q===false){var p=new Uint8Array(r);p[0]=this.length}return r}return(new ArrayBuffer(0))};h.length_block.prototype.toJSON=function(){var m=h.base_block.prototype.toJSON.call(this);m.block_name=h.length_block.prototype.block_name.call(this);m.is_indefinite_form=this.is_indefinite_form;m.long_form_used=this.long_form_used;m.length=this.length;return m};h.value_block=function(){h.base_block.call(this,arguments[0])};h.value_block.prototype=new h.base_block();h.value_block.constructor=h.value_block;h.value_block.prototype.block_name=function(){return"value_block"};h.value_block.prototype.toJSON=function(){var m=h.base_block.prototype.toJSON.call(this);m.block_name=h.value_block.prototype.block_name.call(this);return m};j.org.pkijs.asn1.ASN1_block=function(){h.base_block.call(this,arguments[0]);if(arguments[0] instanceof Object){this.name=j.org.pkijs.getValue(arguments[0],"name","");this.optional=j.org.pkijs.getValue(arguments[0],"optional",false);if("primitive_schema" in arguments[0]){this.primitive_schema=arguments[0].primitive_schema}}this.id_block=new h.identification_block(arguments[0]);this.len_block=new h.length_block(arguments[0]);this.value_block=new h.value_block(arguments[0])};j.org.pkijs.asn1.ASN1_block.prototype=new h.base_block();j.org.pkijs.asn1.ASN1_block.constructor=j.org.pkijs.asn1.ASN1_block;j.org.pkijs.asn1.ASN1_block.prototype.block_name=function(){return"ASN1_block"};j.org.pkijs.asn1.ASN1_block.prototype.fromBER=function(m,p,o){var n=this.value_block.fromBER(m,p,(this.len_block.is_indefinite_form==true)?o:this.len_block.length);if(n==(-1)){this.error=this.value_block.error;return n}if(this.id_block.error.length==0){this.block_length+=this.id_block.block_length}if(this.len_block.error.length==0){this.block_length+=this.len_block.block_length}if(this.value_block.error.length==0){this.block_length+=this.value_block.block_length}return n};j.org.pkijs.asn1.ASN1_block.prototype.toBER=function(s){if(typeof s==="undefined"){s=false}var t;var m=this.id_block.toBER(s);var q=this.value_block.toBER(true);this.len_block.length=q.byteLength;var r=this.len_block.toBER(s);t=k(m,r);var p;if(s===false){p=this.value_block.toBER(s)}else{p=new ArrayBuffer(this.len_block.length)}t=k(t,p);if(this.len_block.is_indefinite_form===true){var o=new ArrayBuffer(2);if(s===false){var n=new Uint8Array(o);n[0]=0;n[1]=0}t=k(t,o)}return t};j.org.pkijs.asn1.ASN1_block.prototype.toJSON=function(){var m=h.base_block.prototype.toJSON.call(this);m.block_name=j.org.pkijs.asn1.ASN1_block.prototype.block_name.call(this);m.id_block=this.id_block.toJSON();m.len_block=this.len_block.toJSON();m.value_block=this.value_block.toJSON();if("name" in this){m.name=this.name}if("optional" in this){m.optional=this.optional}if("primitive_schema" in this){m.primitive_schema=this.primitive_schema.toJSON()}return m};h.ASN1_PRIMITIVE_value_block=function(){h.value_block.call(this,arguments[0]);if(arguments[0] instanceof Object){if("value_hex" in arguments[0]){this.value_hex=i(arguments[0].value_hex)}else{this.value_hex=new ArrayBuffer(0)}this.is_hex_only=j.org.pkijs.getValue(arguments[0],"is_hex_only",true)}else{this.value_hex=new ArrayBuffer(0);this.is_hex_only=true}};h.ASN1_PRIMITIVE_value_block.prototype=new h.value_block();h.ASN1_PRIMITIVE_value_block.constructor=h.ASN1_PRIMITIVE_value_block;h.ASN1_PRIMITIVE_value_block.prototype.fromBER=function(m,r,q){if(f.call(this,m,r,q)===false){return(-1)}var p=new Uint8Array(m,r,q);if(p.length==0){this.warnings.push("Zero buffer length");return r}this.value_hex=new ArrayBuffer(p.length);var o=new Uint8Array(this.value_hex);for(var n=0;n<p.length;n++){o[n]=p[n]}this.block_length=q;return(r+q)};h.ASN1_PRIMITIVE_value_block.prototype.toBER=function(m){return i(this.value_hex)};h.ASN1_PRIMITIVE_value_block.prototype.block_name=function(){return"ASN1_PRIMITIVE_value_block"};h.ASN1_PRIMITIVE_value_block.prototype.toJSON=function(){var m=h.value_block.prototype.toJSON.call(this);m.block_name=h.ASN1_PRIMITIVE_value_block.prototype.block_name.call(this);m.value_hex=j.org.pkijs.bufferToHexCodes(this.value_hex,0,this.value_hex.byteLength);m.is_hex_only=this.is_hex_only;return m};j.org.pkijs.asn1.ASN1_PRIMITIVE=function(){j.org.pkijs.asn1.ASN1_block.call(this,arguments[0]);this.id_block.is_constructed=false;this.value_block=new h.ASN1_PRIMITIVE_value_block(arguments[0])};j.org.pkijs.asn1.ASN1_PRIMITIVE.prototype=new j.org.pkijs.asn1.ASN1_block();j.org.pkijs.asn1.ASN1_PRIMITIVE.constructor=j.org.pkijs.asn1.ASN1_PRIMITIVE;j.org.pkijs.asn1.ASN1_PRIMITIVE.prototype.block_name=function(){return"PRIMITIVE"};j.org.pkijs.asn1.ASN1_PRIMITIVE.prototype.toJSON=function(){var m=j.org.pkijs.asn1.ASN1_block.prototype.toJSON.call(this);m.block_name=j.org.pkijs.asn1.ASN1_PRIMITIVE.prototype.block_name.call(this);return m};h.ASN1_CONSTRUCTED_value_block=function(){h.value_block.call(this,arguments[0]);if(arguments[0] instanceof Object){this.value=j.org.pkijs.getValue(arguments[0],"value",new Array());this.is_indefinite_form=j.org.pkijs.getValue(arguments[0],"is_indefinite_form",false)}else{this.value=new Array();this.is_indefinite_form=false}};h.ASN1_CONSTRUCTED_value_block.prototype=new h.value_block();h.ASN1_CONSTRUCTED_value_block.constructor=h.ASN1_CONSTRUCTED_value_block;h.ASN1_CONSTRUCTED_value_block.prototype.fromBER=function(t,s,p){var o=s;var m=p;if(f.call(this,t,s,p)===false){return(-1)}var q=new Uint8Array(t,s,p);if(q.length==0){this.warnings.push("Zero buffer length");return s}function r(v,w){if(v==true){return 1}return w}var n=s;while(r(this.is_indefinite_form,p)>0){var u=c(t,n,p);if(u.offset==(-1)){this.error=u.result.error;this.warnings.concat(u.result.warnings);return(-1)}n=u.offset;this.block_length+=u.result.block_length;p-=u.result.block_length;this.value.push(u.result);if((this.is_indefinite_form==true)&&(u.result.block_name()==j.org.pkijs.asn1.EOC.prototype.block_name())){break}}if(this.is_indefinite_form==true){if(this.value[this.value.length-1].block_name()==j.org.pkijs.asn1.EOC.prototype.block_name()){this.value.pop()}else{this.warnings.push("No EOC block encoded")}}this.value_before_decode=l(t,o,m);return n};h.ASN1_CONSTRUCTED_value_block.prototype.toBER=function(o){if(typeof o==="undefined"){o=false}var p=new ArrayBuffer(0);for(var n=0;n<this.value.length;n++){var m=this.value[n].toBER(o);p=k(p,m)}return p};h.ASN1_CONSTRUCTED_value_block.prototype.block_name=function(){return"ASN1_CONSTRUCTED_value_block"};h.ASN1_CONSTRUCTED_value_block.prototype.toJSON=function(){var n=h.value_block.prototype.toJSON.call(this);n.block_name=h.ASN1_CONSTRUCTED_value_block.prototype.block_name.call(this);n.is_indefinite_form=this.is_indefinite_form;n.value=new Array();for(var m=0;m<this.value.length;m++){n.value.push(this.value[m].toJSON())}return n};j.org.pkijs.asn1.ASN1_CONSTRUCTED=function(){j.org.pkijs.asn1.ASN1_block.call(this,arguments[0]);this.id_block.is_constructed=true;this.value_block=new h.ASN1_CONSTRUCTED_value_block(arguments[0])};j.org.pkijs.asn1.ASN1_CONSTRUCTED.prototype=new j.org.pkijs.asn1.ASN1_block();j.org.pkijs.asn1.ASN1_CONSTRUCTED.constructor=j.org.pkijs.asn1.ASN1_CONSTRUCTED;j.org.pkijs.asn1.ASN1_CONSTRUCTED.prototype.block_name=function(){return"CONSTRUCTED"};j.org.pkijs.asn1.ASN1_CONSTRUCTED.prototype.fromBER=function(m,p,o){this.value_block.is_indefinite_form=this.len_block.is_indefinite_form;var n=this.value_block.fromBER(m,p,(this.len_block.is_indefinite_form==true)?o:this.len_block.length);if(n==(-1)){this.error=this.value_block.error;return n}if(this.id_block.error.length==0){this.block_length+=this.id_block.block_length}if(this.len_block.error.length==0){this.block_length+=this.len_block.block_length}if(this.value_block.error.length==0){this.block_length+=this.value_block.block_length}return n};j.org.pkijs.asn1.ASN1_CONSTRUCTED.prototype.toJSON=function(){var m=j.org.pkijs.asn1.ASN1_block.prototype.toJSON.call(this);m.block_name=j.org.pkijs.asn1.ASN1_CONSTRUCTED.prototype.block_name.call(this);return m};h.EOC_value_block=function(){h.value_block.call(this,arguments[0])};h.EOC_value_block.prototype=new h.value_block();h.EOC_value_block.constructor=h.EOC_value_block;h.EOC_value_block.prototype.fromBER=function(m,o,n){return o};h.EOC_value_block.prototype.toBER=function(m){return(new ArrayBuffer(0))};h.EOC_value_block.prototype.block_name=function(){return"EOC_value_block"};h.EOC_value_block.prototype.toJSON=function(){var m=h.value_block.prototype.toJSON.call(this);m.block_name=h.EOC_value_block.prototype.block_name.call(this);return m};j.org.pkijs.asn1.EOC=function(){j.org.pkijs.asn1.ASN1_block.call(this,arguments[0]);this.value_block=new h.EOC_value_block();this.id_block.tag_class=1;this.id_block.tag_number=0};j.org.pkijs.asn1.EOC.prototype=new j.org.pkijs.asn1.ASN1_block();j.org.pkijs.asn1.EOC.constructor=h.EOC_value_block;j.org.pkijs.asn1.EOC.prototype.block_name=function(){return"END_OF_CONTENT"};j.org.pkijs.asn1.EOC.prototype.toJSON=function(){var m=j.org.pkijs.asn1.ASN1_block.prototype.toJSON.call(this);m.block_name=j.org.pkijs.asn1.EOC.prototype.block_name.call(this);return m};h.BOOLEAN_value_block=function(){h.value_block.call(this,arguments[0]);if(arguments[0] instanceof Object){this.value=j.org.pkijs.getValue(arguments[0],"value",false);this.is_hex_only=j.org.pkijs.getValue(arguments[0],"is_hex_only",false);if("value_hex" in arguments[0]){this.value_hex=i(arguments[0].value_hex)}else{this.value_hex=new ArrayBuffer(1);if(this.value===true){var m=new Uint8Array(this.value_hex);m[0]=255}}}else{this.value=false;this.is_hex_only=false;this.value_hex=new ArrayBuffer(1)}};h.BOOLEAN_value_block.prototype=new h.value_block();h.BOOLEAN_value_block.constructor=h.BOOLEAN_value_block;h.BOOLEAN_value_block.prototype.fromBER=function(n,r,q){if(f.call(this,n,r,q)===false){return(-1)}var p=new Uint8Array(n,r,q);if(q>1){this.warnings.push("BOOLEAN value encoded in more then 1 octet")}if(p[0]==0){this.value=false}else{this.value=true}this.is_hex_only=true;this.value_hex=new ArrayBuffer(p.length);var m=new Uint8Array(this.value_hex);for(var o=0;o<p.length;o++){m[o]=p[o]}this.block_length=q;return(r+q)};h.BOOLEAN_value_block.prototype.toBER=function(m){if(typeof m==="undefined"){m=false}return this.value_hex};h.BOOLEAN_value_block.prototype.block_name=function(){return"BOOLEAN_value_block"};h.BOOLEAN_value_block.prototype.toJSON=function(){var m=h.value_block.prototype.toJSON.call(this);m.block_name=h.BOOLEAN_value_block.prototype.block_name.call(this);m.value=this.value;m.is_hex_only=this.is_hex_only;m.value_hex=j.org.pkijs.bufferToHexCodes(this.value_hex,0,this.value_hex.byteLength);return m};j.org.pkijs.asn1.BOOLEAN=function(){j.org.pkijs.asn1.ASN1_block.call(this,arguments[0]);this.value_block=new h.BOOLEAN_value_block(arguments[0]);this.id_block.tag_class=1;this.id_block.tag_number=1};j.org.pkijs.asn1.BOOLEAN.prototype=new j.org.pkijs.asn1.ASN1_block();j.org.pkijs.asn1.BOOLEAN.constructor=h.BOOLEAN_value_block;j.org.pkijs.asn1.BOOLEAN.prototype.block_name=function(){return"BOOLEAN"};j.org.pkijs.asn1.BOOLEAN.prototype.toJSON=function(){var m=j.org.pkijs.asn1.ASN1_block.prototype.toJSON.call(this);m.block_name=j.org.pkijs.asn1.BOOLEAN.prototype.block_name.call(this);return m};j.org.pkijs.asn1.SEQUENCE=function(){j.org.pkijs.asn1.ASN1_CONSTRUCTED.call(this,arguments[0]);this.id_block.tag_class=1;this.id_block.tag_number=16};j.org.pkijs.asn1.SEQUENCE.prototype=new j.org.pkijs.asn1.ASN1_CONSTRUCTED();j.org.pkijs.asn1.SEQUENCE.constructor=j.org.pkijs.asn1.SEQUENCE;j.org.pkijs.asn1.SEQUENCE.prototype.block_name=function(){return"SEQUENCE"};j.org.pkijs.asn1.SEQUENCE.prototype.toJSON=function(){var m=j.org.pkijs.asn1.ASN1_CONSTRUCTED.prototype.toJSON.call(this);m.block_name=j.org.pkijs.asn1.SEQUENCE.prototype.block_name.call(this);return m};j.org.pkijs.asn1.SET=function(){j.org.pkijs.asn1.ASN1_CONSTRUCTED.call(this,arguments[0]);this.id_block.tag_class=1;this.id_block.tag_number=17};j.org.pkijs.asn1.SET.prototype=new j.org.pkijs.asn1.ASN1_CONSTRUCTED();j.org.pkijs.asn1.SET.constructor=j.org.pkijs.asn1.SET;j.org.pkijs.asn1.SET.prototype.block_name=function(){return"SET"};j.org.pkijs.asn1.SET.prototype.toJSON=function(){var m=j.org.pkijs.asn1.ASN1_CONSTRUCTED.prototype.toJSON.call(this);m.block_name=j.org.pkijs.asn1.SET.prototype.block_name.call(this);return m};j.org.pkijs.asn1.NULL=function(){j.org.pkijs.asn1.ASN1_block.call(this,arguments[0]);this.id_block.tag_class=1;this.id_block.tag_number=5};j.org.pkijs.asn1.NULL.prototype=new j.org.pkijs.asn1.ASN1_block();j.org.pkijs.asn1.NULL.constructor=j.org.pkijs.asn1.NULL;j.org.pkijs.asn1.NULL.prototype.block_name=function(){return"NULL"};j.org.pkijs.asn1.NULL.prototype.fromBER=function(m,o,n){if(this.len_block.length>0){this.warnings.push("Non-zero length of value block for NULL type")}if(this.id_block.error.length===0){this.block_length+=this.id_block.block_length}if(this.len_block.error.length===0){this.block_length+=this.len_block.block_length}this.block_length+=n;return(o+n)};j.org.pkijs.asn1.NULL.prototype.toBER=function(n){if(typeof n==="undefined"){n=false}var o=new ArrayBuffer(2);if(n===true){return o}var m=new Uint8Array(o);m[0]=5;m[1]=0;return o};j.org.pkijs.asn1.NULL.prototype.toJSON=function(){var m=j.org.pkijs.asn1.ASN1_block.prototype.toJSON.call(this);m.block_name=j.org.pkijs.asn1.NULL.prototype.block_name.call(this);return m};h.OCTETSTRING_value_block=function(){h.ASN1_CONSTRUCTED_value_block.call(this,arguments[0]);if(arguments[0] instanceof Object){this.is_constructed=j.org.pkijs.getValue(arguments[0],"is_constructed",false);this.is_hex_only=j.org.pkijs.getValue(arguments[0],"is_hex_only",false);if("value_hex" in arguments[0]){this.value_hex=i(arguments[0].value_hex)}else{this.value_hex=new ArrayBuffer(0)}}else{this.is_constructed=false;this.is_hex_only=false;this.value_hex=new ArrayBuffer(0)}};h.OCTETSTRING_value_block.prototype=new h.ASN1_CONSTRUCTED_value_block();h.OCTETSTRING_value_block.constructor=h.OCTETSTRING_value_block;h.OCTETSTRING_value_block.prototype.fromBER=function(m,r,q){var p=0;if(this.is_constructed==true){this.is_hex_only=false;p=h.ASN1_CONSTRUCTED_value_block.prototype.fromBER.call(this,m,r,q);if(p==(-1)){return p}for(var o=0;o<this.value.length;o++){var n=this.value[o].block_name();if(n==j.org.pkijs.asn1.EOC.prototype.block_name()){if(this.is_indefinite_form==true){break}else{this.error="EOC is unexpected, OCTET STRING may consists of OCTET STRINGs only";return(-1)}}if(n!=j.org.pkijs.asn1.OCTETSTRING.prototype.block_name()){this.error="OCTET STRING may consists of OCTET STRINGs only";return(-1)}}}else{this.is_hex_only=true;p=h.hex_block.prototype.fromBER.call(this,m,r,q);this.block_length=q}return p};h.OCTETSTRING_value_block.prototype.toBER=function(m){if(typeof m==="undefined"){m=false}if(this.is_constructed===true){return h.ASN1_CONSTRUCTED_value_block.prototype.toBER.call(this,m)}else{var n=new ArrayBuffer(this.value_hex.byteLength);if(m===true){return n}if(this.value_hex.byteLength==0){return n}n=i(this.value_hex);return n}return(new ArrayBuffer(0))};h.OCTETSTRING_value_block.prototype.block_name=function(){return"OCTETSTRING_value_block"};h.OCTETSTRING_value_block.prototype.toJSON=function(){var m=h.ASN1_CONSTRUCTED_value_block.prototype.toJSON.call(this);m.block_name=h.OCTETSTRING_value_block.prototype.block_name.call(this);m.is_constructed=this.is_constructed;m.is_hex_only=this.is_hex_only;m.value_hex=j.org.pkijs.bufferToHexCodes(this.value_hex,0,this.value_hex.byteLength);return m};j.org.pkijs.asn1.OCTETSTRING=function(){j.org.pkijs.asn1.ASN1_block.call(this,arguments[0]);this.value_block=new h.OCTETSTRING_value_block(arguments[0]);this.id_block.tag_class=1;this.id_block.tag_number=4};j.org.pkijs.asn1.OCTETSTRING.prototype=new j.org.pkijs.asn1.ASN1_block();j.org.pkijs.asn1.OCTETSTRING.constructor=j.org.pkijs.asn1.OCTETSTRING;j.org.pkijs.asn1.OCTETSTRING.prototype.fromBER=function(m,o,n){this.value_block.is_constructed=this.id_block.is_constructed;this.value_block.is_indefinite_form=this.len_block.is_indefinite_form;if(n==0){if(this.id_block.error.length==0){this.block_length+=this.id_block.block_length}if(this.len_block.error.length==0){this.block_length+=this.len_block.block_length}return o}return j.org.pkijs.asn1.ASN1_block.prototype.fromBER.call(this,m,o,n)};j.org.pkijs.asn1.OCTETSTRING.prototype.block_name=function(){return"OCTETSTRING"};j.org.pkijs.asn1.OCTETSTRING.prototype.toJSON=function(){var m=j.org.pkijs.asn1.ASN1_block.prototype.toJSON.call(this);m.block_name=j.org.pkijs.asn1.OCTETSTRING.prototype.block_name.call(this);return m};h.BITSTRING_value_block=function(){h.ASN1_CONSTRUCTED_value_block.call(this,arguments[0]);if(arguments[0] instanceof Object){this.unused_bits=j.org.pkijs.getValue(arguments[0],"unused_bits",0);this.is_constructed=j.org.pkijs.getValue(arguments[0],"is_constructed",false);this.is_hex_only=j.org.pkijs.getValue(arguments[0],"is_hex_only",false);if("value_hex" in arguments[0]){this.value_hex=i(arguments[0].value_hex)}else{this.value_hex=new ArrayBuffer(0)}this.block_length=this.value_hex.byteLength}else{this.unused_bits=0;this.is_constructed=false;this.is_hex_only=false;this.value_hex=new ArrayBuffer(0)}};h.BITSTRING_value_block.prototype=new h.ASN1_CONSTRUCTED_value_block();h.BITSTRING_value_block.constructor=h.BITSTRING_value_block;h.BITSTRING_value_block.prototype.fromBER=function(n,t,s){if(s==0){return t}var r=(-1);if(this.is_constructed==true){r=h.ASN1_CONSTRUCTED_value_block.prototype.fromBER.call(this,n,t,s);if(r==(-1)){return r}for(var p=0;p<this.value.length;p++){var o=this.value[p].block_name();if(o==j.org.pkijs.asn1.EOC.prototype.block_name()){if(this.is_indefinite_form==true){break}else{this.error="EOC is unexpected, BIT STRING may consists of BIT STRINGs only";return(-1)}}if(o!=j.org.pkijs.asn1.BITSTRING.prototype.block_name()){this.error="BIT STRING may consists of BIT STRINGs only";return(-1)}if((this.unused_bits>0)&&(this.value[p].unused_bits>0)){this.error='Usign of "unused bits" inside constructive BIT STRING allowed for least one only';return(-1)}else{this.unused_bits=this.value[p].unused_bits;if(this.unused_bits>7){this.error="Unused bits for BITSTRING must be in range 0-7";return(-1)}}}return r}else{if(f.call(this,n,t,s)===false){return(-1)}var q=new Uint8Array(n,t,s);this.unused_bits=q[0];if(this.unused_bits>7){this.error="Unused bits for BITSTRING must be in range 0-7";return(-1)}this.value_hex=new ArrayBuffer(q.length-1);var m=new Uint8Array(this.value_hex);for(var p=0;p<(s-1);p++){m[p]=q[p+1]}this.block_length=q.length;return(t+s)}};h.BITSTRING_value_block.prototype.toBER=function(p){if(typeof p==="undefined"){p=false}if(this.is_constructed===true){return h.ASN1_CONSTRUCTED_value_block.prototype.toBER.call(this,p)}else{if(p===true){return(new ArrayBuffer(this.value_hex.byteLength+1))}if(this.value_hex.byteLength==0){return(new ArrayBuffer(0))}var n=new Uint8Array(this.value_hex);var q=new ArrayBuffer(this.value_hex.byteLength+1);var o=new Uint8Array(q);o[0]=this.unused_bits;for(var m=0;m<this.value_hex.byteLength;m++){o[m+1]=n[m]}return q}return(new ArrayBuffer(0))};h.BITSTRING_value_block.prototype.block_name=function(){return"BITSTRING_value_block"};h.BITSTRING_value_block.prototype.toJSON=function(){var m=h.ASN1_CONSTRUCTED_value_block.prototype.toJSON.call(this);m.block_name=h.BITSTRING_value_block.prototype.block_name.call(this);m.unused_bits=this.unused_bits;m.is_constructed=this.is_constructed;m.is_hex_only=this.is_hex_only;m.value_hex=j.org.pkijs.bufferToHexCodes(this.value_hex,0,this.value_hex.byteLength);return m};j.org.pkijs.asn1.BITSTRING=function(){j.org.pkijs.asn1.ASN1_block.call(this,arguments[0]);this.value_block=new h.BITSTRING_value_block(arguments[0]);this.id_block.tag_class=1;this.id_block.tag_number=3};j.org.pkijs.asn1.BITSTRING.prototype=new j.org.pkijs.asn1.ASN1_block();j.org.pkijs.asn1.BITSTRING.constructor=j.org.pkijs.asn1.BITSTRING;j.org.pkijs.asn1.BITSTRING.prototype.block_name=function(){return"BITSTRING"};j.org.pkijs.asn1.BITSTRING.prototype.fromBER=function(m,o,n){if(n==0){return o}this.value_block.is_constructed=this.id_block.is_constructed;this.value_block.is_indefinite_form=this.len_block.is_indefinite_form;return j.org.pkijs.asn1.ASN1_block.prototype.fromBER.call(this,m,o,n)};j.org.pkijs.asn1.BITSTRING.prototype.toJSON=function(){var m=j.org.pkijs.asn1.ASN1_block.prototype.toJSON.call(this);m.block_name=j.org.pkijs.asn1.BITSTRING.prototype.block_name.call(this);return m};h.INTEGER_value_block=function(){h.value_block.call(this,arguments[0]);if(arguments[0] instanceof Object){this.value_dec=j.org.pkijs.getValue(arguments[0],"value",0);this.is_hex_only=j.org.pkijs.getValue(arguments[0],"is_hex_only",false);if("value_hex" in arguments[0]){this.value_hex=i(arguments[0].value_hex);if(this.value_hex.byteLength>=4){this.is_hex_only=true}else{this.value_dec=b.call(this)}}else{this.value_hex=a(this.value_dec)}}else{this.value_dec=0;this.is_hex_only=false;this.value_hex=new ArrayBuffer(0)}};h.INTEGER_value_block.prototype=new h.value_block();h.INTEGER_value_block.constructor=h.INTEGER_value_block;h.INTEGER_value_block.prototype.fromBER=function(m,p,o){var n=h.hex_block.prototype.fromBER.call(this,m,p,o);if(n==(-1)){return n}if(this.value_hex.byteLength>4){this.warnings.push("Too big INTEGER for decoding, hex only");this.is_hex_only=true}else{this.value_dec=b.call(this)}this.block_length=o;return(p+o)};h.INTEGER_value_block.prototype.toBER=function(n){if(typeof n==="undefined"){n=false}if(this.is_hex_only===false){var m=a(this.value_dec);if(m.byteLength==0){this.error="Error during encoding INTEGER value";return(new ArrayBuffer(0))}return i(m)}else{return i(this.value_hex)}return(new ArrayBuffer(0))};h.INTEGER_value_block.prototype.block_name=function(){return"INTEGER_value_block"};h.INTEGER_value_block.prototype.toJSON=function(){var m=h.value_block.prototype.toJSON.call(this);m.block_name=h.INTEGER_value_block.prototype.block_name.call(this);m.value_dec=this.value_dec;m.is_hex_only=this.is_hex_only;m.value_hex=j.org.pkijs.bufferToHexCodes(this.value_hex,0,this.value_hex.byteLength);return m};j.org.pkijs.asn1.INTEGER=function(){j.org.pkijs.asn1.ASN1_block.call(this,arguments[0]);this.value_block=new h.INTEGER_value_block(arguments[0]);this.id_block.tag_class=1;this.id_block.tag_number=2};j.org.pkijs.asn1.INTEGER.prototype=new j.org.pkijs.asn1.ASN1_block();j.org.pkijs.asn1.INTEGER.constructor=j.org.pkijs.asn1.INTEGER;j.org.pkijs.asn1.INTEGER.prototype.block_name=function(){return"INTEGER"};j.org.pkijs.asn1.INTEGER.prototype.isEqual=function(){if(arguments[0] instanceof j.org.pkijs.asn1.INTEGER){if(this.value_block.is_hex_only&&arguments[0].value_block.is_hex_only){return j.org.pkijs.isEqual_buffer(this.value_block.value_hex,arguments[0].value_block.value_hex)}else{if(this.value_block.is_hex_only===arguments[0].value_block.is_hex_only){return(this.value_block.value_dec==arguments[0].value_block.value_dec)}else{return false}}}else{if(arguments[0] instanceof ArrayBuffer){return j.org.pkijs.isEqual_buffer(this.value_block.value_hex,arguments[0].value_block.value_hex)}else{return false}}return false};j.org.pkijs.asn1.INTEGER.prototype.toJSON=function(){var m=j.org.pkijs.asn1.ASN1_block.prototype.toJSON.call(this);m.block_name=j.org.pkijs.asn1.INTEGER.prototype.block_name.call(this);return m};j.org.pkijs.asn1.ENUMERATED=function(){j.org.pkijs.asn1.INTEGER.call(this,arguments[0]);this.id_block.tag_class=1;this.id_block.tag_number=10};j.org.pkijs.asn1.ENUMERATED.prototype=new j.org.pkijs.asn1.INTEGER();j.org.pkijs.asn1.ENUMERATED.constructor=j.org.pkijs.asn1.ENUMERATED;j.org.pkijs.asn1.ENUMERATED.prototype.block_name=function(){return"ENUMERATED"};j.org.pkijs.asn1.ENUMERATED.prototype.toJSON=function(){var m=j.org.pkijs.asn1.INTEGER.prototype.toJSON.call(this);m.block_name=j.org.pkijs.asn1.ENUMERATED.prototype.block_name.call(this);return m};h.SID_value_block=function(){h.hex_block.call(this,arguments[0]);if(arguments[0] instanceof Object){this.value_dec=j.org.pkijs.getValue(arguments[0],"value_dec",-1);this.is_first_sid=j.org.pkijs.getValue(arguments[0],"is_first_sid",false)}else{this.value_dec=(-1);this.is_first_sid=false}};h.SID_value_block.prototype=new h.hex_block();h.SID_value_block.constructor=h.SID_value_block;h.SID_value_block.prototype.block_name=function(){return"sid_block"};h.SID_value_block.prototype.fromBER=function(o,t,r){if(r==0){return t}if(f.call(this,o,t,r)===false){return(-1)}var q=new Uint8Array(o,t,r);this.value_hex=new ArrayBuffer(r);var m=new Uint8Array(this.value_hex);for(var p=0;p<r;p++){m[p]=q[p]&127;this.block_length++;if((q[p]&128)==0){break}}var s=new ArrayBuffer(this.block_length);var n=new Uint8Array(s);for(var p=0;p<this.block_length;p++){n[p]=m[p]}this.value_hex=i(s);m=new Uint8Array(this.value_hex);if((q[this.block_length-1]&128)!=0){this.error="End of input reached before message was fully decoded";return(-1)}if(m[0]==0){this.warnings.push("Needlessly long format of SID encoding")}if(this.block_length<=8){this.value_dec=d(m,7)}else{this.is_hex_only=true;this.warnings.push("Too big SID for decoding, hex only")}return(t+this.block_length)};h.SID_value_block.prototype.toBER=function(r){if(typeof r==="undefined"){r=false}if(this.is_hex_only){if(r===true){return(new ArrayBuffer(this.value_hex.byteLength))}var p=new Uint8Array(this.value_hex);var s=new ArrayBuffer(this.block_length);var q=new Uint8Array(s);for(var o=0;o<(this.block_length-1);o++){q[o]=p[o]|128}q[this.block_length-1]=p[this.block_length-1]}var n=e(this.value_dec,7);if(n.byteLength===0){this.error="Error during encoding SID value";return(new ArrayBuffer(0))}var s=new ArrayBuffer(n.byteLength);if(r===false){var m=new Uint8Array(n);var q=new Uint8Array(s);for(var o=0;o<(n.byteLength-1);o++){q[o]=m[o]|128}q[n.byteLength-1]=m[n.byteLength-1]}return s};h.SID_value_block.prototype.toString=function(){var m="";if(this.is_hex_only===true){m=g(this.value_hex)}else{if(this.is_first_sid){var n=this.value_dec;if(this.value_dec<=39){m="0."}else{if(this.value_dec<=79){m="1.";n-=40}else{m="2.";n-=80}}m=m+n.toString()}else{m=this.value_dec.toString()}}return m};h.SID_value_block.prototype.toJSON=function(){var m=h.hex_block.prototype.toJSON.call(this);m.block_name=h.SID_value_block.prototype.block_name.call(this);m.value_dec=this.value_dec;m.is_first_sid=this.is_first_sid;return m};h.OID_value_block=function(){h.value_block.call(this,arguments[0]);this.value=new Array();if(arguments[0] instanceof Object){this.fromString(j.org.pkijs.getValue(arguments[0],"value",""))}};h.OID_value_block.prototype=new h.value_block();h.OID_value_block.constructor=h.OID_value_block;h.OID_value_block.prototype.fromBER=function(m,q,p){var o=q;while(p>0){var n=new h.SID_value_block();o=n.fromBER(m,o,p);if(o==(-1)){this.block_length=0;this.error=n.error;return o}if(this.value.length==0){n.is_first_sid=true}this.block_length+=n.block_length;p-=n.block_length;this.value.push(n)}return o};h.OID_value_block.prototype.toBER=function(o){if(typeof o==="undefined"){o=false}var p=new ArrayBuffer(0);for(var n=0;n<this.value.length;n++){var m=this.value[n].toBER(o);if(m.byteLength===0){this.error=this.value[n].error;return(new ArrayBuffer(0))}p=k(p,m)}return p};h.OID_value_block.prototype.fromString=function(s){this.value=new Array();var r=0;var p=0;var n="";var m=false;do{p=s.indexOf(".",r);if(p===(-1)){n=s.substr(r)}else{n=s.substr(r,p-r)}r=p+1;if(m){var o=this.value[0];var t=0;switch(o.value_dec){case 0:break;case 1:t=40;break;case 2:t=80;break;default:this.value=new Array();return false}var q=parseInt(n,10);if(Number.isNaN(q)){return true}o.value_dec=q+t;m=false}else{var o=new h.SID_value_block();o.value_dec=parseInt(n,10);if(Number.isNaN(o.value_dec)){return true}if(this.value.length===0){o.is_first_sid=true;m=true}this.value.push(o)}}while(p!==(-1));return true};h.OID_value_block.prototype.toString=function(){var m="";var n=false;for(var o=0;o<this.value.length;o++){n=this.value[o].is_hex_only;var p=this.value[o].toString();if(o!==0){m=m+"."}if(n){p="{"+p+"}";if(this.value[o].is_first_sid){m="2.{"+p+" - 80}"}else{m=m+p}}else{m=m+p}}return m};h.OID_value_block.prototype.block_name=function(){return"OID_value_block"};h.OID_value_block.prototype.toJSON=function(){var n=h.value_block.prototype.toJSON.call(this);n.block_name=h.OID_value_block.prototype.block_name.call(this);n.value=h.OID_value_block.prototype.toString.call(this);n.sid_array=new Array();for(var m=0;m<this.value.length;m++){n.sid_array.push(this.value[m].toJSON())}return n};j.org.pkijs.asn1.OID=function(){j.org.pkijs.asn1.ASN1_block.call(this,arguments[0]);this.value_block=new h.OID_value_block(arguments[0]);this.id_block.tag_class=1;this.id_block.tag_number=6};j.org.pkijs.asn1.OID.prototype=new j.org.pkijs.asn1.ASN1_block();j.org.pkijs.asn1.OID.constructor=j.org.pkijs.asn1.OID;j.org.pkijs.asn1.OID.prototype.block_name=function(){return"OID"};j.org.pkijs.asn1.OID.prototype.toJSON=function(){var m=j.org.pkijs.asn1.ASN1_block.prototype.toJSON.call(this);m.block_name=j.org.pkijs.asn1.OID.prototype.block_name.call(this);return m};h.UTF8STRING_value_block=function(){h.hex_block.call(this,arguments[0]);this.is_hex_only=true;this.value=""};h.UTF8STRING_value_block.prototype=new h.hex_block();h.UTF8STRING_value_block.constructor=h.UTF8STRING_value_block;h.UTF8STRING_value_block.prototype.block_name=function(){return"UTF8STRING_value_block"};h.UTF8STRING_value_block.prototype.toJSON=function(){var m=h.hex_block.prototype.toJSON.call(this);m.block_name=h.UTF8STRING_value_block.prototype.block_name.call(this);m.value=this.value;return m};j.org.pkijs.asn1.UTF8STRING=function(){j.org.pkijs.asn1.ASN1_block.call(this,arguments[0]);this.value_block=new h.UTF8STRING_value_block();if(arguments[0] instanceof Object){if("value" in arguments[0]){j.org.pkijs.asn1.UTF8STRING.prototype.fromString.call(this,arguments[0].value)}}this.id_block.tag_class=1;this.id_block.tag_number=12};j.org.pkijs.asn1.UTF8STRING.prototype=new j.org.pkijs.asn1.ASN1_block();j.org.pkijs.asn1.UTF8STRING.constructor=j.org.pkijs.asn1.UTF8STRING;j.org.pkijs.asn1.UTF8STRING.prototype.block_name=function(){return"UTF8STRING"};j.org.pkijs.asn1.UTF8STRING.prototype.fromBER=function(m,p,o){var n=this.value_block.fromBER(m,p,(this.len_block.is_indefinite_form==true)?o:this.len_block.length);if(n==(-1)){this.error=this.value_block.error;return n}j.org.pkijs.asn1.UTF8STRING.prototype.fromBuffer.call(this,this.value_block.value_hex);if(this.id_block.error.length==0){this.block_length+=this.id_block.block_length}if(this.len_block.error.length==0){this.block_length+=this.len_block.block_length}if(this.value_block.error.length==0){this.block_length+=this.value_block.block_length}return n};j.org.pkijs.asn1.UTF8STRING.prototype.fromBuffer=function(m){this.value_block.value=String.fromCharCode.apply(null,new Uint8Array(m));try{this.value_block.value=decodeURIComponent(escape(this.value_block.value))}catch(n){this.warnings.push('Error during "decodeURIComponent": '+n+", using raw string")}};j.org.pkijs.asn1.UTF8STRING.prototype.fromString=function(o){var q=unescape(encodeURIComponent(o));var p=q.length;this.value_block.value_hex=new ArrayBuffer(p);var m=new Uint8Array(this.value_block.value_hex);for(var n=0;n<p;n++){m[n]=q.charCodeAt(n)}this.value_block.value=o};j.org.pkijs.asn1.UTF8STRING.prototype.toJSON=function(){var m=j.org.pkijs.asn1.ASN1_block.prototype.toJSON.call(this);m.block_name=j.org.pkijs.asn1.UTF8STRING.prototype.block_name.call(this);return m};h.BMPSTRING_value_block=function(){h.hex_block.call(this,arguments[0]);this.is_hex_only=true;this.value=""};h.BMPSTRING_value_block.prototype=new h.hex_block();h.BMPSTRING_value_block.constructor=h.BMPSTRING_value_block;h.BMPSTRING_value_block.prototype.block_name=function(){return"BMPSTRING_value_block"};h.BMPSTRING_value_block.prototype.toJSON=function(){var m=h.hex_block.prototype.toJSON.call(this);m.block_name=h.BMPSTRING_value_block.prototype.block_name.call(this);m.value=this.value;return m};j.org.pkijs.asn1.BMPSTRING=function(){j.org.pkijs.asn1.ASN1_block.call(this,arguments[0]);this.value_block=new h.BMPSTRING_value_block();if(arguments[0] instanceof Object){if("value" in arguments[0]){j.org.pkijs.asn1.BMPSTRING.prototype.fromString.call(this,arguments[0].value)}}this.id_block.tag_class=1;this.id_block.tag_number=30};j.org.pkijs.asn1.BMPSTRING.prototype=new j.org.pkijs.asn1.ASN1_block();j.org.pkijs.asn1.BMPSTRING.constructor=j.org.pkijs.asn1.BMPSTRING;j.org.pkijs.asn1.BMPSTRING.prototype.block_name=function(){return"BMPSTRING"};j.org.pkijs.asn1.BMPSTRING.prototype.fromBER=function(m,p,o){var n=this.value_block.fromBER(m,p,(this.len_block.is_indefinite_form==true)?o:this.len_block.length);if(n==(-1)){this.error=this.value_block.error;return n}j.org.pkijs.asn1.BMPSTRING.prototype.fromBuffer.call(this,this.value_block.value_hex);if(this.id_block.error.length==0){this.block_length+=this.id_block.block_length}if(this.len_block.error.length==0){this.block_length+=this.len_block.block_length}if(this.value_block.error.length==0){this.block_length+=this.value_block.block_length}return n};j.org.pkijs.asn1.BMPSTRING.prototype.fromBuffer=function(n){var p=j.org.pkijs.copyBuffer(n);var q=new Uint8Array(p);for(var o=0;o<q.length;o=o+2){var m=q[o];q[o]=q[o+1];q[o+1]=m}this.value_block.value=String.fromCharCode.apply(null,new Uint16Array(p))};j.org.pkijs.asn1.BMPSTRING.prototype.fromString=function(q){var r=q.length;this.value_block.value_hex=new ArrayBuffer(r*2);var p=new Uint8Array(this.value_block.value_hex);for(var o=0;o<r;o++){var t=e(q.charCodeAt(o),8);var s=new Uint8Array(t);if(s.length>2){continue}var n=2-s.length;for(var m=(s.length-1);m>=0;m--){p[o*2+m+n]=s[m]}}this.value_block.value=q};j.org.pkijs.asn1.BMPSTRING.prototype.toJSON=function(){var m=j.org.pkijs.asn1.ASN1_block.prototype.toJSON.call(this);m.block_name=j.org.pkijs.asn1.BMPSTRING.prototype.block_name.call(this);return m};h.UNIVERSALSTRING_value_block=function(){h.hex_block.call(this,arguments[0]);this.is_hex_only=true;this.value=""};h.UNIVERSALSTRING_value_block.prototype=new h.hex_block();h.UNIVERSALSTRING_value_block.constructor=h.UNIVERSALSTRING_value_block;h.UNIVERSALSTRING_value_block.prototype.block_name=function(){return"UNIVERSALSTRING_value_block"};h.UNIVERSALSTRING_value_block.prototype.toJSON=function(){var m=h.hex_block.prototype.toJSON.call(this);m.block_name=h.UNIVERSALSTRING_value_block.prototype.block_name.call(this);m.value=this.value;return m};j.org.pkijs.asn1.UNIVERSALSTRING=function(){j.org.pkijs.asn1.ASN1_block.call(this,arguments[0]);this.value_block=new h.UNIVERSALSTRING_value_block();if(arguments[0] instanceof Object){if("value" in arguments[0]){j.org.pkijs.asn1.UNIVERSALSTRING.prototype.fromString.call(this,arguments[0].value)}}this.id_block.tag_class=1;this.id_block.tag_number=28};j.org.pkijs.asn1.UNIVERSALSTRING.prototype=new j.org.pkijs.asn1.ASN1_block();j.org.pkijs.asn1.UNIVERSALSTRING.constructor=j.org.pkijs.asn1.UNIVERSALSTRING;j.org.pkijs.asn1.UNIVERSALSTRING.prototype.block_name=function(){return"UNIVERSALSTRING"};j.org.pkijs.asn1.UNIVERSALSTRING.prototype.fromBER=function(m,p,o){var n=this.value_block.fromBER(m,p,(this.len_block.is_indefinite_form==true)?o:this.len_block.length);if(n==(-1)){this.error=this.value_block.error;return n}j.org.pkijs.asn1.UNIVERSALSTRING.prototype.fromBuffer.call(this,this.value_block.value_hex);if(this.id_block.error.length==0){this.block_length+=this.id_block.block_length}if(this.len_block.error.length==0){this.block_length+=this.len_block.block_length}if(this.value_block.error.length==0){this.block_length+=this.value_block.block_length}return n};j.org.pkijs.asn1.UNIVERSALSTRING.prototype.fromBuffer=function(m){var o=j.org.pkijs.copyBuffer(m);var p=new Uint8Array(o);for(var n=0;n<p.length;n=n+4){p[n]=p[n+3];p[n+1]=p[n+2];p[n+2]=0;p[n+3]=0}this.value_block.value=String.fromCharCode.apply(null,new Uint32Array(o))};j.org.pkijs.asn1.UNIVERSALSTRING.prototype.fromString=function(q){var r=q.length;this.value_block.value_hex=new ArrayBuffer(r*4);var p=new Uint8Array(this.value_block.value_hex);for(var o=0;o<r;o++){var t=e(q.charCodeAt(o),8);var s=new Uint8Array(t);if(s.length>4){continue}var n=4-s.length;for(var m=(s.length-1);m>=0;m--){p[o*4+m+n]=s[m]}}this.value_block.value=q};j.org.pkijs.asn1.UNIVERSALSTRING.prototype.toJSON=function(){var m=j.org.pkijs.asn1.ASN1_block.prototype.toJSON.call(this);m.block_name=j.org.pkijs.asn1.UNIVERSALSTRING.prototype.block_name.call(this);return m};h.SIMPLESTRING_value_block=function(){h.hex_block.call(this,arguments[0]);this.value="";this.is_hex_only=true};h.SIMPLESTRING_value_block.prototype=new h.hex_block();h.SIMPLESTRING_value_block.constructor=h.SIMPLESTRING_value_block;h.SIMPLESTRING_value_block.prototype.block_name=function(){return"SIMPLESTRING_value_block"};h.SIMPLESTRING_value_block.prototype.toJSON=function(){var m=h.hex_block.prototype.toJSON.call(this);m.block_name=h.SIMPLESTRING_value_block.prototype.block_name.call(this);m.value=this.value;return m};h.SIMPLESTRING_block=function(){j.org.pkijs.asn1.ASN1_block.call(this,arguments[0]);this.value_block=new h.SIMPLESTRING_value_block();if(arguments[0] instanceof Object){if("value" in arguments[0]){h.SIMPLESTRING_block.prototype.fromString.call(this,arguments[0].value)}}};h.SIMPLESTRING_block.prototype=new j.org.pkijs.asn1.ASN1_block();h.SIMPLESTRING_block.constructor=h.SIMPLESTRING_block;h.SIMPLESTRING_block.prototype.block_name=function(){return"SIMPLESTRING"};h.SIMPLESTRING_block.prototype.fromBER=function(m,p,o){var n=this.value_block.fromBER(m,p,(this.len_block.is_indefinite_form==true)?o:this.len_block.length);if(n==(-1)){this.error=this.value_block.error;return n}h.SIMPLESTRING_block.prototype.fromBuffer.call(this,this.value_block.value_hex);if(this.id_block.error.length==0){this.block_length+=this.id_block.block_length}if(this.len_block.error.length==0){this.block_length+=this.len_block.block_length}if(this.value_block.error.length==0){this.block_length+=this.value_block.block_length}return n};h.SIMPLESTRING_block.prototype.fromBuffer=function(m){this.value_block.value=String.fromCharCode.apply(null,new Uint8Array(m))};h.SIMPLESTRING_block.prototype.fromString=function(o){var p=o.length;this.value_block.value_hex=new ArrayBuffer(p);var m=new Uint8Array(this.value_block.value_hex);for(var n=0;n<p;n++){m[n]=o.charCodeAt(n)}this.value_block.value=o};h.SIMPLESTRING_block.prototype.toJSON=function(){var m=j.org.pkijs.asn1.ASN1_block.prototype.toJSON.call(this);m.block_name=h.SIMPLESTRING_block.prototype.block_name.call(this);m.block_name=h.value_block.prototype.block_name.call(this);return m};j.org.pkijs.asn1.NUMERICSTRING=function(){h.SIMPLESTRING_block.call(this,arguments[0]);this.id_block.tag_class=1;this.id_block.tag_number=18};j.org.pkijs.asn1.NUMERICSTRING.prototype=new h.SIMPLESTRING_block();j.org.pkijs.asn1.NUMERICSTRING.constructor=j.org.pkijs.asn1.NUMERICSTRING;j.org.pkijs.asn1.NUMERICSTRING.prototype.block_name=function(){return"NUMERICSTRING"};j.org.pkijs.asn1.NUMERICSTRING.prototype.toJSON=function(){var m=h.SIMPLESTRING_block.prototype.toJSON.call(this);m.block_name=j.org.pkijs.asn1.NUMERICSTRING.prototype.block_name.call(this);return m};j.org.pkijs.asn1.PRINTABLESTRING=function(){h.SIMPLESTRING_block.call(this,arguments[0]);this.id_block.tag_class=1;this.id_block.tag_number=19};j.org.pkijs.asn1.PRINTABLESTRING.prototype=new h.SIMPLESTRING_block();j.org.pkijs.asn1.PRINTABLESTRING.constructor=j.org.pkijs.asn1.PRINTABLESTRING;j.org.pkijs.asn1.PRINTABLESTRING.prototype.block_name=function(){return"PRINTABLESTRING"};j.org.pkijs.asn1.PRINTABLESTRING.prototype.toJSON=function(){var m=h.SIMPLESTRING_block.prototype.toJSON.call(this);m.block_name=j.org.pkijs.asn1.PRINTABLESTRING.prototype.block_name.call(this);return m};j.org.pkijs.asn1.TELETEXSTRING=function(){h.SIMPLESTRING_block.call(this,arguments[0]);this.id_block.tag_class=1;this.id_block.tag_number=20};j.org.pkijs.asn1.TELETEXSTRING.prototype=new h.SIMPLESTRING_block();j.org.pkijs.asn1.TELETEXSTRING.constructor=j.org.pkijs.asn1.TELETEXSTRING;j.org.pkijs.asn1.TELETEXSTRING.prototype.block_name=function(){return"TELETEXSTRING"};j.org.pkijs.asn1.TELETEXSTRING.prototype.toJSON=function(){var m=h.SIMPLESTRING_block.prototype.toJSON.call(this);m.block_name=j.org.pkijs.asn1.TELETEXSTRING.prototype.block_name.call(this);return m};j.org.pkijs.asn1.VIDEOTEXSTRING=function(){h.SIMPLESTRING_block.call(this,arguments[0]);this.id_block.tag_class=1;this.id_block.tag_number=21};j.org.pkijs.asn1.VIDEOTEXSTRING.prototype=new h.SIMPLESTRING_block();j.org.pkijs.asn1.VIDEOTEXSTRING.constructor=j.org.pkijs.asn1.VIDEOTEXSTRING;j.org.pkijs.asn1.VIDEOTEXSTRING.prototype.block_name=function(){return"VIDEOTEXSTRING"};j.org.pkijs.asn1.VIDEOTEXSTRING.prototype.toJSON=function(){var m=h.SIMPLESTRING_block.prototype.toJSON.call(this);m.block_name=j.org.pkijs.asn1.VIDEOTEXSTRING.prototype.block_name.call(this);return m};j.org.pkijs.asn1.IA5STRING=function(){h.SIMPLESTRING_block.call(this,arguments[0]);this.id_block.tag_class=1;this.id_block.tag_number=22};j.org.pkijs.asn1.IA5STRING.prototype=new h.SIMPLESTRING_block();j.org.pkijs.asn1.IA5STRING.constructor=j.org.pkijs.asn1.IA5STRING;j.org.pkijs.asn1.IA5STRING.prototype.block_name=function(){return"IA5STRING"};j.org.pkijs.asn1.IA5STRING.prototype.toJSON=function(){var m=h.SIMPLESTRING_block.prototype.toJSON.call(this);m.block_name=j.org.pkijs.asn1.IA5STRING.prototype.block_name.call(this);return m};j.org.pkijs.asn1.GRAPHICSTRING=function(){h.SIMPLESTRING_block.call(this,arguments[0]);this.id_block.tag_class=1;this.id_block.tag_number=25};j.org.pkijs.asn1.GRAPHICSTRING.prototype=new h.SIMPLESTRING_block();j.org.pkijs.asn1.GRAPHICSTRING.constructor=j.org.pkijs.asn1.GRAPHICSTRING;j.org.pkijs.asn1.GRAPHICSTRING.prototype.block_name=function(){return"GRAPHICSTRING"};j.org.pkijs.asn1.GRAPHICSTRING.prototype.toJSON=function(){var m=h.SIMPLESTRING_block.prototype.toJSON.call(this);m.block_name=j.org.pkijs.asn1.GRAPHICSTRING.prototype.block_name.call(this);return m};j.org.pkijs.asn1.VISIBLESTRING=function(){h.SIMPLESTRING_block.call(this,arguments[0]);this.id_block.tag_class=1;this.id_block.tag_number=26};j.org.pkijs.asn1.VISIBLESTRING.prototype=new h.SIMPLESTRING_block();j.org.pkijs.asn1.VISIBLESTRING.constructor=j.org.pkijs.asn1.VISIBLESTRING;j.org.pkijs.asn1.VISIBLESTRING.prototype.block_name=function(){return"VISIBLESTRING"};j.org.pkijs.asn1.VISIBLESTRING.prototype.toJSON=function(){var m=h.SIMPLESTRING_block.prototype.toJSON.call(this);m.block_name=j.org.pkijs.asn1.VISIBLESTRING.prototype.block_name.call(this);return m};j.org.pkijs.asn1.GENERALSTRING=function(){h.SIMPLESTRING_block.call(this,arguments[0]);this.id_block.tag_class=1;this.id_block.tag_number=27};j.org.pkijs.asn1.GENERALSTRING.prototype=new h.SIMPLESTRING_block();j.org.pkijs.asn1.GENERALSTRING.constructor=j.org.pkijs.asn1.GENERALSTRING;j.org.pkijs.asn1.GENERALSTRING.prototype.block_name=function(){return"GENERALSTRING"};j.org.pkijs.asn1.GENERALSTRING.prototype.toJSON=function(){var m=h.SIMPLESTRING_block.prototype.toJSON.call(this);m.block_name=j.org.pkijs.asn1.GENERALSTRING.prototype.block_name.call(this);return m};j.org.pkijs.asn1.CHARACTERSTRING=function(){h.SIMPLESTRING_block.call(this,arguments[0]);this.id_block.tag_class=1;this.id_block.tag_number=29};j.org.pkijs.asn1.CHARACTERSTRING.prototype=new h.SIMPLESTRING_block();j.org.pkijs.asn1.CHARACTERSTRING.constructor=j.org.pkijs.asn1.CHARACTERSTRING;j.org.pkijs.asn1.CHARACTERSTRING.prototype.block_name=function(){return"CHARACTERSTRING"};j.org.pkijs.asn1.CHARACTERSTRING.prototype.toJSON=function(){var m=h.SIMPLESTRING_block.prototype.toJSON.call(this);m.block_name=j.org.pkijs.asn1.CHARACTERSTRING.prototype.block_name.call(this);return m};j.org.pkijs.asn1.UTCTIME=function(){j.org.pkijs.asn1.VISIBLESTRING.call(this,arguments[0]);this.year=0;this.month=0;this.day=0;this.hour=0;this.minute=0;this.second=0;if((arguments[0] instanceof Object)&&("value" in arguments[0])){j.org.pkijs.asn1.UTCTIME.prototype.fromString.call(this,arguments[0].value);this.value_block.value_hex=new ArrayBuffer(arguments[0].value.length);var m=new Uint8Array(this.value_block.value_hex);for(var n=0;n<str.length;n++){m[n]=arguments[0].value.charCodeAt(n)}}if((arguments[0] instanceof Object)&&("value_date" in arguments[0])){j.org.pkijs.asn1.UTCTIME.prototype.fromDate.call(this,arguments[0].value_date);this.value_block.value_hex=j.org.pkijs.asn1.UTCTIME.prototype.toBuffer.call(this)}this.id_block.tag_class=1;this.id_block.tag_number=23};j.org.pkijs.asn1.UTCTIME.prototype=new j.org.pkijs.asn1.VISIBLESTRING();j.org.pkijs.asn1.UTCTIME.constructor=j.org.pkijs.asn1.UTCTIME;j.org.pkijs.asn1.UTCTIME.prototype.fromBER=function(m,p,o){var n=this.value_block.fromBER(m,p,(this.len_block.is_indefinite_form==true)?o:this.len_block.length);if(n==(-1)){this.error=this.value_block.error;return n}j.org.pkijs.asn1.UTCTIME.prototype.fromBuffer.call(this,this.value_block.value_hex);if(this.id_block.error.length==0){this.block_length+=this.id_block.block_length}if(this.len_block.error.length==0){this.block_length+=this.len_block.block_length}if(this.value_block.error.length==0){this.block_length+=this.value_block.block_length}return n};j.org.pkijs.asn1.UTCTIME.prototype.fromBuffer=function(m){j.org.pkijs.asn1.UTCTIME.prototype.fromString.call(this,String.fromCharCode.apply(null,new Uint8Array(m)))};j.org.pkijs.asn1.UTCTIME.prototype.toBuffer=function(){var p=j.org.pkijs.asn1.UTCTIME.prototype.toString.call(this);var n=new ArrayBuffer(p.length);var m=new Uint8Array(n);for(var o=0;o<p.length;o++){m[o]=p.charCodeAt(o)}return n};j.org.pkijs.asn1.UTCTIME.prototype.fromDate=function(m){this.year=m.getFullYear();this.month=m.getMonth()+1;this.day=m.getDate();this.hour=m.getHours();this.minute=m.getMinutes();this.second=m.getSeconds()};j.org.pkijs.asn1.UTCTIME.prototype.toDate=function(){return(new Date(this.year,this.month-1,this.day,this.hour,this.minute,this.second))};j.org.pkijs.asn1.UTCTIME.prototype.fromString=function(m){var p=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/ig;var o=p.exec(m);if(o===null){this.error="Wrong input string for convertion";return}var n=parseInt(o[1],10);if(n>=50){this.year=1900+n}else{this.year=2000+n}this.month=parseInt(o[2],10);this.day=parseInt(o[3],10);this.hour=parseInt(o[4],10);this.minute=parseInt(o[5],10);this.second=parseInt(o[6],10)};j.org.pkijs.asn1.UTCTIME.prototype.toString=function(){var m=new Array(7);m[0]=j.org.pkijs.padNumber(((this.year<2000)?(this.year-1900):(this.year-2000)),2);m[1]=j.org.pkijs.padNumber(this.month,2);m[2]=j.org.pkijs.padNumber(this.day,2);m[3]=j.org.pkijs.padNumber(this.hour,2);m[4]=j.org.pkijs.padNumber(this.minute,2);m[5]=j.org.pkijs.padNumber(this.second,2);m[6]="Z";return m.join("")};j.org.pkijs.asn1.UTCTIME.prototype.block_name=function(){return"UTCTIME"};j.org.pkijs.asn1.UTCTIME.prototype.toJSON=function(){var m=j.org.pkijs.asn1.VISIBLESTRING.prototype.toJSON.call(this);m.block_name=j.org.pkijs.asn1.UTCTIME.prototype.block_name.call(this);m.year=this.year;m.month=this.month;m.day=this.day;m.hour=this.hour;m.minute=this.minute;m.second=this.second;return m};j.org.pkijs.asn1.GENERALIZEDTIME=function(){j.org.pkijs.asn1.VISIBLESTRING.call(this,arguments[0]);this.year=0;this.month=0;this.day=0;this.hour=0;this.minute=0;this.second=0;if((arguments[0] instanceof Object)&&("value" in arguments[0])){j.org.pkijs.asn1.GENERALIZEDTIME.prototype.fromString.call(this,arguments[0].value);this.value_block.value_hex=new ArrayBuffer(arguments[0].value.length);var m=new Uint8Array(this.value_block.value_hex);for(var n=0;n<str.length;n++){m[n]=arguments[0].value.charCodeAt(n)}}if((arguments[0] instanceof Object)&&("value_date" in arguments[0])){j.org.pkijs.asn1.GENERALIZEDTIME.prototype.fromDate.call(this,arguments[0].value_date);this.value_block.value_hex=j.org.pkijs.asn1.GENERALIZEDTIME.prototype.toBuffer.call(this)}this.id_block.tag_class=1;this.id_block.tag_number=24};j.org.pkijs.asn1.GENERALIZEDTIME.prototype=new j.org.pkijs.asn1.VISIBLESTRING();j.org.pkijs.asn1.GENERALIZEDTIME.constructor=j.org.pkijs.asn1.GENERALIZEDTIME;j.org.pkijs.asn1.GENERALIZEDTIME.prototype.fromBER=function(m,p,o){var n=this.value_block.fromBER(m,p,(this.len_block.is_indefinite_form==true)?o:this.len_block.length);if(n==(-1)){this.error=this.value_block.error;return n}j.org.pkijs.asn1.GENERALIZEDTIME.prototype.fromBuffer.call(this,this.value_block.value_hex);if(this.id_block.error.length==0){this.block_length+=this.id_block.block_length}if(this.len_block.error.length==0){this.block_length+=this.len_block.block_length}if(this.value_block.error.length==0){this.block_length+=this.value_block.block_length}return n};j.org.pkijs.asn1.GENERALIZEDTIME.prototype.fromBuffer=function(m){j.org.pkijs.asn1.GENERALIZEDTIME.prototype.fromString.call(this,String.fromCharCode.apply(null,new Uint8Array(m)))};j.org.pkijs.asn1.GENERALIZEDTIME.prototype.toBuffer=function(){var p=j.org.pkijs.asn1.GENERALIZEDTIME.prototype.toString.call(this);var n=new ArrayBuffer(p.length);var m=new Uint8Array(n);for(var o=0;o<p.length;o++){m[o]=p.charCodeAt(o)}return n};j.org.pkijs.asn1.GENERALIZEDTIME.prototype.fromDate=function(m){this.year=m.getFullYear();this.month=m.getMonth()+1;this.day=m.getDate();this.hour=m.getHours();this.minute=m.getMinutes();this.second=m.getSeconds()};j.org.pkijs.asn1.GENERALIZEDTIME.prototype.toDate=function(){return(new Date(this.year,this.month-1,this.day,this.hour,this.minute,this.second))};j.org.pkijs.asn1.GENERALIZEDTIME.prototype.fromString=function(m){var o=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/ig;var n=o.exec(m);if(n===null){this.error="Wrong input string for convertion";return}this.year=parseInt(n[1],10);this.month=parseInt(n[2],10);this.day=parseInt(n[3],10);this.hour=parseInt(n[4],10);this.minute=parseInt(n[5],10);this.second=parseInt(n[6],10)};j.org.pkijs.asn1.GENERALIZEDTIME.prototype.toString=function(){var m=new Array(7);m[0]=j.org.pkijs.padNumber(this.year,4);m[1]=j.org.pkijs.padNumber(this.month,2);m[2]=j.org.pkijs.padNumber(this.day,2);m[3]=j.org.pkijs.padNumber(this.hour,2);m[4]=j.org.pkijs.padNumber(this.minute,2);m[5]=j.org.pkijs.padNumber(this.second,2);m[6]="Z";return m.join("")};j.org.pkijs.asn1.GENERALIZEDTIME.prototype.block_name=function(){return"GENERALIZEDTIME"};j.org.pkijs.asn1.GENERALIZEDTIME.prototype.toJSON=function(){var m=j.org.pkijs.asn1.VISIBLESTRING.prototype.toJSON.call(this);m.block_name=j.org.pkijs.asn1.GENERALIZEDTIME.prototype.block_name.call(this);m.year=this.year;m.month=this.month;m.day=this.day;m.hour=this.hour;m.minute=this.minute;m.second=this.second;return m};j.org.pkijs.asn1.DATE=function(){j.org.pkijs.asn1.UTF8STRING.call(this,arguments[0]);this.id_block.tag_class=1;this.id_block.tag_number=31};j.org.pkijs.asn1.DATE.prototype=new j.org.pkijs.asn1.UTF8STRING();j.org.pkijs.asn1.DATE.constructor=j.org.pkijs.asn1.DATE;j.org.pkijs.asn1.DATE.prototype.block_name=function(){return"DATE"};j.org.pkijs.asn1.DATE.prototype.toJSON=function(){var m=j.org.pkijs.asn1.UTF8STRING.prototype.toJSON.call(this);m.block_name=j.org.pkijs.asn1.DATE.prototype.block_name.call(this);return m};j.org.pkijs.asn1.TIMEOFDAY=function(){j.org.pkijs.asn1.UTF8STRING.call(this,arguments[0])};j.org.pkijs.asn1.TIMEOFDAY.prototype=new j.org.pkijs.asn1.UTF8STRING();j.org.pkijs.asn1.TIMEOFDAY.constructor=j.org.pkijs.asn1.TIMEOFDAY;j.org.pkijs.asn1.TIMEOFDAY.prototype.block_name=function(){return"TIMEOFDAY"};j.org.pkijs.asn1.DATE.prototype.toJSON=function(){var m=j.org.pkijs.asn1.UTF8STRING.prototype.toJSON.call(this);m.block_name=j.org.pkijs.asn1.TIMEOFDAY.prototype.block_name.call(this);return m};j.org.pkijs.asn1.DATETIME=function(){j.org.pkijs.asn1.UTF8STRING.call(this,arguments[0]);this.id_block.tag_class=1;this.id_block.tag_number=33};j.org.pkijs.asn1.DATETIME.prototype=new j.org.pkijs.asn1.UTF8STRING();j.org.pkijs.asn1.DATETIME.constructor=j.org.pkijs.asn1.DATETIME;j.org.pkijs.asn1.DATETIME.prototype.block_name=function(){return"DATETIME"};j.org.pkijs.asn1.DATETIME.prototype.toJSON=function(){var m=j.org.pkijs.asn1.UTF8STRING.prototype.toJSON.call(this);m.block_name=j.org.pkijs.asn1.DATETIME.prototype.block_name.call(this);return m};j.org.pkijs.asn1.DURATION=function(){j.org.pkijs.asn1.UTF8STRING.call(this,arguments[0])};j.org.pkijs.asn1.DURATION.prototype=new j.org.pkijs.asn1.UTF8STRING();j.org.pkijs.asn1.DURATION.constructor=j.org.pkijs.asn1.DURATION;j.org.pkijs.asn1.DURATION.prototype.block_name=function(){return"DURATION"};j.org.pkijs.asn1.DURATION.prototype.toJSON=function(){var m=j.org.pkijs.asn1.UTF8STRING.prototype.toJSON.call(this);m.block_name=j.org.pkijs.asn1.DURATION.prototype.block_name.call(this);return m};j.org.pkijs.asn1.TIME=function(){j.org.pkijs.asn1.UTF8STRING.call(this,arguments[0]);this.id_block.tag_class=1;this.id_block.tag_number=14};j.org.pkijs.asn1.TIME.prototype=new j.org.pkijs.asn1.UTF8STRING();j.org.pkijs.asn1.TIME.constructor=j.org.pkijs.asn1.TIME;j.org.pkijs.asn1.TIME.prototype.block_name=function(){return"TIME"};j.org.pkijs.asn1.TIME.prototype.toJSON=function(){var m=j.org.pkijs.asn1.UTF8STRING.prototype.toJSON.call(this);m.block_name=j.org.pkijs.asn1.TIME.prototype.block_name.call(this);return m};j.org.pkijs.asn1.CHOICE=function(){if(arguments[0] instanceof Object){this.value=j.org.pkijs.getValue(arguments[0],"value",new Array());this.optional=j.org.pkijs.getValue(arguments[0],"optional",false)}};j.org.pkijs.asn1.ANY=function(){if(arguments[0] instanceof Object){this.name=j.org.pkijs.getValue(arguments[0],"name","");this.optional=j.org.pkijs.getValue(arguments[0],"optional",false)}};j.org.pkijs.asn1.REPEATED=function(){if(arguments[0] instanceof Object){this.name=j.org.pkijs.getValue(arguments[0],"name","");this.optional=j.org.pkijs.getValue(arguments[0],"optional",false);this.value=j.org.pkijs.getValue(arguments[0],"value",new j.org.pkijs.asn1.ANY());this.local=j.org.pkijs.getValue(arguments[0],"local",false)}};function c(u,t,r){var o=t;function m(w,y){if(w instanceof y){return w}var x=new y();x.id_block=w.id_block;x.len_block=w.len_block;x.warnings=w.warnings;x.value_before_decode=i(w.value_before_decode);return x}var v=new j.org.pkijs.asn1.ASN1_block();if(f(u,t,r)===false){v.error="Wrong input parameters";return{offset:(-1),result:v}}var s=new Uint8Array(u,t,r);if(s.length==0){this.error="Zero buffer length";return{offset:(-1),result:v}}var q=v.id_block.fromBER(u,t,r);v.warnings.concat(v.id_block.warnings);if(q==(-1)){v.error=v.id_block.error;return{offset:(-1),result:v}}t=q;r-=v.id_block.block_length;q=v.len_block.fromBER(u,t,r);v.warnings.concat(v.len_block.warnings);if(q==(-1)){v.error=v.len_block.error;return{offset:(-1),result:v}}t=q;r-=v.len_block.block_length;if((v.id_block.is_constructed==false)&&(v.len_block.is_indefinite_form==true)){v.error=new String("Indefinite length form used for primitive encoding form");return{offset:(-1),result:v}}var n=j.org.pkijs.asn1.ASN1_block;switch(v.id_block.tag_class){case 1:if((v.id_block.tag_number>=37)&&(v.id_block.is_hex_only==false)){v.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard";return{offset:(-1),result:v}}switch(v.id_block.tag_number){case 0:if((v.id_block.is_constructed==true)&&(v.len_block.length>0)){v.error="Type [UNIVERSAL 0] is reserved";return{offset:(-1),result:v}}n=j.org.pkijs.asn1.EOC;break;case 1:n=j.org.pkijs.asn1.BOOLEAN;break;case 2:n=j.org.pkijs.asn1.INTEGER;break;case 3:n=j.org.pkijs.asn1.BITSTRING;break;case 4:n=j.org.pkijs.asn1.OCTETSTRING;break;case 5:n=j.org.pkijs.asn1.NULL;break;case 6:n=j.org.pkijs.asn1.OID;break;case 10:n=j.org.pkijs.asn1.ENUMERATED;break;case 12:n=j.org.pkijs.asn1.UTF8STRING;break;case 14:n=j.org.pkijs.asn1.TIME;break;case 15:v.error="[UNIVERSAL 15] is reserved by ASN.1 standard";return{offset:(-1),result:v};break;case 16:n=j.org.pkijs.asn1.SEQUENCE;break;case 17:n=j.org.pkijs.asn1.SET;break;case 18:n=j.org.pkijs.asn1.NUMERICSTRING;break;case 19:n=j.org.pkijs.asn1.PRINTABLESTRING;break;case 20:n=j.org.pkijs.asn1.TELETEXSTRING;break;case 21:n=j.org.pkijs.asn1.VIDEOTEXSTRING;break;case 22:n=j.org.pkijs.asn1.IA5STRING;break;case 23:n=j.org.pkijs.asn1.UTCTIME;break;case 24:n=j.org.pkijs.asn1.GENERALIZEDTIME;break;case 25:n=j.org.pkijs.asn1.GRAPHICSTRING;break;case 26:n=j.org.pkijs.asn1.VISIBLESTRING;break;case 27:n=j.org.pkijs.asn1.GENERALSTRING;break;case 28:n=j.org.pkijs.asn1.UNIVERSALSTRING;break;case 29:n=j.org.pkijs.asn1.CHARACTERSTRING;break;case 30:n=j.org.pkijs.asn1.BMPSTRING;break;case 31:n=j.org.pkijs.asn1.DATE;break;case 33:n=j.org.pkijs.asn1.DATETIME;break;default:var p;if(v.id_block.is_constructed==true){p=new j.org.pkijs.asn1.ASN1_CONSTRUCTED()}else{p=new j.org.pkijs.asn1.ASN1_PRIMITIVE()}p.id_block=v.id_block;p.len_block=v.len_block;p.warnings=v.warnings;v=p;q=v.fromBER(u,t,r)}break;case 2:case 3:case 4:default:if(v.id_block.is_constructed==true){n=j.org.pkijs.asn1.ASN1_CONSTRUCTED}else{n=j.org.pkijs.asn1.ASN1_PRIMITIVE}}v=m(v,n);q=v.fromBER(u,t,(v.len_block.is_indefinite_form==true)?r:v.len_block.length);v.value_before_decode=l(u,o,v.block_length);return{offset:q,result:v}}j.org.pkijs.fromBER=function(n){if(n.byteLength==0){var m=new j.org.pkijs.asn1.ASN1_block();m.error="Input buffer has zero length";return m}return c(n,0,n.byteLength)};j.org.pkijs.compareSchema=function(x,w,v){if(v instanceof j.org.pkijs.asn1.CHOICE){var p=false;for(var s=0;s<v.value.length;s++){var C=j.org.pkijs.compareSchema(x,w,v.value[s]);if(C.verified===true){return{verified:true,result:x}}}if(p===false){var u={verified:false,result:{error:"Wrong values for CHOICE type"}};if(v.hasOwnProperty("name")){u.name=v.name}return u}}if(v instanceof j.org.pkijs.asn1.ANY){if(v.hasOwnProperty("name")){x[v.name]=w}return{verified:true,result:x}}if((x instanceof Object)===false){return{verified:false,result:{error:"Wrong root object"}}}if((w instanceof Object)===false){return{verified:false,result:{error:"Wrong ASN.1 data"}}}if((v instanceof Object)===false){return{verified:false,result:{error:"Wrong ASN.1 schema"}}}if(("id_block" in v)===false){return{verified:false,result:{error:"Wrong ASN.1 schema"}}}if(("fromBER" in v.id_block)===false){return{verified:false,result:{error:"Wrong ASN.1 schema"}}}if(("toBER" in v.id_block)===false){return{verified:false,result:{error:"Wrong ASN.1 schema"}}}var n=v.id_block.toBER(false);if(n.byteLength===0){return{verified:false,result:{error:"Error encoding id_block for ASN.1 schema"}}}var o=v.id_block.fromBER(n,0,n.byteLength);if(o===(-1)){return{verified:false,result:{error:"Error decoding id_block for ASN.1 schema"}}}if(v.id_block.hasOwnProperty("tag_class")===false){return{verified:false,result:{error:"Wrong ASN.1 schema"}}}if(v.id_block.tag_class!==w.id_block.tag_class){return{verified:false,result:x}}if(v.id_block.hasOwnProperty("tag_number")===false){return{verified:false,result:{error:"Wrong ASN.1 schema"}}}if(v.id_block.tag_number!==w.id_block.tag_number){return{verified:false,result:x}}if(v.id_block.hasOwnProperty("is_constructed")===false){return{verified:false,result:{error:"Wrong ASN.1 schema"}}}if(v.id_block.is_constructed!==w.id_block.is_constructed){return{verified:false,result:x}}if(("is_hex_only" in v.id_block)===false){return{verified:false,result:{error:"Wrong ASN.1 schema"}}}if(v.id_block.is_hex_only!==w.id_block.is_hex_only){return{verified:false,result:x}}if(v.id_block.is_hex_only===true){if(("value_hex" in v.id_block)===false){return{verified:false,result:{error:"Wrong ASN.1 schema"}}}var y=new Uint8Array(v.id_block.value_hex);var r=new Uint8Array(w.id_block.value_hex);if(y.length!==r.length){return{verified:false,result:x}}for(var t=0;t<y.length;t++){if(y[t]!==r[1]){return{verified:false,result:x}}}}if(v.hasOwnProperty("name")){v.name=v.name.replace(/^\s+|\s+$/g,"");if(v.name!==""){x[v.name]=w}}if(v.id_block.is_constructed===true){var A=0;var C={verified:false};var z=v.value_block.value.length;if(z>0){if(v.value_block.value[0] instanceof j.org.pkijs.asn1.REPEATED){z=w.value_block.value.length}}if(z===0){return{verified:true,result:x}}if((w.value_block.value.length===0)&&(v.value_block.value.length!==0)){var m=true;for(var t=0;t<v.value_block.value.length;t++){m=m&&(v.value_block.value[t].optional||false)}if(m===true){return{verified:true,result:x}}else{if(v.hasOwnProperty("name")){v.name=v.name.replace(/^\s+|\s+$/g,"");if(v.name!==""){delete x[v.name]}}x.error="Inconsistent object length";return{verified:false,result:x}}}for(var t=0;t<z;t++){if((t-A)>=w.value_block.value.length){if(v.value_block.value[t].optional===false){var u={verified:false,result:x};x.error="Inconsistent length between ASN.1 data and schema";if(v.hasOwnProperty("name")){v.name=v.name.replace(/^\s+|\s+$/g,"");if(v.name!==""){delete x[v.name];u.name=v.name}}return u}}else{if(v.value_block.value[0] instanceof j.org.pkijs.asn1.REPEATED){C=j.org.pkijs.compareSchema(x,w.value_block.value[t],v.value_block.value[0].value);if(C.verified===false){if(v.value_block.value[0].optional===true){A++}else{if(v.hasOwnProperty("name")){v.name=v.name.replace(/^\s+|\s+$/g,"");if(v.name!==""){delete x[v.name]}}return C}}if(("name" in v.value_block.value[0])&&(v.value_block.value[0].name.length>0)){var B={};if(("local" in v.value_block.value[0])&&(v.value_block.value[0].local===true)){B=w}else{B=x}if(typeof B[v.value_block.value[0].name]==="undefined"){B[v.value_block.value[0].name]=new Array()}B[v.value_block.value[0].name].push(w.value_block.value[t])}}else{C=j.org.pkijs.compareSchema(x,w.value_block.value[t-A],v.value_block.value[t]);if(C.verified===false){if(v.value_block.value[t].optional===true){A++}else{if(v.hasOwnProperty("name")){v.name=v.name.replace(/^\s+|\s+$/g,"");if(v.name!==""){delete x[v.name]}}return C}}}}}if(C.verified===false){var u={verified:false,result:x};if(v.hasOwnProperty("name")){v.name=v.name.replace(/^\s+|\s+$/g,"");if(v.name!==""){delete x[v.name];u.name=v.name}}return u}return{verified:true,result:x}}else{if(("primitive_schema" in v)&&("value_hex" in w.value_block)){var q=j.org.pkijs.fromBER(w.value_block.value_hex);if(q.offset===(-1)){var u={verified:false,result:q.result};if(v.hasOwnProperty("name")){v.name=v.name.replace(/^\s+|\s+$/g,"");if(v.name!==""){delete x[v.name];u.name=v.name}}return u}return j.org.pkijs.compareSchema(x,q.result,v.primitive_schema)}else{return{verified:true,result:x}}}};j.org.pkijs.verifySchema=function(n,o){if((o instanceof Object)===false){return{varified:false,result:{error:"Wrong ASN.1 schema type"}}}var m=j.org.pkijs.fromBER(n);if(m.offset===(-1)){return{verified:false,result:m.result}}return j.org.pkijs.compareSchema(m.result,m.result,o)};j.org.pkijs.fromJSON=function(m){}})(typeof exports!=="undefined"?exports:window);