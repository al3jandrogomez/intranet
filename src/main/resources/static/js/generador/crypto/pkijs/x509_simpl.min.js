
(function(b){if(typeof b.org==="undefined"){b.org={}}else{if(typeof b.org!=="object"){throw new Error("Name org already exists and it's not an object")}}if(typeof b.org.pkijs==="undefined"){b.org.pkijs={}}else{if(typeof b.org.pkijs!=="object"){throw new Error("Name org.pkijs already exists and it's not an object but "+(typeof b.org.pkijs))}}if(typeof b.org.pkijs.simpl==="undefined"){b.org.pkijs.simpl={}}else{if(typeof b.org.pkijs.simpl!=="object"){throw new Error("Name org.pkijs.simpl already exists and it's not an object but "+(typeof b.org.pkijs.simpl))}}if(typeof b.org.pkijs.simpl.x509==="undefined"){b.org.pkijs.simpl.x509={}}else{if(typeof b.org.pkijs.simpl.x509!=="object"){throw new Error("Name org.pkijs.simpl.x509 already exists and it's not an object but "+(typeof b.org.pkijs.simpl.x509))}}var a={};b.org.pkijs.simpl.TIME=function(){this.type=0;this.value=new Date(0,0,0);if((arguments[0] instanceof Object)&&("schema" in arguments[0])){b.org.pkijs.simpl.TIME.prototype.fromSchema.call(this,arguments[0].schema)}else{if(arguments[0] instanceof Object){this.type=(arguments[0].type||0);this.value=(arguments[0].value||(new Date(0,0,0)))}}};b.org.pkijs.simpl.TIME.prototype.fromSchema=function(d){var c=b.org.pkijs.compareSchema(d,d,b.org.pkijs.schema.TIME({names:{utcTimeName:"utcTimeName",generalTimeName:"generalTimeName"}}));if(c.verified===false){throw new Error("Object's schema was not verified against input data for TIME")}if("utcTimeName" in c.result){this.type=0;this.value=c.result.utcTimeName.toDate()}if("generalTimeName" in c.result){this.type=1;this.value=c.result.generalTimeName.toDate()}};b.org.pkijs.simpl.TIME.prototype.toSchema=function(){var c={};if(this.type===0){c=new b.org.pkijs.asn1.UTCTIME({value_date:this.value})}if(this.type===1){c=new b.org.pkijs.asn1.GENERALIZEDTIME({value_date:this.value})}return c};b.org.pkijs.simpl.TIME.prototype.toJSON=function(){return{type:this.type,value:this.value}};b.org.pkijs.simpl.GENERAL_NAME=function(){this.NameType=9;this.Name={};if((arguments[0] instanceof Object)&&("schema" in arguments[0])){b.org.pkijs.simpl.GENERAL_NAME.prototype.fromSchema.call(this,arguments[0].schema)}else{if(arguments[0] instanceof Object){this.NameType=arguments[0].NameType||9;this.Name=arguments[0].Name||{}}}};b.org.pkijs.simpl.GENERAL_NAME.prototype.fromSchema=function(e){var d=b.org.pkijs.compareSchema(e,e,b.org.pkijs.schema.GENERAL_NAME({names:{block_name:"block_name",otherName:"otherName",rfc822Name:"rfc822Name",dNSName:"dNSName",x400Address:"x400Address",directoryName:{names:{block_name:"directoryName"}},ediPartyName:"ediPartyName",uniformResourceIdentifier:"uniformResourceIdentifier",iPAddress:"iPAddress",registeredID:"registeredID"}}));if(d.verified===false){throw new Error("Object's schema was not verified against input data for GENERAL_NAME")}this.NameType=d.result.block_name.id_block.tag_number;switch(this.NameType){case 0:this.Name=d.result.block_name;break;case 1:case 2:case 6:var f=d.result.block_name;f.id_block.tag_class=1;f.id_block.tag_number=22;var c=f.toBER(false);this.Name=b.org.pkijs.fromBER(c).result.value_block.value;break;case 3:this.Name=d.result.block_name;break;case 4:this.Name=new b.org.pkijs.simpl.RDN({schema:d.result.directoryName});break;case 5:this.Name=d.result.ediPartyName;break;case 7:this.Name=new b.org.pkijs.asn1.OCTETSTRING({value_hex:d.result.block_name.value_block.value_hex});break;case 8:var f=d.result.block_name;f.id_block.tag_class=1;f.id_block.tag_number=6;var c=f.toBER(false);this.Name=b.org.pkijs.fromBER(c).result.value_block.toString();break;default:}};b.org.pkijs.simpl.GENERAL_NAME.prototype.toSchema=function(c){switch(this.NameType){case 0:case 3:case 5:return new b.org.pkijs.asn1.ASN1_CONSTRUCTED({id_block:{tag_class:3,tag_number:this.NameType},value:[this.Name]});break;case 1:case 2:case 6:var d=new b.org.pkijs.asn1.IA5STRING({value:this.Name});d.id_block.tag_class=3;d.id_block.tag_number=this.NameType;return d;break;case 4:return new b.org.pkijs.asn1.ASN1_CONSTRUCTED({id_block:{tag_class:3,tag_number:4},value:[this.Name.toSchema()]});break;case 7:var d=this.Name;d.id_block.tag_class=3;d.id_block.tag_number=this.NameType;return d;break;case 8:var d=new b.org.pkijs.asn1.OID({value:this.Name});d.id_block.tag_class=3;d.id_block.tag_number=this.NameType;return d;break;default:return b.org.pkijs.schema.GENERAL_NAME()}};b.org.pkijs.simpl.GENERAL_NAME.prototype.toJSON=function(){var c={NameType:this.NameType};if((typeof this.Name)==="string"){c.Name=this.Name}else{c.Name=this.Name.toJSON()}return c};b.org.pkijs.simpl.GENERAL_NAMES=function(){this.names=new Array();if((arguments[0] instanceof Object)&&("schema" in arguments[0])){b.org.pkijs.simpl.GENERAL_NAMES.prototype.fromSchema.call(this,arguments[0].schema)}else{if(arguments[0] instanceof Object){this.names=arguments[0].names||new Array()}}};b.org.pkijs.simpl.GENERAL_NAMES.prototype.fromSchema=function(e){var c=b.org.pkijs.compareSchema(e,e,new b.org.pkijs.asn1.SEQUENCE({value:[new b.org.pkijs.asn1.REPEATED({name:"names",value:b.org.pkijs.schema.GENERAL_NAME()})]}));if(c.verified===false){throw new Error("Object's schema was not verified against input data for GENERAL_NAMES")}var f=c.result.names;for(var d=0;d<f.length;d++){this.names.push(new b.org.pkijs.simpl.GENERAL_NAME({schema:f[d]}))}};b.org.pkijs.simpl.GENERAL_NAMES.prototype.toSchema=function(d){var e=new Array();for(var c=0;c<this.names.length;c++){e.push(this.names[c].toSchema())}return(new b.org.pkijs.asn1.SEQUENCE({value:e}))};b.org.pkijs.simpl.GENERAL_NAMES.prototype.toJSON=function(){var c=new Array();for(var d=0;d<this.names.length;d++){c.push(this.names[d].toJSON())}return{names:c}};b.org.pkijs.simpl.ALGORITHM_IDENTIFIER=function(){this.algorithm_id="";if((arguments[0] instanceof Object)&&("schema" in arguments[0])){b.org.pkijs.simpl.ALGORITHM_IDENTIFIER.prototype.fromSchema.call(this,arguments[0].schema)}else{if(arguments[0] instanceof Object){this.algorithm_id=arguments[0].algorithm_id||"";if("algorithm_params" in arguments[0]){this.algorithm_params=arguments[0].algorithm_params}}}};b.org.pkijs.simpl.ALGORITHM_IDENTIFIER.prototype.fromSchema=function(d){var c=b.org.pkijs.compareSchema(d,d,b.org.pkijs.schema.ALGORITHM_IDENTIFIER({names:{algorithmIdentifier:"algorithm",algorithmParams:"params"}}));if(c.verified===false){throw new Error("Object's schema was not verified against input data for ALGORITHM_IDENTIFIER")}this.algorithm_id=c.result.algorithm.value_block.toString();if("params" in c.result){this.algorithm_params=c.result.params}};b.org.pkijs.simpl.ALGORITHM_IDENTIFIER.prototype.toSchema=function(){var c=new Array();c.push(new b.org.pkijs.asn1.OID({value:this.algorithm_id}));if("algorithm_params" in this){c.push(this.algorithm_params)}return(new b.org.pkijs.asn1.SEQUENCE({value:c}))};b.org.pkijs.simpl.ALGORITHM_IDENTIFIER.prototype.getCommonName=function(){};b.org.pkijs.simpl.ALGORITHM_IDENTIFIER.prototype.toJSON=function(){var c={algorithm_id:this.algorithm_id};if("algorithm_params" in this){c.algorithm_params=this.algorithm_params.toJSON()}return c};b.org.pkijs.simpl.x509.RSAPublicKey=function(){this.modulus=new b.org.pkijs.asn1.INTEGER();this.publicExponent=new b.org.pkijs.asn1.INTEGER();if((arguments[0] instanceof Object)&&("schema" in arguments[0])){b.org.pkijs.simpl.x509.RSAPublicKey.prototype.fromSchema.call(this,arguments[0].schema)}else{if(arguments[0] instanceof Object){this.modulus=arguments[0].modulus||new b.org.pkijs.asn1.INTEGER();this.publicExponent=arguments[0].publicExponent||new b.org.pkijs.asn1.INTEGER()}}};b.org.pkijs.simpl.x509.RSAPublicKey.prototype.fromSchema=function(d){var c=b.org.pkijs.compareSchema(d,d,b.org.pkijs.schema.x509.RSAPublicKey({names:{modulus:"modulus",publicExponent:"publicExponent"}}));if(c.verified===false){throw new Error("Object's schema was not verified against input data for RSAPublicKey")}this.modulus=c.result.modulus;this.publicExponent=c.result.publicExponent};b.org.pkijs.simpl.x509.RSAPublicKey.prototype.toSchema=function(){return(new b.org.pkijs.asn1.SEQUENCE({value:[this.modulus,this.publicExponent]}))};b.org.pkijs.simpl.x509.RSAPublicKey.prototype.toJSON=function(){return{modulus:this.modulus.toJSON(),publicExponent:this.publicExponent.toJSON()}};b.org.pkijs.simpl.x509.OtherPrimeInfo=function(){this.prime=new b.org.pkijs.asn1.INTEGER();this.exponent=new b.org.pkijs.asn1.INTEGER();this.coefficient=new b.org.pkijs.asn1.INTEGER();if((arguments[0] instanceof Object)&&("schema" in arguments[0])){b.org.pkijs.simpl.x509.OtherPrimeInfo.prototype.fromSchema.call(this,arguments[0].schema)}else{if(arguments[0] instanceof Object){this.prime=arguments[0].prime||new b.org.pkijs.asn1.INTEGER();this.exponent=arguments[0].exponent||new b.org.pkijs.asn1.INTEGER();this.coefficient=arguments[0].coefficient||new b.org.pkijs.asn1.INTEGER()}}};b.org.pkijs.simpl.x509.OtherPrimeInfo.prototype.fromSchema=function(d){var c=b.org.pkijs.compareSchema(d,d,b.org.pkijs.schema.x509.OtherPrimeInfo({names:{prime:"prime",exponent:"exponent",coefficient:"coefficient"}}));if(c.verified===false){throw new Error("Object's schema was not verified against input data for OtherPrimeInfo")}this.prime=c.result.prime;this.exponent=c.result.exponent;this.coefficient=c.result.coefficient};b.org.pkijs.simpl.x509.OtherPrimeInfo.prototype.toSchema=function(){return(new b.org.pkijs.asn1.SEQUENCE({value:[this.prime,this.exponent,this.coefficient]}))};b.org.pkijs.simpl.x509.OtherPrimeInfo.prototype.toJSON=function(){return{prime:this.prime.toJSON(),exponent:this.exponent.toJSON(),coefficient:this.coefficient.toJSON()}};b.org.pkijs.simpl.x509.RSAPrivateKey=function(){this.version=0;this.modulus=new b.org.pkijs.asn1.INTEGER();this.publicExponent=new b.org.pkijs.asn1.INTEGER();this.privateExponent=new b.org.pkijs.asn1.INTEGER();this.prime1=new b.org.pkijs.asn1.INTEGER();this.prime2=new b.org.pkijs.asn1.INTEGER();this.exponent1=new b.org.pkijs.asn1.INTEGER();this.exponent2=new b.org.pkijs.asn1.INTEGER();this.coefficient=new b.org.pkijs.asn1.INTEGER();if((arguments[0] instanceof Object)&&("schema" in arguments[0])){b.org.pkijs.simpl.x509.RSAPrivateKey.prototype.fromSchema.call(this,arguments[0].schema)}else{if(arguments[0] instanceof Object){this.version=arguments[0].version||0;this.modulus=arguments[0].modulus||new b.org.pkijs.asn1.INTEGER();this.publicExponent=arguments[0].publicExponent||new b.org.pkijs.asn1.INTEGER();this.privateExponent=arguments[0].privateExponent||new b.org.pkijs.asn1.INTEGER();this.prime1=arguments[0].prime1||new b.org.pkijs.asn1.INTEGER();this.prime2=arguments[0].prime2||new b.org.pkijs.asn1.INTEGER();this.exponent1=arguments[0].exponent1||new b.org.pkijs.asn1.INTEGER();this.exponent2=arguments[0].exponent2||new b.org.pkijs.asn1.INTEGER();this.coefficient=arguments[0].coefficient||new b.org.pkijs.asn1.INTEGER();if("otherPrimeInfos" in arguments[0]){this.otherPrimeInfos=arguments[0].otherPrimeInfos||new Array()}}}};b.org.pkijs.simpl.x509.RSAPrivateKey.prototype.fromSchema=function(f){var c=b.org.pkijs.compareSchema(f,f,b.org.pkijs.schema.x509.RSAPrivateKey({names:{version:"version",modulus:"modulus",publicExponent:"publicExponent",privateExponent:"privateExponent",prime1:"prime1",prime2:"prime2",exponent1:"exponent1",exponent2:"exponent2",coefficient:"coefficient",otherPrimeInfos:"otherPrimeInfos"}}));if(c.verified===false){throw new Error("Object's schema was not verified against input data for RSAPrivateKey")}this.version=c.result.version.value_block.value_dec;this.modulus=c.result.modulus;this.publicExponent=c.result.publicExponent;this.privateExponent=c.result.privateExponent;this.prime1=c.result.prime1;this.prime2=c.result.prime2;this.exponent1=c.result.exponent1;this.exponent2=c.result.exponent2;this.coefficient=c.result.coefficient;if("otherPrimeInfos" in c.result){var e=c.result.otherPrimeInfos;for(var d=0;d<e.length;d++){this.otherPrimeInfos.push(new b.org.pkijs.simpl.x509.OtherPrimeInfo({schema:e[d]}))}}};b.org.pkijs.simpl.x509.RSAPrivateKey.prototype.toSchema=function(){var e=new Array();e.push(new b.org.pkijs.asn1.INTEGER({value:this.version}));e.push(this.modulus);e.push(this.publicExponent);e.push(this.privateExponent);e.push(this.prime1);e.push(this.prime2);e.push(this.exponent1);e.push(this.exponent2);e.push(this.coefficient);if("otherPrimeInfos" in this){var d=new Array();for(var c=0;c<this.otherPrimeInfos.length;c++){d.push(this.otherPrimeInfos[c].toSchema())}e.push(new b.org.pkijs.asn1.SEQUENCE({value:d}))}return(new b.org.pkijs.asn1.SEQUENCE({value:e}))};b.org.pkijs.simpl.x509.RSAPrivateKey.prototype.toJSON=function(){var d={version:this.version,modulus:this.modulus.toJSON(),publicExponent:this.publicExponent.toJSON(),privateExponent:this.privateExponent.toJSON(),prime1:this.prime1.toJSON(),prime2:this.prime2.toJSON(),exponent1:this.exponent1.toJSON(),exponent2:this.exponent2.toJSON(),coefficient:this.coefficient.toJSON(),};if("otherPrimeInfos" in this){d.otherPrimeInfos=new Array();for(var c=0;c<this.otherPrimeInfos.length;c++){d.otherPrimeInfos.push(this.otherPrimeInfos[c].toJSON())}}return d};b.org.pkijs.simpl.x509.RSASSA_PSS_params=function(){if((arguments[0] instanceof Object)&&("schema" in arguments[0])){b.org.pkijs.simpl.x509.RSASSA_PSS_params.prototype.fromSchema.call(this,arguments[0].schema)}else{if(arguments[0] instanceof Object){if("hashAlgorithm" in arguments[0]){this.hashAlgorithm=arguments[0].hashAlgorithm}if("maskGenAlgorithm" in arguments[0]){this.maskGenAlgorithm=arguments[0].maskGenAlgorithm}if("saltLength" in arguments[0]){this.saltLength=arguments[0].saltLength}if("trailerField" in arguments[0]){this.trailerField=arguments[0].trailerField}}}};b.org.pkijs.simpl.x509.RSASSA_PSS_params.prototype.fromSchema=function(d){var c=b.org.pkijs.compareSchema(d,d,b.org.pkijs.schema.x509.RSASSA_PSS_params({names:{hashAlgorithm:{names:{block_name:"hashAlgorithm"}},maskGenAlgorithm:{names:{block_name:"maskGenAlgorithm"}},saltLength:"saltLength",trailerField:"trailerField"}}));if(c.verified===false){throw new Error("Object's schema was not verified against input data for RSASSA_PSS_params")}if("hashAlgorithm" in c.result){this.hashAlgorithm=new b.org.pkijs.simpl.ALGORITHM_IDENTIFIER({schema:c.result.hashAlgorithm})}if("maskGenAlgorithm" in c.result){this.maskGenAlgorithm=new b.org.pkijs.simpl.ALGORITHM_IDENTIFIER({schema:c.result.maskGenAlgorithm})}if("saltLength" in c.result){this.saltLength=c.result.saltLength.value_block.value_dec}if("trailerField" in c.result){this.trailerField=c.result.trailerField.value_block.value_dec}};b.org.pkijs.simpl.x509.RSASSA_PSS_params.prototype.toSchema=function(){var c=new Array();if("hashAlgorithm" in this){c.push(new b.org.pkijs.asn1.ASN1_CONSTRUCTED({id_block:{tag_class:3,tag_number:0},value:[this.hashAlgorithm.toSchema()]}))}if("maskGenAlgorithm" in this){c.push(new b.org.pkijs.asn1.ASN1_CONSTRUCTED({id_block:{tag_class:3,tag_number:1},value:[this.maskGenAlgorithm.toSchema()]}))}if("saltLength" in this){c.push(new b.org.pkijs.asn1.ASN1_CONSTRUCTED({id_block:{tag_class:3,tag_number:2},value:[new b.org.pkijs.asn1.INTEGER({value:this.saltLength})]}))}if("trailerField" in this){c.push(new b.org.pkijs.asn1.ASN1_CONSTRUCTED({id_block:{tag_class:3,tag_number:3},value:[new b.org.pkijs.asn1.INTEGER({value:this.trailerField})]}))}return(new b.org.pkijs.asn1.SEQUENCE({value:c}))};b.org.pkijs.simpl.x509.RSASSA_PSS_params.prototype.toJSON=function(){var c={};if("hashAlgorithm" in this){c.hashAlgorithm=this.hashAlgorithm.toJSON()}if("maskGenAlgorithm" in this){c.maskGenAlgorithm=this.maskGenAlgorithm.toJSON()}if("saltLength" in this){c.saltLength=this.saltLength.toJSON()}if("trailerField" in this){c.trailerField=this.trailerField.toJSON()}return c};b.org.pkijs.simpl.PUBLIC_KEY_INFO=function(){this.algorithm=new b.org.pkijs.simpl.ALGORITHM_IDENTIFIER();this.subjectPublicKey=new b.org.pkijs.asn1.BITSTRING();if((arguments[0] instanceof Object)&&("schema" in arguments[0])){b.org.pkijs.simpl.PUBLIC_KEY_INFO.prototype.fromSchema.call(this,arguments[0].schema)}else{if(arguments[0] instanceof Object){this.algorithm=(arguments[0].algorithm||(new b.org.pkijs.simpl.ALGORITHM_IDENTIFIER()));this.subjectPublicKey=(arguments[0].subjectPublicKey||(new b.org.pkijs.asn1.BITSTRING()))}}};b.org.pkijs.simpl.PUBLIC_KEY_INFO.prototype.fromSchema=function(d){var c=b.org.pkijs.compareSchema(d,d,b.org.pkijs.schema.PUBLIC_KEY_INFO({names:{algorithm:{names:{block_name:"algorithm"}},subjectPublicKey:"subjectPublicKey"}}));if(c.verified===false){throw new Error("Object's schema was not verified against input data for PUBLIC_KEY_INFO")}this.algorithm=new b.org.pkijs.simpl.ALGORITHM_IDENTIFIER({schema:c.result.algorithm});this.subjectPublicKey=c.result.subjectPublicKey};b.org.pkijs.simpl.PUBLIC_KEY_INFO.prototype.toSchema=function(){return(new b.org.pkijs.asn1.SEQUENCE({value:[this.algorithm.toSchema(),this.subjectPublicKey]}))};b.org.pkijs.simpl.PUBLIC_KEY_INFO.prototype.importKey=function(d){var f=Promise.resolve();var e=this;if(typeof d==="undefined"){return new Promise(function(h,g){g("Need to provide publicKey input parameter")})}var c=b.org.pkijs.getCrypto();if(typeof c=="undefined"){return new Promise(function(h,g){g("Unable to create WebCrypto object")})}f=f.then(function(){return c.exportKey("spki",d)});f=f.then(function(i){var g=b.org.pkijs.fromBER(i);try{b.org.pkijs.simpl.PUBLIC_KEY_INFO.prototype.fromSchema.call(e,g.result)}catch(h){return new Promise(function(k,j){j("Error during initializing object from schema")})}},function(g){return new Promise(function(i,h){h("Error during exporting public key: "+g)})});return f};b.org.pkijs.simpl.PUBLIC_KEY_INFO.prototype.toJSON=function(){return{algorithm:this.algorithm.toJSON(),subjectPublicKey:this.subjectPublicKey.toJSON()}};b.org.pkijs.simpl.ATTR_TYPE_AND_VALUE=function(){this.type="";this.value={};if((arguments[0] instanceof Object)&&("schema" in arguments[0])){b.org.pkijs.simpl.ATTR_TYPE_AND_VALUE.prototype.fromSchema.call(this,arguments[0].schema)}else{if(arguments[0] instanceof Object){this.type=(arguments[0].type||"");this.value=(arguments[0].value||{})}}};b.org.pkijs.simpl.ATTR_TYPE_AND_VALUE.prototype.fromSchema=function(d){var c=b.org.pkijs.compareSchema(d,d,b.org.pkijs.schema.ATTR_TYPE_AND_VALUE({names:{type:"type",value:"typeValue"}}));if(c.verified===false){throw new Error("Object's schema was not verified against input data for ATTR_TYPE_AND_VALUE")}this.type=c.result.type.value_block.toString();this.value=c.result.typeValue};b.org.pkijs.simpl.ATTR_TYPE_AND_VALUE.prototype.toSchema=function(){return(new b.org.pkijs.asn1.SEQUENCE({value:[new b.org.pkijs.asn1.OID({value:this.type}),this.value]}))};b.org.pkijs.simpl.ATTR_TYPE_AND_VALUE.prototype.isEqual=function(){if(arguments[0] instanceof b.org.pkijs.simpl.ATTR_TYPE_AND_VALUE){if(this.type!==arguments[0].type){return false}if(((this.value instanceof b.org.pkijs.asn1.UTF8STRING)&&(arguments[0].value instanceof b.org.pkijs.asn1.UTF8STRING))||((this.value instanceof b.org.pkijs.asn1.BMPSTRING)&&(arguments[0].value instanceof b.org.pkijs.asn1.BMPSTRING))||((this.value instanceof b.org.pkijs.asn1.UNIVERSALSTRING)&&(arguments[0].value instanceof b.org.pkijs.asn1.UNIVERSALSTRING))||((this.value instanceof b.org.pkijs.asn1.NUMERICSTRING)&&(arguments[0].value instanceof b.org.pkijs.asn1.NUMERICSTRING))||((this.value instanceof b.org.pkijs.asn1.PRINTABLESTRING)&&(arguments[0].value instanceof b.org.pkijs.asn1.PRINTABLESTRING))||((this.value instanceof b.org.pkijs.asn1.TELETEXSTRING)&&(arguments[0].value instanceof b.org.pkijs.asn1.TELETEXSTRING))||((this.value instanceof b.org.pkijs.asn1.VIDEOTEXSTRING)&&(arguments[0].value instanceof b.org.pkijs.asn1.VIDEOTEXSTRING))||((this.value instanceof b.org.pkijs.asn1.IA5STRING)&&(arguments[0].value instanceof b.org.pkijs.asn1.IA5STRING))||((this.value instanceof b.org.pkijs.asn1.GRAPHICSTRING)&&(arguments[0].value instanceof b.org.pkijs.asn1.GRAPHICSTRING))||((this.value instanceof b.org.pkijs.asn1.VISIBLESTRING)&&(arguments[0].value instanceof b.org.pkijs.asn1.VISIBLESTRING))||((this.value instanceof b.org.pkijs.asn1.GENERALSTRING)&&(arguments[0].value instanceof b.org.pkijs.asn1.GENERALSTRING))||((this.value instanceof b.org.pkijs.asn1.CHARACTERSTRING)&&(arguments[0].value instanceof b.org.pkijs.asn1.CHARACTERSTRING))){var d=b.org.pkijs.stringPrep(this.value.value_block.value);var c=b.org.pkijs.stringPrep(arguments[0].value.value_block.value);if(d.localeCompare(c)!==0){return false}}else{if(b.org.pkijs.isEqual_buffer(this.value.value_before_decode,arguments[0].value.value_before_decode)===false){return false}}return true}else{return false}};b.org.pkijs.simpl.ATTR_TYPE_AND_VALUE.prototype.toJSON=function(){var c={type:this.type};if(Object.keys(this.value).length!==0){c.value=this.value.toJSON()}else{c.value=this.value}return c};b.org.pkijs.simpl.RDN=function(){this.types_and_values=new Array();this.value_before_decode=new ArrayBuffer(0);if((arguments[0] instanceof Object)&&("schema" in arguments[0])){b.org.pkijs.simpl.RDN.prototype.fromSchema.call(this,arguments[0].schema)}else{if(arguments[0] instanceof Object){this.types_and_values=(arguments[0].types_and_values||(new Array()));this.value_before_decode=arguments[0].value_before_decode||new ArrayBuffer(0)}}};b.org.pkijs.simpl.RDN.prototype.fromSchema=function(f){var d=b.org.pkijs.compareSchema(f,f,b.org.pkijs.schema.RDN({names:{block_name:"RDN",repeated_set:"types_and_values"}}));if(d.verified===false){throw new Error("Object's schema was not verified against input data for RDN")}if("types_and_values" in d.result){var c=d.result.types_and_values;for(var e=0;e<c.length;e++){this.types_and_values.push(new b.org.pkijs.simpl.ATTR_TYPE_AND_VALUE({schema:c[e]}))}}this.value_before_decode=d.result.RDN.value_before_decode};b.org.pkijs.simpl.RDN.prototype.toSchema=function(){if(this.value_before_decode.byteLength===0){var e=new Array();for(var d=0;d<this.types_and_values.length;d++){e.push(this.types_and_values[d].toSchema())}return(new b.org.pkijs.asn1.SEQUENCE({value:[new b.org.pkijs.asn1.SET({value:e})]}))}var c=b.org.pkijs.fromBER(this.value_before_decode);return c.result};b.org.pkijs.simpl.RDN.prototype.isEqual=function(){if(arguments[0] instanceof b.org.pkijs.simpl.RDN){if(this.types_and_values.length!=arguments[0].types_and_values.length){return false}for(var c=0;c<this.types_and_values.length;c++){if(this.types_and_values[c].isEqual(arguments[0].types_and_values[c])===false){return false}}return true}else{if(arguments[0] instanceof ArrayBuffer){return b.org.pkijs.isEqual_buffer(this.value_before_decode,arguments[0])}else{return false}}return false};b.org.pkijs.simpl.RDN.prototype.toJSON=function(){var d={types_and_values:new Array()};for(var c=0;c<this.types_and_values.length;c++){d.types_and_values.push(this.types_and_values[c].toJSON())}return d};b.org.pkijs.simpl.x509.AuthorityKeyIdentifier=function(){if((arguments[0] instanceof Object)&&("schema" in arguments[0])){b.org.pkijs.simpl.x509.AuthorityKeyIdentifier.prototype.fromSchema.call(this,arguments[0].schema)}else{if(arguments[0] instanceof Object){if("keyIdentifier" in arguments[0]){this.keyIdentifier=arguments[0].keyIdentifier}if("authorityCertIssuer" in arguments[0]){this.authorityCertIssuer=arguments[0].authorityCertIssuer}if("authorityCertSerialNumber" in arguments[0]){this.authorityCertSerialNumber=arguments[0].authorityCertSerialNumber}}}};b.org.pkijs.simpl.x509.AuthorityKeyIdentifier.prototype.fromSchema=function(e){var c=b.org.pkijs.compareSchema(e,e,b.org.pkijs.schema.x509.AuthorityKeyIdentifier({names:{keyIdentifier:"keyIdentifier",authorityCertIssuer:"authorityCertIssuer",authorityCertSerialNumber:"authorityCertSerialNumber"}}));if(c.verified===false){throw new Error("Object's schema was not verified against input data for AuthorityKeyIdentifier")}if("keyIdentifier" in c.result){c.result.keyIdentifier.id_block.tag_class=1;c.result.keyIdentifier.id_block.tag_number=4;this.keyIdentifier=c.result.keyIdentifier}if("authorityCertIssuer" in c.result){this.authorityCertIssuer=new Array();var f=c.result.authorityCertIssuer;for(var d=0;d<f.length;d++){this.authorityCertIssuer.push(new b.org.pkijs.simpl.GENERAL_NAME({schema:f[d]}))}}if("authorityCertSerialNumber" in c.result){c.result.authorityCertSerialNumber.id_block.tag_class=1;c.result.authorityCertSerialNumber.id_block.tag_number=2;this.authorityCertSerialNumber=c.result.authorityCertSerialNumber}};b.org.pkijs.simpl.x509.AuthorityKeyIdentifier.prototype.toSchema=function(){var f=new Array();if("keyIdentifier" in this){var e=this.keyIdentifier;e.id_block.tag_class=3;e.id_block.tag_number=0;f.push(e)}if("authorityCertIssuer" in this){var d=new Array();for(var c=0;c<this.authorityCertIssuer.length;c++){d.push(this.authorityCertIssuer[c].toSchema())}f.push(new b.org.pkijs.asn1.ASN1_CONSTRUCTED({optional:true,id_block:{tag_class:3,tag_number:1},value:[new b.org.pkijs.asn1.SEQUENCE({value:d})]}))}if("authorityCertSerialNumber" in this){var e=this.authorityCertSerialNumber;e.id_block.tag_class=3;e.id_block.tag_number=2;f.push(e)}return(new b.org.pkijs.asn1.SEQUENCE({value:f}))};b.org.pkijs.simpl.x509.AuthorityKeyIdentifier.prototype.toJSON=function(){var d={};if("keyIdentifier" in this){d.keyIdentifier=this.keyIdentifier.toJSON()}if("authorityCertIssuer" in this){d.authorityCertIssuer=new Array();for(var c=0;c<this.authorityCertIssuer.length;c++){d.authorityCertIssuer.push(this.authorityCertIssuer[c].toJSON())}}if("authorityCertSerialNumber" in this){d.authorityCertSerialNumber=this.authorityCertSerialNumber.toJSON()}return d};b.org.pkijs.simpl.x509.PrivateKeyUsagePeriod=function(){if((arguments[0] instanceof Object)&&("schema" in arguments[0])){b.org.pkijs.simpl.x509.PrivateKeyUsagePeriod.prototype.fromSchema.call(this,arguments[0].schema)}else{if(arguments[0] instanceof Object){if("notBefore" in arguments[0]){this.notBefore=arguments[0].notBefore}if("notAfter" in arguments[0]){this.notAfter=arguments[0].notAfter}}}};b.org.pkijs.simpl.x509.PrivateKeyUsagePeriod.prototype.fromSchema=function(f){var d=b.org.pkijs.compareSchema(f,f,b.org.pkijs.schema.x509.PrivateKeyUsagePeriod({names:{notBefore:"notBefore",notAfter:"notAfter"}}));if(d.verified===false){throw new Error("Object's schema was not verified against input data for PrivateKeyUsagePeriod")}if("notBefore" in d.result){var e=new b.org.pkijs.asn1.GENERALIZEDTIME();e.fromBuffer(d.result.notBefore.value_block.value_hex);this.notBefore=e.toDate()}if("notAfter" in d.result){var c=new b.org.pkijs.asn1.GENERALIZEDTIME({value_hex:d.result.notAfter.value_block.value_hex});c.fromBuffer(d.result.notAfter.value_block.value_hex);this.notAfter=c.toDate()}};b.org.pkijs.simpl.x509.PrivateKeyUsagePeriod.prototype.toSchema=function(){var c=new Array();if("notBefore" in this){c.push(new b.org.pkijs.asn1.ASN1_PRIMITIVE({id_block:{tag_class:3,tag_number:0},value_hex:(new b.org.pkijs.asn1.GENERALIZEDTIME({value_date:this.notBefore})).value_block.value_hex}))}if("notAfter" in this){c.push(new b.org.pkijs.asn1.ASN1_PRIMITIVE({id_block:{tag_class:3,tag_number:1},value_hex:(new b.org.pkijs.asn1.GENERALIZEDTIME({value_date:this.notAfter})).value_block.value_hex}))}return(new b.org.pkijs.asn1.SEQUENCE({value:c}))};b.org.pkijs.simpl.x509.PrivateKeyUsagePeriod.prototype.toJSON=function(){var c={};if("notBefore" in this){c.notBefore=this.notBefore}if("notAfter" in this){c.notAfter=this.notAfter}return c};b.org.pkijs.simpl.x509.AltName=function(){this.altNames=new Array();if((arguments[0] instanceof Object)&&("schema" in arguments[0])){b.org.pkijs.simpl.x509.AltName.prototype.fromSchema.call(this,arguments[0].schema)}else{if(arguments[0] instanceof Object){this.altNames=arguments[0].altNames||new Array()}}};b.org.pkijs.simpl.x509.AltName.prototype.fromSchema=function(e){var c=b.org.pkijs.compareSchema(e,e,b.org.pkijs.schema.x509.AltName({names:{altNames:"altNames"}}));if(c.verified===false){throw new Error("Object's schema was not verified against input data for AltName")}if("altNames" in c.result){var f=c.result.altNames;for(var d=0;d<f.length;d++){this.altNames.push(new b.org.pkijs.simpl.GENERAL_NAME({schema:f[d]}))}}};b.org.pkijs.simpl.x509.AltName.prototype.toSchema=function(){var d=new Array();for(var c=0;c<this.altNames.length;c++){d.push(this.altNames[c].toSchema())}return(new b.org.pkijs.asn1.SEQUENCE({value:d}))};b.org.pkijs.simpl.x509.AltName.prototype.toJSON=function(){var d={altNames:new Array()};for(var c=0;c<this.altNames.length;c++){d.altNames.push(this.altNames[c].toJSON())}return d};b.org.pkijs.simpl.x509.SubjectDirectoryAttributes=function(){this.attributes=new Array();if((arguments[0] instanceof Object)&&("schema" in arguments[0])){b.org.pkijs.simpl.x509.SubjectDirectoryAttributes.prototype.fromSchema.call(this,arguments[0].schema)}else{if(arguments[0] instanceof Object){this.attributes=arguments[0].attributes||new Array()}}};b.org.pkijs.simpl.x509.SubjectDirectoryAttributes.prototype.fromSchema=function(f){var c=b.org.pkijs.compareSchema(f,f,b.org.pkijs.schema.x509.SubjectDirectoryAttributes({names:{attributes:"attributes"}}));if(c.verified===false){throw new Error("Object's schema was not verified against input data for SubjectDirectoryAttributes")}var d=c.result.attributes;for(var e=0;e<d.length;e++){this.attributes.push(new b.org.pkijs.simpl.ATTRIBUTE({schema:d[e]}))}};b.org.pkijs.simpl.x509.SubjectDirectoryAttributes.prototype.toSchema=function(){var d=new Array();for(var c=0;c<this.attributes.length;c++){d.push(this.attributes[c].toSchema())}return(new b.org.pkijs.asn1.SEQUENCE({value:d}))};b.org.pkijs.simpl.x509.SubjectDirectoryAttributes.prototype.toJSON=function(){var d={attributes:new Array()};for(var c=0;c<this.attributes.length;c++){d.attributes.push(this.attributes[c].toJSON())}return d};b.org.pkijs.simpl.x509.PolicyMapping=function(){this.issuerDomainPolicy="";this.subjectDomainPolicy="";if((arguments[0] instanceof Object)&&("schema" in arguments[0])){b.org.pkijs.simpl.x509.PolicyMapping.prototype.fromSchema.call(this,arguments[0].schema)}else{if(arguments[0] instanceof Object){this.issuerDomainPolicy=arguments[0].issuerDomainPolicy||"";this.subjectDomainPolicy=arguments[0].subjectDomainPolicy||""}}};b.org.pkijs.simpl.x509.PolicyMapping.prototype.fromSchema=function(d){var c=b.org.pkijs.compareSchema(d,d,b.org.pkijs.schema.x509.PolicyMapping({names:{issuerDomainPolicy:"issuerDomainPolicy",subjectDomainPolicy:"subjectDomainPolicy"}}));if(c.verified===false){throw new Error("Object's schema was not verified against input data for PolicyMapping")}this.issuerDomainPolicy=c.result.issuerDomainPolicy.value_block.toString();this.subjectDomainPolicy=c.result.subjectDomainPolicy.value_block.toString()};b.org.pkijs.simpl.x509.PolicyMapping.prototype.toSchema=function(){return(new b.org.pkijs.asn1.SEQUENCE({value:[new b.org.pkijs.asn1.OID({value:this.issuerDomainPolicy}),new b.org.pkijs.asn1.OID({value:this.subjectDomainPolicy})]}))};b.org.pkijs.simpl.x509.PolicyMapping.prototype.toJSON=function(){return{issuerDomainPolicy:this.issuerDomainPolicy,subjectDomainPolicy:this.subjectDomainPolicy}};b.org.pkijs.simpl.x509.PolicyMappings=function(){this.mappings=new Array();if((arguments[0] instanceof Object)&&("schema" in arguments[0])){b.org.pkijs.simpl.x509.PolicyMappings.prototype.fromSchema.call(this,arguments[0].schema)}else{if(arguments[0] instanceof Object){this.mappings=arguments[0].mappings||new Array()}}};b.org.pkijs.simpl.x509.PolicyMappings.prototype.fromSchema=function(e){var c=b.org.pkijs.compareSchema(e,e,b.org.pkijs.schema.x509.PolicyMappings({names:{mappings:"mappings"}}));if(c.verified===false){throw new Error("Object's schema was not verified against input data for PolicyMappings")}var f=c.result.mappings;for(var d=0;d<f.length;d++){this.mappings.push(new b.org.pkijs.simpl.x509.PolicyMapping({schema:f[d]}))}};b.org.pkijs.simpl.x509.PolicyMappings.prototype.toSchema=function(){var d=new Array();for(var c=0;c<this.mappings.length;c++){d.push(this.mappings.toSchema())}return(new b.org.pkijs.asn1.SEQUENCE({value:d}))};b.org.pkijs.simpl.x509.PolicyMappings.prototype.toJSON=function(){var d={mappings:new Array()};for(var c=0;c<this.mappings.length;c++){d.mappings.push(this.mappings[c].toJSON())}return d};b.org.pkijs.simpl.x509.GeneralSubtree=function(){this.base=new b.org.pkijs.simpl.GENERAL_NAME();if((arguments[0] instanceof Object)&&("schema" in arguments[0])){b.org.pkijs.simpl.x509.GeneralSubtree.prototype.fromSchema.call(this,arguments[0].schema)}else{if(arguments[0] instanceof Object){this.base=arguments[0].base||new b.org.pkijs.simpl.GENERAL_NAME();if("minimum" in arguments[0]){this.minimum=arguments[0].minimum}if("maximum" in arguments[0]){this.maximum=arguments[0].maximum}}}};b.org.pkijs.simpl.x509.GeneralSubtree.prototype.fromSchema=function(d){var c=b.org.pkijs.compareSchema(d,d,b.org.pkijs.schema.x509.GeneralSubtree({names:{base:{names:{block_name:"base"}},minimum:"minimum",maximum:"maximum"}}));if(c.verified===false){throw new Error("Object's schema was not verified against input data for ")}this.base=new b.org.pkijs.simpl.GENERAL_NAME({schema:c.result.base});if("minimum" in c.result){if(c.result.minimum.value_block.is_hex_only){this.minimum=c.result.minimum}else{this.minimum=c.result.minimum.value_block.value_dec}}if("maximum" in c.result){if(c.result.maximum.value_block.is_hex_only){this.maximum=c.result.maximum}else{this.maximum=c.result.maximum.value_block.value_dec}}};b.org.pkijs.simpl.x509.GeneralSubtree.prototype.toSchema=function(){var e=new Array();e.push(this.base.toSchema());if("minimum" in this){var c=0;if(this.minimum instanceof b.org.pkijs.asn1.INTEGER){c=this.minimum}else{c=new b.org.pkijs.asn1.INTEGER({value:this.minimum})}e.push(new b.org.pkijs.asn1.ASN1_CONSTRUCTED({optional:true,id_block:{tag_class:3,tag_number:0},value:[c]}))}if("maximum" in this){var d=0;if(this.maximum instanceof b.org.pkijs.asn1.INTEGER){d=this.maximum}else{d=new b.org.pkijs.asn1.INTEGER({value:this.maximum})}e.push(new b.org.pkijs.asn1.ASN1_CONSTRUCTED({optional:true,id_block:{tag_class:3,tag_number:1},value:[d]}))}return(new b.org.pkijs.asn1.SEQUENCE({value:e}))};b.org.pkijs.simpl.x509.GeneralSubtree.prototype.toJSON=function(){var c={base:this.base.toJSON()};if("minimum" in this){if((typeof this.minimum)==="number"){c.minimum=this.minimum}else{c.minimum=this.minimum.toJSON()}}if("maximum" in this){if((typeof this.maximum)==="number"){c.maximum=this.maximum}else{c.maximum=this.maximum.toJSON()}}return c};b.org.pkijs.simpl.x509.NameConstraints=function(){if((arguments[0] instanceof Object)&&("schema" in arguments[0])){b.org.pkijs.simpl.x509.NameConstraints.prototype.fromSchema.call(this,arguments[0].schema)}else{if(arguments[0] instanceof Object){if("permittedSubtrees" in arguments[0]){this.permittedSubtrees=arguments[0].permittedSubtrees}if("excludedSubtrees" in arguments[0]){this.excludedSubtrees=arguments[0].excludedSubtrees}}}};b.org.pkijs.simpl.x509.NameConstraints.prototype.fromSchema=function(f){var d=b.org.pkijs.compareSchema(f,f,b.org.pkijs.schema.x509.NameConstraints({names:{permittedSubtrees:"permittedSubtrees",excludedSubtrees:"excludedSubtrees"}}));if(d.verified===false){throw new Error("Object's schema was not verified against input data for NameConstraints")}if("permittedSubtrees" in d.result){this.permittedSubtrees=new Array();var g=d.result.permittedSubtrees;for(var e=0;e<g.length;e++){this.permittedSubtrees.push(new b.org.pkijs.simpl.x509.GeneralSubtree({schema:g[e]}))}}if("excludedSubtrees" in d.result){this.excludedSubtrees=new Array();var c=d.result.excludedSubtrees;for(var e=0;e<c.length;e++){this.excludedSubtrees.push(new b.org.pkijs.simpl.x509.GeneralSubtree({schema:c[e]}))}}};b.org.pkijs.simpl.x509.NameConstraints.prototype.toSchema=function(){var f=new Array();if("permittedSubtrees" in this){var e=new Array();for(var d=0;d<this.permittedSubtrees.length;d++){e.push(this.permittedSubtrees[d].toSchema())}f.push(new b.org.pkijs.asn1.ASN1_CONSTRUCTED({optional:true,id_block:{tag_class:3,tag_number:0},value:[new b.org.pkijs.asn1.SEQUENCE({value:e})]}))}if("excludedSubtrees" in this){var c=new Array();for(var d=0;d<this.excludedSubtrees.length;d++){c.push(this.excludedSubtrees[d].toSchema())}f.push(new b.org.pkijs.asn1.ASN1_CONSTRUCTED({optional:true,id_block:{tag_class:3,tag_number:1},value:[new b.org.pkijs.asn1.SEQUENCE({value:c})]}))}return(new b.org.pkijs.asn1.SEQUENCE({value:f}))};b.org.pkijs.simpl.x509.NameConstraints.prototype.toJSON=function(){var d={};if("permittedSubtrees" in this){d.permittedSubtrees=new Array();for(var c=0;c<this.permittedSubtrees.length;c++){d.permittedSubtrees.push(this.permittedSubtrees[c].toJSON())}}if("excludedSubtrees" in this){d.excludedSubtrees=new Array();for(var c=0;c<this.excludedSubtrees.length;c++){d.excludedSubtrees.push(this.excludedSubtrees[c].toJSON())}}return d};b.org.pkijs.simpl.x509.BasicConstraints=function(){if((arguments[0] instanceof Object)&&("schema" in arguments[0])){b.org.pkijs.simpl.x509.BasicConstraints.prototype.fromSchema.call(this,arguments[0].schema)}else{if(arguments[0] instanceof Object){if("cA" in arguments[0]){this.cA=arguments[0].cA}if("pathLenConstraint" in arguments[0]){this.pathLenConstraint=arguments[0].pathLenConstraint}}}};b.org.pkijs.simpl.x509.BasicConstraints.prototype.fromSchema=function(d){var c=b.org.pkijs.compareSchema(d,d,b.org.pkijs.schema.x509.BasicConstraints({names:{cA:"cA",pathLenConstraint:"pathLenConstraint"}}));if(c.verified===false){throw new Error("Object's schema was not verified against input data for BasicConstraints")}if("cA" in c.result){this.cA=c.result.cA.value_block.value}if("pathLenConstraint" in c.result){this.pathLenConstraint=c.result.pathLenConstraint.value_block.value_dec}};b.org.pkijs.simpl.x509.BasicConstraints.prototype.toSchema=function(){var c=new Array();if("cA" in this){c.push(new b.org.pkijs.asn1.BOOLEAN({value:this.cA}))}if("pathLenConstraint" in this){c.push(new b.org.pkijs.asn1.INTEGER({value:this.pathLenConstraint}))}return(new b.org.pkijs.asn1.SEQUENCE({value:c}))};b.org.pkijs.simpl.x509.BasicConstraints.prototype.toJSON=function(){var c={};if("cA" in this){c.cA=this.cA}if("pathLenConstraint" in this){c.pathLenConstraint=this.pathLenConstraint}return c};b.org.pkijs.simpl.x509.PolicyQualifierInfo=function(){this.policyQualifierId="";this.qualifier=new b.org.pkijs.asn1.ANY();if((arguments[0] instanceof Object)&&("schema" in arguments[0])){b.org.pkijs.simpl.x509.PolicyQualifierInfo.prototype.fromSchema.call(this,arguments[0].schema)}else{if(arguments[0] instanceof Object){this.policyQualifierId=arguments[0].policyQualifierId||"";this.qualifier=arguments[0].qualifier||new b.org.pkijs.asn1.ANY()}}};b.org.pkijs.simpl.x509.PolicyQualifierInfo.prototype.fromSchema=function(d){var c=b.org.pkijs.compareSchema(d,d,b.org.pkijs.schema.x509.PolicyQualifierInfo({names:{policyQualifierId:"policyQualifierId",qualifier:"qualifier"}}));if(c.verified===false){throw new Error("Object's schema was not verified against input data for PolicyQualifierInfo")}this.policyQualifierId=c.result.policyQualifierId.value_block.toString();this.qualifier=c.result.qualifier};b.org.pkijs.simpl.x509.PolicyQualifierInfo.prototype.toSchema=function(){return(new b.org.pkijs.asn1.SEQUENCE({value:[new b.org.pkijs.asn1.OID({value:this.policyQualifierId}),this.qualifier]}))};b.org.pkijs.simpl.x509.PolicyQualifierInfo.prototype.toJSON=function(){return{policyQualifierId:this.policyQualifierId,qualifier:this.qualifier.toJSON()}};b.org.pkijs.simpl.x509.PolicyInformation=function(){this.policyIdentifier="";if((arguments[0] instanceof Object)&&("schema" in arguments[0])){b.org.pkijs.simpl.x509.PolicyInformation.prototype.fromSchema.call(this,arguments[0].schema)}else{if(arguments[0] instanceof Object){this.policyIdentifier=arguments[0].policyIdentifier||"";if("policyQualifiers" in arguments[0]){this.policyQualifiers=arguments[0].policyQualifiers}}}};b.org.pkijs.simpl.x509.PolicyInformation.prototype.fromSchema=function(f){var c=b.org.pkijs.compareSchema(f,f,b.org.pkijs.schema.x509.PolicyInformation({names:{policyIdentifier:"policyIdentifier",policyQualifiers:"policyQualifiers"}}));if(c.verified===false){throw new Error("Object's schema was not verified against input data for PolicyInformation")}this.policyIdentifier=c.result.policyIdentifier.value_block.toString();if("policyQualifiers" in c.result){this.policyQualifiers=new Array();var e=c.result.policyQualifiers;for(var d=0;d<e.length;d++){this.policyQualifiers.push(new b.org.pkijs.simpl.x509.PolicyQualifierInfo({schema:e[d]}))}}};b.org.pkijs.simpl.x509.PolicyInformation.prototype.toSchema=function(){var e=new Array();e.push(new b.org.pkijs.asn1.OID({value:this.policyIdentifier}));if("policyQualifiers" in this){var d=new Array();for(var c=0;c<this.policyQualifiers.length;c++){d.push(this.policyQualifiers[c].toSchema())}e.push(new b.org.pkijs.asn1.SEQUENCE({value:d}))}return(new b.org.pkijs.asn1.SEQUENCE({value:e}))};b.org.pkijs.simpl.x509.PolicyInformation.prototype.toJSON=function(){var d={policyIdentifier:this.policyIdentifier};if("policyQualifiers" in this){d.policyQualifiers=new Array();for(var c=0;c<this.policyQualifiers.length;c++){d.policyQualifiers.push(this.policyQualifiers[c].toJSON())}}return d};b.org.pkijs.simpl.x509.CertificatePolicies=function(){this.certificatePolicies=new Array();if((arguments[0] instanceof Object)&&("schema" in arguments[0])){b.org.pkijs.simpl.x509.CertificatePolicies.prototype.fromSchema.call(this,arguments[0].schema)}else{if(arguments[0] instanceof Object){this.certificatePolicies=arguments[0].certificatePolicies||new Array()}}};b.org.pkijs.simpl.x509.CertificatePolicies.prototype.fromSchema=function(f){var d=b.org.pkijs.compareSchema(f,f,b.org.pkijs.schema.x509.CertificatePolicies({names:{certificatePolicies:"certificatePolicies"}}));if(d.verified===false){throw new Error("Object's schema was not verified against input data for CertificatePolicies")}var c=d.result.certificatePolicies;for(var e=0;e<c.length;e++){this.certificatePolicies.push(new b.org.pkijs.simpl.x509.PolicyInformation({schema:c[e]}))}};b.org.pkijs.simpl.x509.CertificatePolicies.prototype.toSchema=function(){var d=new Array();for(var c=0;c<this.certificatePolicies.length;c++){d.push(this.certificatePolicies[c].toSchema())}return(new b.org.pkijs.asn1.SEQUENCE({value:d}))};b.org.pkijs.simpl.x509.CertificatePolicies.prototype.toJSON=function(){var d={certificatePolicies:new Array()};for(var c=0;c<this.certificatePolicies.length;c++){d.certificatePolicies.push(this.certificatePolicies[c].toJSON())}return d};b.org.pkijs.simpl.x509.PolicyConstraints=function(){if((arguments[0] instanceof Object)&&("schema" in arguments[0])){b.org.pkijs.simpl.x509.PolicyConstraints.prototype.fromSchema.call(this,arguments[0].schema)}else{if(arguments[0] instanceof Object){this.requireExplicitPolicy=arguments[0].requireExplicitPolicy||0;this.inhibitPolicyMapping=arguments[0].inhibitPolicyMapping||0}}};b.org.pkijs.simpl.x509.PolicyConstraints.prototype.fromSchema=function(e){var d=b.org.pkijs.compareSchema(e,e,b.org.pkijs.schema.x509.PolicyConstraints({names:{requireExplicitPolicy:"requireExplicitPolicy",inhibitPolicyMapping:"inhibitPolicyMapping"}}));if(d.verified===false){throw new Error("Object's schema was not verified against input data for PolicyConstraints")}if("requireExplicitPolicy" in d.result){var c=d.result.requireExplicitPolicy;c.id_block.tag_class=1;c.id_block.tag_number=2;var g=c.toBER(false);var j=b.org.pkijs.fromBER(g);this.requireExplicitPolicy=j.result.value_block.value_dec}if("inhibitPolicyMapping" in d.result){var i=d.result.inhibitPolicyMapping;i.id_block.tag_class=1;i.id_block.tag_number=2;var f=i.toBER(false);var h=b.org.pkijs.fromBER(f);this.inhibitPolicyMapping=h.result.value_block.value_dec}};b.org.pkijs.simpl.x509.PolicyConstraints.prototype.toSchema=function(){var e=new Array();if("requireExplicitPolicy" in this){var d=new b.org.pkijs.asn1.INTEGER({value:this.requireExplicitPolicy});d.id_block.tag_class=3;d.id_block.tag_number=0;e.push(d)}if("inhibitPolicyMapping" in this){var c=new b.org.pkijs.asn1.INTEGER({value:this.inhibitPolicyMapping});d.id_block.tag_class=3;d.id_block.tag_number=1;e.push(c)}return(new b.org.pkijs.asn1.SEQUENCE({value:e}))};b.org.pkijs.simpl.x509.PolicyConstraints.prototype.toJSON=function(){var c={};if("requireExplicitPolicy" in this){c.requireExplicitPolicy=this.requireExplicitPolicy}if("inhibitPolicyMapping" in this){c.inhibitPolicyMapping=this.inhibitPolicyMapping}return c};b.org.pkijs.simpl.x509.ExtKeyUsage=function(){this.keyPurposes=new Array();if((arguments[0] instanceof Object)&&("schema" in arguments[0])){b.org.pkijs.simpl.x509.ExtKeyUsage.prototype.fromSchema.call(this,arguments[0].schema)}else{if(arguments[0] instanceof Object){this.keyPurposes=arguments[0].keyPurposes||new Array()}}};b.org.pkijs.simpl.x509.ExtKeyUsage.prototype.fromSchema=function(e){var c=b.org.pkijs.compareSchema(e,e,b.org.pkijs.schema.x509.ExtKeyUsage({names:{keyPurposes:"keyPurposes"}}));if(c.verified===false){throw new Error("Object's schema was not verified against input data for ExtKeyUsage")}var f=c.result.keyPurposes;for(var d=0;d<f.length;d++){this.keyPurposes.push(f[d].value_block.toString())}};b.org.pkijs.simpl.x509.ExtKeyUsage.prototype.toSchema=function(){var d=new Array();for(var c=0;c<this.keyPurposes.length;c++){d.push(new b.org.pkijs.asn1.OID({value:this.keyPurposes[c]}))}return(new b.org.pkijs.asn1.SEQUENCE({value:d}))};b.org.pkijs.simpl.x509.ExtKeyUsage.prototype.toJSON=function(){var d={keyPurposes:new Array()};for(var c=0;c<this.keyPurposes.length;c++){d.keyPurposes.push(this.keyPurposes[c])}return d};b.org.pkijs.simpl.x509.DistributionPoint=function(){if((arguments[0] instanceof Object)&&("schema" in arguments[0])){b.org.pkijs.simpl.x509.DistributionPoint.prototype.fromSchema.call(this,arguments[0].schema)}else{if(arguments[0] instanceof Object){if("distributionPoint" in arguments[0]){this.distributionPoint=arguments[0].distributionPoint}if("reasons" in arguments[0]){this.reasons=arguments[0].reasons}if("cRLIssuer" in arguments[0]){this.cRLIssuer=arguments[0].cRLIssuer}}}};b.org.pkijs.simpl.x509.DistributionPoint.prototype.fromSchema=function(f){var d=b.org.pkijs.compareSchema(f,f,b.org.pkijs.schema.x509.DistributionPoint({names:{distributionPoint:"distributionPoint",distributionPoint_names:"distributionPoint_names",reasons:"reasons",cRLIssuer:"cRLIssuer",cRLIssuer_names:"cRLIssuer_names"}}));if(d.verified===false){throw new Error("Object's schema was not verified against input data for DistributionPoint")}if("distributionPoint" in d.result){if(d.result.distributionPoint.id_block.tag_number==0){this.distributionPoint=new Array();var g=d.result.distributionPoint_names;for(var e=0;e<g.length;e++){this.distributionPoint.push(new b.org.pkijs.simpl.GENERAL_NAME({schema:g[e]}))}}if(d.result.distributionPoint.id_block.tag_number==1){d.result.distributionPoint.id_block.tag_class=1;d.result.distributionPoint.id_block.tag_number=16;this.distributionPoint=new b.org.pkijs.simpl.RDN({schema:d.result.distributionPoint})}}if("reasons" in d.result){this.reasons=new b.org.pkijs.asn1.BITSTRING({value_hex:d.result.reasons.value_block.value_hex})}if("cRLIssuer" in d.result){this.cRLIssuer=new Array();var c=d.result.cRLIssuer_names;for(var e=0;e<c;e++){this.cRLIssuer.push(new b.org.pkijs.simpl.GENERAL_NAME({schema:c[e]}))}}};b.org.pkijs.simpl.x509.DistributionPoint.prototype.toSchema=function(){var g=new Array();if("distributionPoint" in this){var d;if(this.distributionPoint instanceof Array){var f=new Array();for(var c=0;c<this.distributionPoint.length;c++){f.push(this.distributionPoint[c].toSchema())}d=new b.org.pkijs.asn1.ASN1_CONSTRUCTED({id_block:{tag_class:3,tag_number:0},value:f})}else{d=new b.org.pkijs.asn1.ASN1_CONSTRUCTED({id_block:{tag_class:3,tag_number:1},value:[this.distributionPoint.toSchema()]})}g.push(new b.org.pkijs.asn1.ASN1_CONSTRUCTED({id_block:{tag_class:3,tag_number:0},value:[d]}))}if("reasons" in this){g.push(new b.org.pkijs.asn1.ASN1_PRIMITIVE({id_block:{tag_class:3,tag_number:1},value_hex:this.reasons.value_block.value_hex}))}if("cRLIssuer" in this){var e=new b.org.pkijs.asn1.ASN1_CONSTRUCTED({name:(names.cRLIssuer||""),optional:true,id_block:{tag_class:3,tag_number:2}});for(var c=0;c<this.cRLIssuer.length;c++){e.value_block.value.push(this.cRLIssuer[c].toSchema())}g.push(e)}return(new b.org.pkijs.asn1.SEQUENCE({value:g}))};b.org.pkijs.simpl.x509.DistributionPoint.prototype.toJSON=function(){var d={};if("distributionPoint" in this){if(this.distributionPoint instanceof Array){d.distributionPoint=new Array();for(var c=0;c<this.distributionPoint.length;c++){d.distributionPoint.push(this.distributionPoint[c].toJSON())}}else{d.distributionPoint=this.distributionPoint.toJSON()}}if("reasons" in this){d.reasons=this.reasons.toJSON()}if("cRLIssuer" in this){d.cRLIssuer=new Array();for(var c=0;c<this.cRLIssuer.length;c++){d.cRLIssuer.push(this.cRLIssuer[c].toJSON())}}return d};b.org.pkijs.simpl.x509.CRLDistributionPoints=function(){this.distributionPoints=new Array();if((arguments[0] instanceof Object)&&("schema" in arguments[0])){b.org.pkijs.simpl.x509.CRLDistributionPoints.prototype.fromSchema.call(this,arguments[0].schema)}else{if(arguments[0] instanceof Object){this.distributionPoints=arguments[0].distributionPoints||new Array()}}};b.org.pkijs.simpl.x509.CRLDistributionPoints.prototype.fromSchema=function(f){var c=b.org.pkijs.compareSchema(f,f,b.org.pkijs.schema.x509.CRLDistributionPoints({names:{distributionPoints:"distributionPoints"}}));if(c.verified===false){throw new Error("Object's schema was not verified against input data for CRLDistributionPoints")}var e=c.result.distributionPoints;for(var d=0;d<e.length;d++){this.distributionPoints.push(new b.org.pkijs.simpl.x509.DistributionPoint({schema:e[d]}))}};b.org.pkijs.simpl.x509.CRLDistributionPoints.prototype.toSchema=function(){var d=new Array();for(var c=0;c<this.distributionPoints.length;c++){d.push(this.distributionPoints[c].toSchema())}return(new b.org.pkijs.asn1.SEQUENCE({value:d}))};b.org.pkijs.simpl.x509.CRLDistributionPoints.prototype.toJSON=function(){var d={distributionPoints:new Array()};for(var c=0;c<this.distributionPoints.length;c++){d.distributionPoints.push(this.distributionPoints[c].toJSON())}return d};b.org.pkijs.simpl.x509.AccessDescription=function(){this.accessMethod="";this.accessLocation=new b.org.pkijs.simpl.GENERAL_NAME();if((arguments[0] instanceof Object)&&("schema" in arguments[0])){b.org.pkijs.simpl.x509.AccessDescription.prototype.fromSchema.call(this,arguments[0].schema)}else{if(arguments[0] instanceof Object){this.accessMethod=arguments[0].accessMethod||"";this.accessLocation=arguments[0].accessLocation||new b.org.pkijs.simpl.GENERAL_NAME()}}};b.org.pkijs.simpl.x509.AccessDescription.prototype.fromSchema=function(d){var c=b.org.pkijs.compareSchema(d,d,b.org.pkijs.schema.x509.AccessDescription({names:{accessMethod:"accessMethod",accessLocation:{names:{block_name:"accessLocation"}}}}));if(c.verified===false){throw new Error("Object's schema was not verified against input data for AccessDescription")}this.accessMethod=c.result.accessMethod.value_block.toString();this.accessLocation=new b.org.pkijs.simpl.GENERAL_NAME({schema:c.result.accessLocation})};b.org.pkijs.simpl.x509.AccessDescription.prototype.toSchema=function(){return(new b.org.pkijs.asn1.SEQUENCE({value:[new b.org.pkijs.asn1.OID({value:this.accessMethod}),this.accessLocation.toSchema()]}))};b.org.pkijs.simpl.x509.AccessDescription.prototype.toJSON=function(){return{accessMethod:this.accessMethod,accessLocation:this.accessLocation.toJSON()}};b.org.pkijs.simpl.x509.InfoAccess=function(){this.accessDescriptions=new Array();if((arguments[0] instanceof Object)&&("schema" in arguments[0])){b.org.pkijs.simpl.x509.InfoAccess.prototype.fromSchema.call(this,arguments[0].schema)}else{if(arguments[0] instanceof Object){this.accessDescriptions=arguments[0].accessDescriptions||new Array()}}};b.org.pkijs.simpl.x509.InfoAccess.prototype.fromSchema=function(f){var c=b.org.pkijs.compareSchema(f,f,b.org.pkijs.schema.x509.InfoAccess({names:{accessDescriptions:"accessDescriptions"}}));if(c.verified===false){throw new Error("Object's schema was not verified against input data for InfoAccess")}var d=c.result.accessDescriptions;for(var e=0;e<d.length;e++){this.accessDescriptions.push(new b.org.pkijs.simpl.x509.AccessDescription({schema:d[e]}))}};b.org.pkijs.simpl.x509.InfoAccess.prototype.toSchema=function(){var d=new Array();for(var c=0;c<this.accessDescriptions.length;c++){d.push(this.accessDescriptions[c].toSchema())}return(new b.org.pkijs.asn1.SEQUENCE({value:d}))};b.org.pkijs.simpl.x509.InfoAccess.prototype.toJSON=function(){var d={accessDescriptions:new Array()};for(var c=0;c<this.accessDescriptions.length;c++){d.accessDescriptions.push(this.accessDescriptions[c].toJSON())}return d};b.org.pkijs.simpl.x509.IssuingDistributionPoint=function(){if((arguments[0] instanceof Object)&&("schema" in arguments[0])){b.org.pkijs.simpl.x509.IssuingDistributionPoint.prototype.fromSchema.call(this,arguments[0].schema)}else{if(arguments[0] instanceof Object){if("distributionPoint" in arguments[0]){this.distributionPoint=arguments[0].distributionPoint}if("onlyContainsUserCerts" in arguments[0]){this.onlyContainsUserCerts=arguments[0].onlyContainsUserCerts}if("onlyContainsCACerts" in arguments[0]){this.onlyContainsCACerts=arguments[0].onlyContainsCACerts}if("onlySomeReasons" in arguments[0]){this.onlySomeReasons=arguments[0].onlySomeReasons}if("indirectCRL" in arguments[0]){this.indirectCRL=arguments[0].indirectCRL}if("onlyContainsAttributeCerts" in arguments[0]){this.onlyContainsAttributeCerts=arguments[0].onlyContainsAttributeCerts}}}};b.org.pkijs.simpl.x509.IssuingDistributionPoint.prototype.fromSchema=function(f){var d=b.org.pkijs.compareSchema(f,f,b.org.pkijs.schema.x509.IssuingDistributionPoint({names:{distributionPoint:"distributionPoint",onlyContainsUserCerts:"onlyContainsUserCerts",onlyContainsCACerts:"onlyContainsCACerts",onlySomeReasons:"onlySomeReasons",indirectCRL:"indirectCRL",onlyContainsAttributeCerts:"onlyContainsAttributeCerts"}}));if(d.verified===false){throw new Error("Object's schema was not verified against input data for IssuingDistributionPoint")}if("distributionPoint" in d.result){if(d.result.distributionPoint.id_block.tag_number==0){this.distributionPoint=new Array();var g=d.result.distributionPoint_names;for(var e=0;e<g.length;e++){this.distributionPoint.push(new b.org.pkijs.simpl.GENERAL_NAME({schema:g[e]}))}}if(d.result.distributionPoint.id_block.tag_number==1){d.result.distributionPoint.id_block.tag_class=1;d.result.distributionPoint.id_block.tag_number=16;this.distributionPoint=new b.org.pkijs.simpl.RDN({schema:d.result.distributionPoint})}}if("onlyContainsUserCerts" in d.result){var c=new Uint8Array(d.result.onlyContainsUserCerts.value_block.value_hex);this.onlyContainsUserCerts=(c[0]===0)?false:true}if("onlyContainsCACerts" in d.result){var c=new Uint8Array(d.result.onlyContainsCACerts.value_block.value_hex);this.onlyContainsCACerts=(c[0]===0)?false:true}if("onlySomeReasons" in d.result){var c=new Uint8Array(d.result.onlySomeReasons.value_block.value_hex);this.onlySomeReasons=c[0]}if("indirectCRL" in d.result){var c=new Uint8Array(d.result.indirectCRL.value_block.value_hex);this.indirectCRL=(c[0]===0)?false:true}if("onlyContainsAttributeCerts" in d.result){var c=new Uint8Array(d.result.onlyContainsAttributeCerts.value_block.value_hex);this.onlyContainsAttributeCerts=(c[0]===0)?false:true}};b.org.pkijs.simpl.x509.IssuingDistributionPoint.prototype.toSchema=function(){var g=new Array();if("distributionPoint" in this){var f;if(this.distributionPoint instanceof Array){f=new b.org.pkijs.asn1.ASN1_CONSTRUCTED({id_block:{tag_class:3,tag_number:0}});for(var e=0;e<this.distributionPoint.length;e++){f.value_block.value.push(this.distributionPoint[e].toSchema())}}else{f=this.distributionPoint.toSchema();f.id_block.tag_class=3;f.id_block.tag_number=1}g.push(f)}if("onlyContainsUserCerts" in this){var d=new ArrayBuffer(1);var c=new Uint8Array(d);c[0]=(this.onlyContainsUserCerts===false)?0:255;g.push(new b.org.pkijs.asn1.ASN1_PRIMITIVE({name:(names.onlyContainsUserCerts||""),optional:true,id_block:{tag_class:3,tag_number:1},value_hex:d}))}if("onlyContainsCACerts" in this){var d=new ArrayBuffer(1);var c=new Uint8Array(d);c[0]=(this.onlyContainsCACerts===false)?0:255;g.push(new b.org.pkijs.asn1.ASN1_PRIMITIVE({name:(names.onlyContainsUserCerts||""),optional:true,id_block:{tag_class:3,tag_number:2},value_hex:d}))}if("onlySomeReasons" in this){var d=new ArrayBuffer(1);var c=new Uint8Array(d);c[0]=this.onlySomeReasons;g.push(new b.org.pkijs.asn1.ASN1_PRIMITIVE({name:(names.onlyContainsUserCerts||""),optional:true,id_block:{tag_class:3,tag_number:3},value_hex:d}))}if("indirectCRL" in this){var d=new ArrayBuffer(1);var c=new Uint8Array(d);c[0]=(this.indirectCRL===false)?0:255;g.push(new b.org.pkijs.asn1.ASN1_PRIMITIVE({name:(names.onlyContainsUserCerts||""),optional:true,id_block:{tag_class:3,tag_number:4},value_hex:d}))}if("onlyContainsAttributeCerts" in this){var d=new ArrayBuffer(1);var c=new Uint8Array(d);c[0]=(this.onlyContainsAttributeCerts===false)?0:255;g.push(new b.org.pkijs.asn1.ASN1_PRIMITIVE({name:(names.onlyContainsUserCerts||""),optional:true,id_block:{tag_class:3,tag_number:5},value_hex:d}))}return(new b.org.pkijs.asn1.SEQUENCE({value:g}))};b.org.pkijs.simpl.x509.IssuingDistributionPoint.prototype.toJSON=function(){var d={};if("distributionPoint" in this){if(this.distributionPoint instanceof Array){d.distributionPoint=new Array();for(var c=0;c<this.distributionPoint.length;c++){d.distributionPoint.push(this.distributionPoint[c].toJSON())}}else{d.distributionPoint=this.distributionPoint.toJSON()}}if("onlyContainsUserCerts" in this){d.onlyContainsUserCerts=this.onlyContainsUserCerts}if("onlyContainsCACerts" in this){d.onlyContainsCACerts=this.onlyContainsCACerts}if("onlySomeReasons" in this){d.onlySomeReasons=this.onlySomeReasons.toJSON()}if("indirectCRL" in this){d.indirectCRL=this.indirectCRL}if("onlyContainsAttributeCerts" in this){d.onlyContainsAttributeCerts=this.onlyContainsAttributeCerts}return d};b.org.pkijs.simpl.EXTENSION=function(){this.extnID="";this.critical=false;this.extnValue=new b.org.pkijs.asn1.OCTETSTRING();if((arguments[0] instanceof Object)&&("schema" in arguments[0])){b.org.pkijs.simpl.EXTENSION.prototype.fromSchema.call(this,arguments[0].schema)}else{if(arguments[0] instanceof Object){this.extnID=(arguments[0].extnID||"");this.critical=(arguments[0].critical||false);if("extnValue" in arguments[0]){this.extnValue=new b.org.pkijs.asn1.OCTETSTRING({value_hex:arguments[0].extnValue})}else{this.extnValue=new b.org.pkijs.asn1.OCTETSTRING()}if("parsedValue" in arguments[0]){this.parsedValue=arguments[0].parsedValue}}}};b.org.pkijs.simpl.EXTENSION.prototype.fromSchema=function(d){var c=b.org.pkijs.compareSchema(d,d,b.org.pkijs.schema.EXTENSION({names:{extnID:"extnID",critical:"critical",extnValue:"extnValue"}}));if(c.verified===false){throw new Error("Object's schema was not verified against input data for EXTENSION")}this.extnID=c.result.extnID.value_block.toString();if("critical" in c.result){this.critical=c.result.critical.value_block.value}this.extnValue=c.result.extnValue;var c=b.org.pkijs.fromBER(this.extnValue.value_block.value_hex);if(c.offset===(-1)){return}switch(this.extnID){case"2.5.29.9":this.parsedValue=new b.org.pkijs.simpl.x509.SubjectDirectoryAttributes({schema:c.result});break;case"2.5.29.14":this.parsedValue=c.result;break;case"2.5.29.15":this.parsedValue=c.result;break;case"2.5.29.16":this.parsedValue=new b.org.pkijs.simpl.x509.PrivateKeyUsagePeriod({schema:c.result});break;case"2.5.29.17":case"2.5.29.18":this.parsedValue=new b.org.pkijs.simpl.x509.AltName({schema:c.result});break;case"2.5.29.19":this.parsedValue=new b.org.pkijs.simpl.x509.BasicConstraints({schema:c.result});break;case"2.5.29.20":case"2.5.29.27":this.parsedValue=c.result;break;case"2.5.29.21":this.parsedValue=c.result;break;case"2.5.29.24":this.parsedValue=c.result;break;case"2.5.29.28":this.parsedValue=new b.org.pkijs.simpl.x509.IssuingDistributionPoint({schema:c.result});break;case"2.5.29.29":this.parsedValue=new b.org.pkijs.simpl.GENERAL_NAMES({schema:c.result});break;case"2.5.29.30":this.parsedValue=new b.org.pkijs.simpl.x509.NameConstraints({schema:c.result});break;case"2.5.29.31":case"2.5.29.46":this.parsedValue=new b.org.pkijs.simpl.x509.CRLDistributionPoints({schema:c.result});break;case"2.5.29.32":this.parsedValue=new b.org.pkijs.simpl.x509.CertificatePolicies({schema:c.result});break;case"2.5.29.33":this.parsedValue=new b.org.pkijs.simpl.x509.PolicyMappings({schema:c.result});break;case"2.5.29.35":this.parsedValue=new b.org.pkijs.simpl.x509.AuthorityKeyIdentifier({schema:c.result});break;case"2.5.29.36":this.parsedValue=new b.org.pkijs.simpl.x509.PolicyConstraints({schema:c.result});break;case"2.5.29.37":this.parsedValue=new b.org.pkijs.simpl.x509.ExtKeyUsage({schema:c.result});break;case"2.5.29.54":this.parsedValue=c.result;break;case"1.3.6.1.5.5.7.1.1":case"1.3.6.1.5.5.7.1.11":this.parsedValue=new b.org.pkijs.simpl.x509.InfoAccess({schema:c.result});break;default:}};b.org.pkijs.simpl.EXTENSION.prototype.toSchema=function(){var c=new Array();c.push(new b.org.pkijs.asn1.OID({value:this.extnID}));if(this.critical){c.push(new b.org.pkijs.asn1.BOOLEAN({value:this.critical}))}c.push(this.extnValue);return(new b.org.pkijs.asn1.SEQUENCE({value:c}))};b.org.pkijs.simpl.EXTENSION.prototype.toJSON=function(){var c={extnID:this.extnID,critical:this.critical,extnValue:this.extnValue.toJSON()};if("parsedValue" in this){c.parsedValue=this.parsedValue.toJSON()}return c};b.org.pkijs.simpl.EXTENSIONS=function(){this.extensions_array=new Array();if((arguments[0] instanceof Object)&&("schema" in arguments[0])){b.org.pkijs.simpl.EXTENSIONS.prototype.fromSchema.call(this,arguments[0].schema)}else{if(arguments[0] instanceof Object){this.extensions_array=(arguments[0].extensions_array||(new Array()))}}};b.org.pkijs.simpl.EXTENSIONS.prototype.fromSchema=function(e){var c=b.org.pkijs.compareSchema(e,e,b.org.pkijs.schema.EXTENSIONS({names:{extensions:"extensions"}}));if(c.verified===false){throw new Error("Object's schema was not verified against input data for EXTENSIONS")}for(var d=0;d<c.result.extensions.length;d++){this.extensions_array.push(new b.org.pkijs.simpl.EXTENSION({schema:c.result.extensions[d]}))}};b.org.pkijs.simpl.EXTENSIONS.prototype.toSchema=function(){var d=new Array();for(var c=0;c<this.extensions_array.length;c++){d.push(this.extensions_array[c].toSchema())}return(new b.org.pkijs.asn1.SEQUENCE({value:d}))};b.org.pkijs.simpl.EXTENSIONS.prototype.toJSON=function(){var d={extensions_array:new Array()};for(var c=0;c<this.extensions_array.length;c++){d.extensions_array.push(this.extensions_array[c].toJSON())}return d};b.org.pkijs.simpl.CERT=function(){this.tbs=new ArrayBuffer(0);this.serialNumber=new b.org.pkijs.asn1.INTEGER();this.signature=new b.org.pkijs.simpl.ALGORITHM_IDENTIFIER();this.issuer=new b.org.pkijs.simpl.RDN();this.notBefore=new b.org.pkijs.simpl.TIME();this.notAfter=new b.org.pkijs.simpl.TIME();this.subject=new b.org.pkijs.simpl.RDN();this.subjectPublicKeyInfo=new b.org.pkijs.simpl.PUBLIC_KEY_INFO();this.signatureAlgorithm=new b.org.pkijs.simpl.ALGORITHM_IDENTIFIER();this.signatureValue=new b.org.pkijs.asn1.BITSTRING();if((arguments[0] instanceof Object)&&("schema" in arguments[0])){b.org.pkijs.simpl.CERT.prototype.fromSchema.call(this,arguments[0].schema)}else{if(arguments[0] instanceof Object){this.tbs=arguments[0].tbs||new ArrayBuffer(0);if("version" in arguments[0]){this.version=arguments[0].version}this.serialNumber=arguments[0].serialNumber||new b.org.pkijs.asn1.INTEGER();this.signature=arguments[0].signature||new b.org.pkijs.simpl.ALGORITHM_IDENTIFIER();this.issuer=arguments[0].issuer||new b.org.pkijs.simpl.RDN();this.notBefore=arguments[0].not_before||new b.org.pkijs.simpl.TIME();this.notAfter=arguments[0].not_after||new b.org.pkijs.simpl.TIME();this.subject=arguments[0].subject||new b.org.pkijs.simpl.RDN();this.subjectPublicKeyInfo=arguments[0].subjectPublicKeyInfo||new b.org.pkijs.simpl.PUBLIC_KEY_INFO();if("issuerUniqueID" in arguments[0]){this.issuerUniqueID=arguments[0].issuerUniqueID}if("subjectUniqueID" in arguments[0]){this.subjectUniqueID=arguments[0].subjectUniqueID}if("extensions" in arguments[0]){this.extensions=arguments[0].extensions}this.signatureAlgorithm=new b.org.pkijs.simpl.ALGORITHM_IDENTIFIER();this.signatureValue=new b.org.pkijs.asn1.BITSTRING()}}};b.org.pkijs.simpl.CERT.prototype.fromSchema=function(f){var c=b.org.pkijs.compareSchema(f,f,b.org.pkijs.schema.CERT({names:{tbsCertificate:{names:{extensions:{names:{extensions:"tbsCertificate.extensions"}}}}}}));if(c.verified===false){throw new Error("Object's schema was not verified against input data for CERT")}this.tbs=c.result.tbsCertificate.value_before_decode;if("tbsCertificate.version" in c.result){this.version=c.result["tbsCertificate.version"].value_block.value_dec}this.serialNumber=c.result["tbsCertificate.serialNumber"];this.signature=new b.org.pkijs.simpl.ALGORITHM_IDENTIFIER({schema:c.result["tbsCertificate.signature"]});this.issuer=new b.org.pkijs.simpl.RDN({schema:c.result["tbsCertificate.issuer"]});this.notBefore=new b.org.pkijs.simpl.TIME({schema:c.result["tbsCertificate.notBefore"]});this.notAfter=new b.org.pkijs.simpl.TIME({schema:c.result["tbsCertificate.notAfter"]});this.subject=new b.org.pkijs.simpl.RDN({schema:c.result["tbsCertificate.subject"]});this.subjectPublicKeyInfo=new b.org.pkijs.simpl.PUBLIC_KEY_INFO({schema:c.result["tbsCertificate.subjectPublicKeyInfo"]});if("tbsCertificate.issuerUniqueID" in c.result){this.issuerUniqueID=c.result["tbsCertificate.issuerUniqueID"].value_block.value_hex}if("tbsCertificate.subjectUniqueID" in c.result){this.issuerUniqueID=c.result["tbsCertificate.subjectUniqueID"].value_block.value_hex}if("tbsCertificate.extensions" in c.result){this.extensions=new Array();var e=c.result["tbsCertificate.extensions"];for(var d=0;d<e.length;d++){this.extensions.push(new b.org.pkijs.simpl.EXTENSION({schema:e[d]}))}}this.signatureAlgorithm=new b.org.pkijs.simpl.ALGORITHM_IDENTIFIER({schema:c.result.signatureAlgorithm});this.signatureValue=c.result.signatureValue};b.org.pkijs.simpl.CERT.prototype.encodeTBS=function(){var e=new Array();if("version" in this){e.push(new b.org.pkijs.asn1.ASN1_CONSTRUCTED({optional:true,id_block:{tag_class:3,tag_number:0},value:[new b.org.pkijs.asn1.INTEGER({value:this.version})]}))}e.push(this.serialNumber);e.push(this.signature.toSchema());e.push(this.issuer.toSchema());e.push(new b.org.pkijs.asn1.SEQUENCE({value:[this.notBefore.toSchema(),this.notAfter.toSchema()]}));e.push(this.subject.toSchema());e.push(this.subjectPublicKeyInfo.toSchema());if("issuerUniqueID" in this){e.push(new b.org.pkijs.asn1.ASN1_PRIMITIVE({optional:true,id_block:{tag_class:3,tag_number:1},value_hex:this.issuerUniqueID}))}if("subjectUniqueID" in this){e.push(new b.org.pkijs.asn1.ASN1_PRIMITIVE({optional:true,id_block:{tag_class:3,tag_number:2},value_hex:this.subjectUniqueID}))}if("subjectUniqueID" in this){e.push(new b.org.pkijs.asn1.ASN1_CONSTRUCTED({optional:true,id_block:{tag_class:3,tag_number:3},value:[this.extensions.toSchema()]}))}if("extensions" in this){var d=new Array();for(var c=0;c<this.extensions.length;c++){d.push(this.extensions[c].toSchema())}e.push(new b.org.pkijs.asn1.ASN1_CONSTRUCTED({optional:true,id_block:{tag_class:3,tag_number:3},value:[new b.org.pkijs.asn1.SEQUENCE({value:d})]}))}return(new b.org.pkijs.asn1.SEQUENCE({value:e}))};b.org.pkijs.simpl.CERT.prototype.toSchema=function(e){if(typeof e==="undefined"){e=false}var d={};if(e===false){if(this.tbs.length===0){return b.org.pkijs.schema.CERT().value[0]}var c=b.org.pkijs.fromBER(this.tbs);d=c.result}else{d=b.org.pkijs.simpl.CERT.prototype.encodeTBS.call(this)}return(new b.org.pkijs.asn1.SEQUENCE({value:[d,this.signatureAlgorithm.toSchema(),this.signatureValue]}))};b.org.pkijs.simpl.CERT.prototype.verify=function(){var i=Promise.resolve();var f={};var d=this.signatureValue;var c=this.tbs;var h=this;if(this.issuer.isEqual(this.subject)){f=this.subjectPublicKeyInfo}else{if(arguments[0] instanceof Object){if("issuerCertificate" in arguments[0]){f=arguments[0].issuerCertificate.subjectPublicKeyInfo}}if((f instanceof b.org.pkijs.simpl.PUBLIC_KEY_INFO)===false){return new Promise(function(k,j){j("Please provide issuer certificate as a parameter")})}}var e=b.org.pkijs.getCrypto();if(typeof e=="undefined"){return new Promise(function(k,j){j("Unable to create WebCrypto object")})}var g=b.org.pkijs.getHashAlgorithm(this.signatureAlgorithm);if(g===""){return new Promise(function(k,j){j("Unsupported signature algorithm: "+h.signatureAlgorithm.algorithm_id)})}i=i.then(function(){var o=b.org.pkijs.getAlgorithmByOID(h.signatureAlgorithm.algorithm_id);if(("name" in o)===false){return new Promise(function(q,p){p("Unsupported public key algorithm: "+h.signatureAlgorithm.algorithm_id)})}var j=o.name;var l=b.org.pkijs.getAlgorithmParameters(j,"importkey");if("hash" in l.algorithm){l.algorithm.hash.name=g}var n=f.toSchema();var k=n.toBER(false);var m=new Uint8Array(k);return e.importKey("spki",m,l.algorithm,true,l.usages)});i=i.then(function(p){var l=b.org.pkijs.getAlgorithmParameters(p.algorithm.name,"verify");if("hash" in l.algorithm){l.algorithm.hash.name=g}var q=d.value_block.value_hex;if(p.algorithm.name==="ECDSA"){var k=b.org.pkijs.fromBER(q);q=b.org.pkijs.createECDSASignatureFromCMS(k.result)}if(p.algorithm.name==="RSA-PSS"){var o;try{o=new b.org.pkijs.simpl.x509.RSASSA_PSS_params({schema:h.signatureAlgorithm.algorithm_params})}catch(m){return new Promise(function(s,r){r(m)})}if("saltLength" in o){l.algorithm.saltLength=o.saltLength}else{l.algorithm.saltLength=20}var j="SHA-1";if("hashAlgorithm" in o){var n=b.org.pkijs.getAlgorithmByOID(o.hashAlgorithm.algorithm_id);if(("name" in n)===false){return new Promise(function(s,r){r("Unrecognized hash algorithm: "+o.hashAlgorithm.algorithm_id)})}j=n.name}l.algorithm.hash.name=j}return e.verify(l.algorithm,p,new Uint8Array(q),new Uint8Array(c))});return i};b.org.pkijs.simpl.CERT.prototype.sign=function(i,d){var g=this;if(typeof i==="undefined"){return new Promise(function(m,l){l("Need to provide a private key for signing")})}if(typeof d==="undefined"){d="SHA-1"}else{var f=b.org.pkijs.getOIDByAlgorithm({name:d});if(f===""){return new Promise(function(m,l){l("Unsupported hash algorithm: "+d)})}}var e=b.org.pkijs.getAlgorithmParameters(i.algorithm.name,"sign");e.algorithm.hash.name=d;switch(i.algorithm.name.toUpperCase()){case"RSASSA-PKCS1-V1_5":case"ECDSA":g.signature.algorithm_id=b.org.pkijs.getOIDByAlgorithm(e.algorithm);g.signatureAlgorithm.algorithm_id=g.signature.algorithm_id;break;case"RSA-PSS":switch(d.toUpperCase()){case"SHA-256":e.algorithm.saltLength=32;break;case"SHA-384":e.algorithm.saltLength=48;break;case"SHA-512":e.algorithm.saltLength=64;break;default:}var j={};if(d.toUpperCase()!=="SHA-1"){var h=b.org.pkijs.getOIDByAlgorithm({name:d});if(h===""){return new Promise(function(m,l){l("Unsupported hash algorithm: "+d)})}j.hashAlgorithm=new b.org.pkijs.simpl.ALGORITHM_IDENTIFIER({algorithm_id:h,algorithm_params:new b.org.pkijs.asn1.NULL()});j.maskGenAlgorithm=new b.org.pkijs.simpl.ALGORITHM_IDENTIFIER({algorithm_id:"1.2.840.113549.1.1.8",algorithm_params:j.hashAlgorithm.toSchema()})}if(e.algorithm.saltLength!==20){j.saltLength=e.algorithm.saltLength}var k=new b.org.pkijs.simpl.x509.RSASSA_PSS_params(j);g.signature=new b.org.pkijs.simpl.ALGORITHM_IDENTIFIER({algorithm_id:"1.2.840.113549.1.1.10",algorithm_params:k.toSchema()});g.signatureAlgorithm=g.signature;break;default:return new Promise(function(m,l){l("Unsupported signature algorithm: "+i.algorithm.name)})}g.tbs=b.org.pkijs.simpl.CERT.prototype.encodeTBS.call(this).toBER(false);var c=b.org.pkijs.getCrypto();if(typeof c=="undefined"){return new Promise(function(m,l){l("Unable to create WebCrypto object")})}return c.sign(e.algorithm,i,new Uint8Array(g.tbs)).then(function(l){if(e.algorithm.name==="ECDSA"){l=b.org.pkijs.createCMSECDSASignature(l)}g.signatureValue=new b.org.pkijs.asn1.BITSTRING({value_hex:l})},function(l){return new Promise(function(n,m){m("Signing error: "+l)})})};b.org.pkijs.simpl.CERT.prototype.getPublicKey=function(){var e;var g=b.org.pkijs.getCrypto();if(typeof g=="undefined"){return new Promise(function(l,k){k("Unable to create WebCrypto object")})}if(arguments[0] instanceof Object){if("algorithm" in arguments[0]){e=arguments[0].algorithm}else{return new Promise(function(l,k){k('Absent mandatory parameter "algorithm"')})}}else{var i=b.org.pkijs.getHashAlgorithm(this.signatureAlgorithm);if(i===""){return new Promise(function(l,k){k("Unsupported signature algorithm: "+this.signatureAlgorithm.algorithm_id)})}var j=b.org.pkijs.getAlgorithmByOID(this.signatureAlgorithm.algorithm_id);if(("name" in j)===false){return new Promise(function(l,k){k("Unsupported public key algorithm: "+this.signatureAlgorithm.algorithm_id)})}var c=j.name;e=b.org.pkijs.getAlgorithmParameters(c,"importkey");if("hash" in e.algorithm){e.algorithm.hash.name=i}}var h=this.subjectPublicKeyInfo.toSchema();var d=h.toBER(false);var f=new Uint8Array(d);return g.importKey("spki",f,e.algorithm,true,e.usages)};b.org.pkijs.simpl.CERT.prototype.getKeyHash=function(){var c=b.org.pkijs.getCrypto();if(typeof c=="undefined"){return new Promise(function(e,d){d("Unable to create WebCrypto object")})}return c.digest({name:"sha-1"},new Uint8Array(this.subjectPublicKeyInfo.subjectPublicKey.value_block.value_hex))};b.org.pkijs.simpl.CERT.prototype.toJSON=function(){var d={tbs:b.org.pkijs.bufferToHexCodes(this.tbs,0,this.tbs.byteLength),serialNumber:this.serialNumber.toJSON(),signature:this.signature.toJSON(),issuer:this.issuer.toJSON(),notBefore:this.notBefore.toJSON(),notAfter:this.notAfter.toJSON(),subject:this.subject.toJSON(),subjectPublicKeyInfo:this.subjectPublicKeyInfo.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()};if("version" in this){d.version=this.version}if("issuerUniqueID" in this){d.issuerUniqueID=b.org.pkijs.bufferToHexCodes(this.issuerUniqueID,0,this.issuerUniqueID.byteLength)}if("subjectUniqueID" in this){d.subjectUniqueID=b.org.pkijs.bufferToHexCodes(this.subjectUniqueID,0,this.subjectUniqueID.byteLength)}if("extensions" in this){d.extensions=new Array();for(var c=0;c<this.extensions.length;c++){d.extensions.push(this.extensions[c].toJSON())}}return d};b.org.pkijs.simpl.REV_CERT=function(){this.userCertificate=new b.org.pkijs.asn1.INTEGER();this.revocationDate=new b.org.pkijs.simpl.TIME();if((arguments[0] instanceof Object)&&("schema" in arguments[0])){b.org.pkijs.simpl.REV_CERT.prototype.fromSchema.call(this,arguments[0].schema)}else{if(arguments[0] instanceof Object){this.userCertificate=arguments[0].userCertificate||new b.org.pkijs.asn1.INTEGER();this.revocationDate=arguments[0].revocationDate||new b.org.pkijs.simpl.TIME();if("crlEntryExtensions" in arguments[0]){this.crlEntryExtensions=arguments[0].crlEntryExtensions}}}};b.org.pkijs.simpl.REV_CERT.prototype.fromSchema=function(f){var c=b.org.pkijs.compareSchema(f,f,new b.org.pkijs.asn1.SEQUENCE({value:[new b.org.pkijs.asn1.INTEGER({name:"userCertificate"}),b.org.pkijs.schema.TIME({names:{utcTimeName:"revocationDate",generalTimeName:"revocationDate"}}),b.org.pkijs.schema.EXTENSIONS({names:{block_name:"crlEntryExtensions"}},true)]}));if(c.verified===false){throw new Error("Object's schema was not verified against input data for REV_CERT")}this.userCertificate=c.result.userCertificate;this.revocationDate=new b.org.pkijs.simpl.TIME({schema:c.result.revocationDate});if("crlEntryExtensions" in c.result){this.crlEntryExtensions=new Array();var e=c.result.crlEntryExtensions.value_block.value;for(var d=0;d<e.length;d++){this.crlEntryExtensions.push(new b.org.pkijs.simpl.EXTENSION({schema:e[d]}))}}};b.org.pkijs.simpl.REV_CERT.prototype.toSchema=function(){var c=new Array();c.push(this.userCertificate);c.push(this.revocationDate.toSchema());if("crlEntryExtensions" in this){var e=new Array();for(var d=0;d<this.crlEntryExtensions.length;d++){e.push(this.crlEntryExtensions[d].toSchema())}c.push(new b.org.pkijs.asn1.SEQUENCE({value:e}))}return(new b.org.pkijs.asn1.SEQUENCE({value:c}))};b.org.pkijs.simpl.REV_CERT.prototype.toJSON=function(){var d={userCertificate:this.userCertificate.toJSON(),revocationDate:this.revocationDate.toJSON};if("crlEntryExtensions" in this){d.crlEntryExtensions=new Array();for(var c=0;c<this.crlEntryExtensions.length;c++){d.crlEntryExtensions.push(this.crlEntryExtensions[c].toJSON())}}return d};b.org.pkijs.simpl.CRL=function(){this.tbs=new ArrayBuffer(0);this.signature=new b.org.pkijs.simpl.ALGORITHM_IDENTIFIER();this.issuer=new b.org.pkijs.simpl.RDN();this.thisUpdate=new b.org.pkijs.simpl.TIME();this.signatureAlgorithm=new b.org.pkijs.simpl.ALGORITHM_IDENTIFIER();this.signatureValue=new b.org.pkijs.asn1.BITSTRING();if((arguments[0] instanceof Object)&&("schema" in arguments[0])){b.org.pkijs.simpl.CRL.prototype.fromSchema.call(this,arguments[0].schema)}else{if(arguments[0] instanceof Object){this.tbs=arguments[0].tbs||new ArrayBuffer(0);if("version" in arguments[0]){this.version=arguments[0].version}this.signature=arguments[0].signature||new b.org.pkijs.simpl.ALGORITHM_IDENTIFIER();this.issuer=arguments[0].issuer||new b.org.pkijs.simpl.RDN();this.thisUpdate=arguments[0].thisUpdate||new b.org.pkijs.simpl.TIME();if("nextUpdate" in arguments[0]){this.nextUpdate=arguments[0].nextUpdate}if("revokedCertificates" in arguments[0]){this.revokedCertificates=arguments[0].revokedCertificates}if("crlExtensions" in arguments[0]){this.crlExtensions=arguments[0].crlExtensions}this.signatureAlgorithm=arguments[0].signatureAlgorithm||new b.org.pkijs.simpl.ALGORITHM_IDENTIFIER();this.signatureValue=arguments[0].signatureValue||new b.org.pkijs.asn1.BITSTRING()}}};b.org.pkijs.simpl.CRL.prototype.fromSchema=function(f){var c=b.org.pkijs.compareSchema(f,f,b.org.pkijs.schema.CRL());if(c.verified===false){throw new Error("Object's schema was not verified against input data for CRL")}this.tbs=c.result.tbsCertList.value_before_decode;if("tbsCertList.version" in c.result){this.version=c.result["tbsCertList.version"].value_block.value_dec}this.signature=new b.org.pkijs.simpl.ALGORITHM_IDENTIFIER({schema:c.result["tbsCertList.signature"]});this.issuer=new b.org.pkijs.simpl.RDN({schema:c.result["tbsCertList.issuer"]});this.thisUpdate=new b.org.pkijs.simpl.TIME({schema:c.result["tbsCertList.thisUpdate"]});if("tbsCertList.nextUpdate" in c.result){this.nextUpdate=new b.org.pkijs.simpl.TIME({schema:c.result["tbsCertList.nextUpdate"]})}if("tbsCertList.revokedCertificates" in c.result){this.revokedCertificates=new Array();var g=c.result["tbsCertList.revokedCertificates"];for(var e=0;e<g.length;e++){this.revokedCertificates.push(new b.org.pkijs.simpl.REV_CERT({schema:g[e]}))}}if("tbsCertList.extensions" in c.result){this.crlExtensions=new Array();var d=c.result["tbsCertList.extensions"].value_block.value;for(var e=0;e<d.length;e++){this.crlExtensions.push(new b.org.pkijs.simpl.EXTENSION({schema:d[e]}))}}this.signatureAlgorithm=new b.org.pkijs.simpl.ALGORITHM_IDENTIFIER({schema:c.result.signatureAlgorithm});this.signatureValue=c.result.signatureValue};b.org.pkijs.simpl.CRL.prototype.encodeTBS=function(){var g=new Array();if("version" in this){g.push(new b.org.pkijs.asn1.INTEGER({value:this.version}))}g.push(this.signature.toSchema());g.push(this.issuer.toSchema());g.push(this.thisUpdate.toSchema());if("nextUpdate" in this){g.push(this.nextUpdate.toSchema())}if("revokedCertificates" in this){var c=new Array();for(var e=0;e<this.revokedCertificates.length;e++){c.push(this.revokedCertificates[e].toSchema())}g.push(new b.org.pkijs.asn1.SEQUENCE({value:c}))}if("crlExtensions" in this){var f=new Array();for(var d=0;d<this.crlExtensions.length;d++){f.push(this.crlExtensions[d].toSchema())}g.push(new b.org.pkijs.asn1.ASN1_CONSTRUCTED({optional:true,id_block:{tag_class:3,tag_number:0},value:[new b.org.pkijs.asn1.SEQUENCE({value:f})]}))}return(new b.org.pkijs.asn1.SEQUENCE({value:g}))};b.org.pkijs.simpl.CRL.prototype.toSchema=function(d){if(typeof d==="undefined"){d=false}var c;if(d===false){if(this.tbs.length===0){return b.org.pkijs.schema.CRL()}c=b.org.pkijs.fromBER(this.tbs).result}else{c=b.org.pkijs.simpl.CRL.prototype.encodeTBS.call(this)}return(new b.org.pkijs.asn1.SEQUENCE({value:[c,this.signatureAlgorithm.toSchema(),this.signatureValue]}))};b.org.pkijs.simpl.CRL.prototype.verify=function(){var i=Promise.resolve();var d=this.signatureValue;var c=this.tbs;var f=-1;var h=this;if(arguments[0] instanceof Object){if("issuerCertificate" in arguments[0]){f=arguments[0].issuerCertificate.subjectPublicKeyInfo}if("publicKeyInfo" in arguments[0]){f=arguments[0].publicKeyInfo}}if((f instanceof b.org.pkijs.simpl.PUBLIC_KEY_INFO)===false){return new Promise(function(k,j){j("Issuer's certificate must be provided as an input parameter")})}var e=b.org.pkijs.getCrypto();if(typeof e=="undefined"){return new Promise(function(k,j){j("Unable to create WebCrypto object")})}var g=b.org.pkijs.getHashAlgorithm(this.signatureAlgorithm);if(g===""){return new Promise(function(k,j){j("Unsupported signature algorithm: "+h.signatureAlgorithm.algorithm_id)})}i=i.then(function(){var o=b.org.pkijs.getAlgorithmByOID(h.signature.algorithm_id);if(("name" in o)===""){return new Promise(function(q,p){p("Unsupported public key algorithm: "+h.signature.algorithm_id)})}var j=o.name;var l=b.org.pkijs.getAlgorithmParameters(j,"importkey");if("hash" in l.algorithm){l.algorithm.hash.name=g}var n=f.toSchema();var k=n.toBER(false);var m=new Uint8Array(k);return e.importKey("spki",m,l.algorithm,true,l.usages)});i=i.then(function(p){var l=b.org.pkijs.getAlgorithmParameters(p.algorithm.name,"verify");if("hash" in l.algorithm){l.algorithm.hash.name=g}var q=d.value_block.value_hex;if(p.algorithm.name==="ECDSA"){var k=b.org.pkijs.fromBER(q);q=b.org.pkijs.createECDSASignatureFromCMS(k.result)}if(p.algorithm.name==="RSA-PSS"){var o;try{o=new b.org.pkijs.simpl.x509.RSASSA_PSS_params({schema:h.signatureAlgorithm.algorithm_params})}catch(m){return new Promise(function(s,r){r(m)})}if("saltLength" in o){l.algorithm.saltLength=o.saltLength}else{l.algorithm.saltLength=20}var j="SHA-1";if("hashAlgorithm" in o){var n=b.org.pkijs.getAlgorithmByOID(o.hashAlgorithm.algorithm_id);if(("name" in n)===false){return new Promise(function(s,r){r("Unrecognized hash algorithm: "+o.hashAlgorithm.algorithm_id)})}j=n.name}l.algorithm.hash.name=j}return e.verify(l.algorithm,p,new Uint8Array(q),new Uint8Array(c))});return i};b.org.pkijs.simpl.CRL.prototype.sign=function(i,d){var g=this;if(typeof i==="undefined"){return new Promise(function(m,l){l("Need to provide a private key for signing")})}if(typeof d==="undefined"){d="SHA-1"}else{var f=b.org.pkijs.getOIDByAlgorithm({name:d});if(f===""){return new Promise(function(m,l){l("Unsupported hash algorithm: "+d)})}}var e=b.org.pkijs.getAlgorithmParameters(i.algorithm.name,"sign");e.algorithm.hash.name=d;switch(i.algorithm.name.toUpperCase()){case"RSASSA-PKCS1-V1_5":case"ECDSA":g.signature.algorithm_id=b.org.pkijs.getOIDByAlgorithm(e.algorithm);g.signatureAlgorithm.algorithm_id=g.signature.algorithm_id;break;case"RSA-PSS":switch(d.toUpperCase()){case"SHA-256":e.algorithm.saltLength=32;break;case"SHA-384":e.algorithm.saltLength=48;break;case"SHA-512":e.algorithm.saltLength=64;break;default:}var j={};if(d.toUpperCase()!=="SHA-1"){var h=b.org.pkijs.getOIDByAlgorithm({name:d});if(h===""){return new Promise(function(m,l){l("Unsupported hash algorithm: "+d)})}j.hashAlgorithm=new b.org.pkijs.simpl.ALGORITHM_IDENTIFIER({algorithm_id:h,algorithm_params:new b.org.pkijs.asn1.NULL()});j.maskGenAlgorithm=new b.org.pkijs.simpl.ALGORITHM_IDENTIFIER({algorithm_id:"1.2.840.113549.1.1.8",algorithm_params:j.hashAlgorithm.toSchema()})}if(e.algorithm.saltLength!==20){j.saltLength=e.algorithm.saltLength}var k=new b.org.pkijs.simpl.x509.RSASSA_PSS_params(j);g.signature=new b.org.pkijs.simpl.ALGORITHM_IDENTIFIER({algorithm_id:"1.2.840.113549.1.1.10",algorithm_params:k.toSchema()});g.signatureAlgorithm=g.signature;break;default:return new Promise(function(m,l){l("Unsupported signature algorithm: "+i.algorithm.name)})}g.tbs=b.org.pkijs.simpl.CRL.prototype.encodeTBS.call(this).toBER(false);var c=b.org.pkijs.getCrypto();if(typeof c=="undefined"){return new Promise(function(m,l){l("Unable to create WebCrypto object")})}return c.sign(e.algorithm,i,new Uint8Array(g.tbs)).then(function(l){if(e.algorithm.name==="ECDSA"){l=b.org.pkijs.createCMSECDSASignature(l)}g.signatureValue=new b.org.pkijs.asn1.BITSTRING({value_hex:l})},function(l){return new Promise(function(n,m){m("Signing error: "+l)})})};b.org.pkijs.simpl.CRL.prototype.isCertificateRevoked=function(){var c={};if(arguments[0] instanceof Object){if("certificate" in arguments[0]){c=arguments[0].certificate}}if((c instanceof b.org.pkijs.simpl.CERT)===false){return false}if(this.issuer.isEqual(c.issuer)===false){return false}if(("revokedCertificates" in this)===false){return false}for(var d=0;d<this.revokedCertificates.length;d++){if(this.revokedCertificates[d].userCertificate.isEqual(c.serialNumber)){return true}}return false};b.org.pkijs.simpl.CRL.prototype.toJSON=function(){var d={tbs:b.org.pkijs.bufferToHexCodes(this.tbs,0,this.tbs.byteLength),signature:this.signature.toJSON(),issuer:this.issuer.toJSON(),thisUpdate:this.thisUpdate.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()};if("version" in this){d.version=this.version}if("nextUpdate" in this){d.nextUpdate=this.nextUpdate.toJSON()}if("revokedCertificates" in this){d.revokedCertificates=new Array();for(var c=0;c<this.revokedCertificates.length;c++){d.revokedCertificates.push(this.revokedCertificates[c].toJSON())}}if("crlExtensions" in this){d.crlExtensions=new Array();for(var c=0;c<this.crlExtensions.length;c++){d.crlExtensions.push(this.crlExtensions[c].toJSON())}}return d};b.org.pkijs.simpl.ATTRIBUTE=function(){this.type="";this.values=new Array();if((arguments[0] instanceof Object)&&("schema" in arguments[0])){b.org.pkijs.simpl.ATTRIBUTE.prototype.fromSchema.call(this,arguments[0].schema)}else{if(arguments[0] instanceof Object){this.type=arguments[0].type||"";this.values=arguments[0].values||new Array()}}};b.org.pkijs.simpl.ATTRIBUTE.prototype.fromSchema=function(d){var c=b.org.pkijs.compareSchema(d,d,b.org.pkijs.schema.ATTRIBUTE({names:{type:"type",values:"values"}}));if(c.verified===false){throw new Error("Object's schema was not verified against input data for ATTRIBUTE")}this.type=c.result.type.value_block.toString();this.values=c.result.values};b.org.pkijs.simpl.ATTRIBUTE.prototype.toSchema=function(){return(new b.org.pkijs.asn1.SEQUENCE({value:[new b.org.pkijs.asn1.OID({value:this.type}),new b.org.pkijs.asn1.SET({value:this.values})]}))};b.org.pkijs.simpl.ATTRIBUTE.prototype.toJSON=function(){var d={type:this.type,values:new Array()};for(var c=0;c<this.values.length;c++){d.values.push(this.values[c].toJSON())}return d};b.org.pkijs.simpl.PKCS10=function(){this.tbs=new ArrayBuffer(0);this.version=0;this.subject=new b.org.pkijs.simpl.RDN();this.subjectPublicKeyInfo=new b.org.pkijs.simpl.PUBLIC_KEY_INFO();this.signatureAlgorithm=new b.org.pkijs.simpl.ALGORITHM_IDENTIFIER();this.signatureValue=new b.org.pkijs.asn1.BITSTRING();if((arguments[0] instanceof Object)&&("schema" in arguments[0])){b.org.pkijs.simpl.PKCS10.prototype.fromSchema.call(this,arguments[0].schema)}else{if(arguments[0] instanceof Object){this.tbs=arguments[0].tbs||new ArrayBuffer(0);this.version=arguments[0].version||0;this.subject=arguments[0].subject||new b.org.pkijs.simpl.RDN();this.subjectPublicKeyInfo=arguments[0].subjectPublicKeyInfo||new b.org.pkijs.simpl.PUBLIC_KEY_INFO();if("attributes" in arguments[0]){this.attributes=arguments[0].attributes}this.signatureAlgorithm=arguments[0].signatureAlgorithm||new b.org.pkijs.simpl.ALGORITHM_IDENTIFIER();this.signatureValue=arguments[0].signatureValue||new b.org.pkijs.asn1.BITSTRING()}}};b.org.pkijs.simpl.PKCS10.prototype.fromSchema=function(f){var c=b.org.pkijs.compareSchema(f,f,b.org.pkijs.schema.PKCS10());if(c.verified===false){throw new Error("Object's schema was not verified against input data for PKCS10")}this.tbs=c.result.CertificationRequestInfo.value_before_decode;this.version=c.result["CertificationRequestInfo.version"].value_block.value_dec;this.subject=new b.org.pkijs.simpl.RDN({schema:c.result["CertificationRequestInfo.subject"]});this.subjectPublicKeyInfo=new b.org.pkijs.simpl.PUBLIC_KEY_INFO({schema:c.result["CertificationRequestInfo.subjectPublicKeyInfo"]});if("CertificationRequestInfo.attributes" in c.result){this.attributes=new Array();var d=c.result["CertificationRequestInfo.attributes"];for(var e=0;e<d.length;e++){this.attributes.push(new b.org.pkijs.simpl.ATTRIBUTE({schema:d[e]}))}}this.signatureAlgorithm=new b.org.pkijs.simpl.ALGORITHM_IDENTIFIER({schema:c.result.signatureAlgorithm});this.signatureValue=c.result.signatureValue};b.org.pkijs.simpl.PKCS10.prototype.encodeTBS=function(){var e=new Array();e.push(new b.org.pkijs.asn1.INTEGER({value:this.version}));e.push(this.subject.toSchema());e.push(this.subjectPublicKeyInfo.toSchema());if("attributes" in this){var c=new Array();for(var d=0;d<this.attributes.length;d++){c.push(this.attributes[d].toSchema())}e.push(new b.org.pkijs.asn1.ASN1_CONSTRUCTED({id_block:{tag_class:3,tag_number:0},value:c}))}return(new b.org.pkijs.asn1.SEQUENCE({value:e}))};b.org.pkijs.simpl.PKCS10.prototype.toSchema=function(d){if(typeof d==="undefined"){d=false}var c;if(d===false){if(this.tbs.length===0){return b.org.pkijs.schema.PKCS10()}c=b.org.pkijs.fromBER(this.tbs).result}else{c=b.org.pkijs.simpl.PKCS10.prototype.encodeTBS.call(this)}return(new b.org.pkijs.asn1.SEQUENCE({value:[c,this.signatureAlgorithm.toSchema(),this.signatureValue]}))};b.org.pkijs.simpl.PKCS10.prototype.verify=function(){var i=this;var g="";var h=Promise.resolve();var f=this.subjectPublicKeyInfo;var d=this.signatureValue;var c=this.tbs;var e=b.org.pkijs.getCrypto();if(typeof e=="undefined"){return new Promise(function(k,j){j("Unable to create WebCrypto object")})}g=b.org.pkijs.getHashAlgorithm(this.signatureAlgorithm);if(g===""){return new Promise(function(k,j){j("Unsupported signature algorithm: "+i.signatureAlgorithm.algorithm_id)})}h=h.then(function(){var o=b.org.pkijs.getAlgorithmByOID(i.signatureAlgorithm.algorithm_id);if(("name" in o)===false){return new Promise(function(q,p){p("Unsupported public key algorithm: "+i.signatureAlgorithm.algorithm_id)})}var j=o.name;var l=b.org.pkijs.getAlgorithmParameters(j,"importkey");if("hash" in l.algorithm){l.algorithm.hash.name=g}var n=f.toSchema();var k=n.toBER(false);var m=new Uint8Array(k);return e.importKey("spki",m,l.algorithm,true,l.usages)});h=h.then(function(p){var l=b.org.pkijs.getAlgorithmParameters(p.algorithm.name,"verify");if("hash" in l.algorithm){l.algorithm.hash.name=g}var q=d.value_block.value_hex;if(p.algorithm.name==="ECDSA"){var k=b.org.pkijs.fromBER(q);q=b.org.pkijs.createECDSASignatureFromCMS(k.result)}if(p.algorithm.name==="RSA-PSS"){var o;try{o=new b.org.pkijs.simpl.x509.RSASSA_PSS_params({schema:i.signatureAlgorithm.algorithm_params})}catch(m){return new Promise(function(s,r){r(m)})}if("saltLength" in o){l.algorithm.saltLength=o.saltLength}else{l.algorithm.saltLength=20}var j="SHA-1";if("hashAlgorithm" in o){var n=b.org.pkijs.getAlgorithmByOID(o.hashAlgorithm.algorithm_id);if(("name" in n)===false){return new Promise(function(s,r){r("Unrecognized hash algorithm: "+o.hashAlgorithm.algorithm_id)})}j=n.name}l.algorithm.hash.name=j}return e.verify(l.algorithm,p,new Uint8Array(q),new Uint8Array(c))});return h};b.org.pkijs.simpl.PKCS10.prototype.sign=function(i,d){var g=this;if(typeof i==="undefined"){return new Promise(function(m,l){l("Need to provide a private key for signing")})}if(typeof d==="undefined"){d="SHA-1"}else{var f=b.org.pkijs.getOIDByAlgorithm({name:d});if(f===""){return new Promise(function(m,l){l("Unsupported hash algorithm: "+d)})}}var e=b.org.pkijs.getAlgorithmParameters(i.algorithm.name,"sign");e.algorithm.hash.name=d;switch(i.algorithm.name.toUpperCase()){case"RSASSA-PKCS1-V1_5":case"ECDSA":g.signatureAlgorithm.algorithm_id=b.org.pkijs.getOIDByAlgorithm(e.algorithm);break;case"RSA-PSS":switch(d.toUpperCase()){case"SHA-256":e.algorithm.saltLength=32;break;case"SHA-384":e.algorithm.saltLength=48;break;case"SHA-512":e.algorithm.saltLength=64;break;default:}var j={};if(d.toUpperCase()!=="SHA-1"){var h=b.org.pkijs.getOIDByAlgorithm({name:d});if(h===""){return new Promise(function(m,l){l("Unsupported hash algorithm: "+d)})}j.hashAlgorithm=new b.org.pkijs.simpl.ALGORITHM_IDENTIFIER({algorithm_id:h,algorithm_params:new b.org.pkijs.asn1.NULL()});j.maskGenAlgorithm=new b.org.pkijs.simpl.ALGORITHM_IDENTIFIER({algorithm_id:"1.2.840.113549.1.1.8",algorithm_params:j.hashAlgorithm.toSchema()})}if(e.algorithm.saltLength!==20){j.saltLength=e.algorithm.saltLength}var k=new b.org.pkijs.simpl.x509.RSASSA_PSS_params(j);g.signatureAlgorithm=new b.org.pkijs.simpl.ALGORITHM_IDENTIFIER({algorithm_id:"1.2.840.113549.1.1.10",algorithm_params:k.toSchema()});break;default:return new Promise(function(m,l){l("Unsupported signature algorithm: "+i.algorithm.name)})}g.tbs=b.org.pkijs.simpl.PKCS10.prototype.encodeTBS.call(this).toBER(false);var c=b.org.pkijs.getCrypto();if(typeof c=="undefined"){return new Promise(function(m,l){l("Unable to create WebCrypto object")})}return c.sign(e.algorithm,i,new Uint8Array(g.tbs)).then(function(l){if(e.algorithm.name==="ECDSA"){l=b.org.pkijs.createCMSECDSASignature(l)}g.signatureValue=new b.org.pkijs.asn1.BITSTRING({value_hex:l})},function(l){return new Promise(function(n,m){m("Signing error: "+l)})})};b.org.pkijs.simpl.PKCS10.prototype.toJSON=function(){var d={tbs:b.org.pkijs.bufferToHexCodes(this.tbs,0,this.tbs.byteLength),version:this.version,subject:this.subject.toJSON(),subjectPublicKeyInfo:this.subjectPublicKeyInfo.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()};if("attributes" in this){d.attributes=new Array();for(var c=0;c<this.attributes.length;c++){d.attributes.push(this.attributes[c].toJSON())}}return d};b.org.pkijs.simpl.PKCS8=function(){this.version=0;this.privateKeyAlgorithm=new b.org.pkijs.simpl.ALGORITHM_IDENTIFIER();this.privateKey=new b.org.pkijs.asn1.OCTETSTRING();if((arguments[0] instanceof Object)&&("schema" in arguments[0])){b.org.pkijs.simpl.PKCS8.prototype.fromSchema.call(this,arguments[0].schema)}else{if(arguments[0] instanceof Object){this.version=arguments[0].version||0;this.privateKeyAlgorithm=arguments[0].privateKeyAlgorithm||new b.org.pkijs.simpl.ALGORITHM_IDENTIFIER();this.privateKey=arguments[0].privateKey||new b.org.pkijs.asn1.OCTETSTRING();if("attributes" in arguments[0]){this.attributes=arguments[0].attributes}}}};b.org.pkijs.simpl.PKCS8.prototype.fromSchema=function(f){var c=b.org.pkijs.compareSchema(f,f,b.org.pkijs.schema.PKCS8({names:{version:"version",privateKeyAlgorithm:{names:{block_name:"privateKeyAlgorithm"}},privateKey:"privateKey",attributes:"attributes"}}));if(c.verified===false){throw new Error("Object's schema was not verified against input data for PKCS8")}this.version=c.result.version.value_block.value_dec;this.privateKeyAlgorithm=new b.org.pkijs.simpl.ALGORITHM_IDENTIFIER({schema:c.result.privateKeyAlgorithm});this.privateKey=c.result.privateKey;if("attributes" in c.result){this.attributes=new Array();var d=c.result.attributes;for(var e=0;e<d.length;e++){this.attributes.push(new b.org.pkijs.simpl.ATTRIBUTE({schema:d[e]}))}}};b.org.pkijs.simpl.PKCS8.prototype.toSchema=function(){var e=new Array();e.push(new b.org.pkijs.asn1.INTEGER({value:this.version}));e.push(this.privateKeyAlgorithm.toSchema());e.push(this.privateKey);if("attributes" in this){var c=new Array();for(var d=0;d<this.attributes.length;d++){c.push(this.attributes[d].toSchema())}e.push(new b.org.pkijs.asn1.ASN1_CONSTRUCTED({optional:true,id_block:{tag_class:3,tag_number:0},value:c}))}return(new b.org.pkijs.asn1.SEQUENCE({value:e}))};b.org.pkijs.simpl.PKCS8.prototype.toJSON=function(){var d={version:this.version,privateKeyAlgorithm:this.privateKeyAlgorithm.toJSON(),privateKey:this.privateKey.toJSON()};if("attributes" in this){d.attributes=new Array();for(var c=0;c<this.attributes.length;c++){d.attributes.push(this.attributes[c].toJSON())}}return d};b.org.pkijs.simpl.CERT_CHAIN=function(){this.trusted_certs=new Array();this.certs=new Array();this.crls=new Array();if(arguments[0] instanceof Object){this.trusted_certs=arguments[0].trusted_certs||new Array();this.certs=arguments[0].certs||new Array();this.crls=arguments[0].crls||new Array()}};b.org.pkijs.simpl.CERT_CHAIN.prototype.sort=function(){var l=new Array();var k=this.certs.slice(0);var t=new Date();var m=this;if(k.length===0){return new Promise(function(j,i){i({result:false,result_code:2,result_message:"Certificate's array can not be empty"})})}var f=-1;for(var g=0;g<k.length;g++){var h=false;if("extensions" in k[g]){var p=false;var c=false;var q=false;for(var e=0;e<k[g].extensions.length;e++){if((k[g].extensions[e].critical===true)&&(("parsedValue" in k[g].extensions[e])===false)){return new Promise(function(j,i){i({result:false,result_code:6,result_message:"Unable to parse critical certificate extension: "+k[g].extensions[e].extnID})})}if(k[g].extensions[e].extnID==="2.5.29.15"){c=true;var o=new Uint8Array(k[g].extensions[e].parsedValue.value_block.value_hex);if((o[0]&4)===4){p=true}if((o[0]&2)===2){q=true}}if(k[g].extensions[e].extnID==="2.5.29.19"){if("cA" in k[g].extensions[e].parsedValue){if(k[g].extensions[e].parsedValue.cA===true){h=true}}}}if((p===true)&&(h===false)){return new Promise(function(j,i){i({result:false,result_code:3,result_message:'Unable to build certificate chain - using "keyCertSign" flag set without BasicConstaints'})})}if((c===true)&&(h===true)&&(p===false)){return new Promise(function(j,i){i({result:false,result_code:4,result_message:'Unable to build certificate chain - "keyCertSign" flag was not set'})})}if((h===true)&&(c===true)&&(q===false)){return new Promise(function(j,i){i({result:false,result_code:5,result_message:'Unable to build certificate chain - intermediate certificate must have "cRLSign" key usage flag'})})}}if(h===false){if(l.length!==0){return new Promise(function(j,i){i({result:false,result_code:7,result_message:"Unable to build certificate chain - more than one possible end-user certificate"})})}l.push(k[g]);f=g}}k.splice(f,1);if(l.length===0){return new Promise(function(j,i){i({result:false,result_code:1,result_message:"Can't find end-user certificate"})})}if(k.length===0){if(l[0].issuer.isEqual(l[0].subject)===true){return new Promise(function(j,i){j(l)})}else{if(this.trusted_certs.length===0){return new Promise(function(j,i){i({result:false,result_code:70,result_message:"Can't find root certificate"})})}else{k=m.trusted_certs.splice(0)}}}var n=l[0];function d(j,u){var v=Promise.resolve();v=v.then(function(){if((j.notBefore.value>t)||(j.notAfter.value<t)){return new Promise(function(x,w){w({result:false,result_code:8,result_message:"Certificate validity period is out of checking date"})})}});if(m.crls.length===0){return v.then(function(){return new Promise(function(x,w){x()})})}function i(w){return m.crls[w].verify({issuerCertificate:u}).then(function(x){if(x===true){return new Promise(function(z,y){z(m.crls[w])})}else{w++;if(w<m.crls.length){return i(w)}else{return new Promise(function(z,y){y({result:false,result_code:9,result_message:"Unable to find CRL for issuer's certificate"})})}}},function(x){return new Promise(function(z,y){y({result:false,result_code:10,result_message:"Unable to find CRL for issuer's certificate"})})})}v=v.then(function(){return i(0)});v=v.then(function(w){if(w.isCertificateRevoked({certificate:j})===true){return new Promise(function(y,x){x({result:false,result_code:11,result_message:"Subject certificate was revoked"})})}else{return new Promise(function(y,x){y()})}},function(w){return new Promise(function(y,x){y()})});return v}function r(){return s(n,0).then(function(j){l.push(k[j]);n=k[j];k.splice(j,1);if(n.issuer.isEqual(n.subject)===true){var v=(m.trusted_certs.length===0)?true:false;for(var u=0;u<m.trusted_certs.length;u++){if((n.issuer.isEqual(m.trusted_certs[u].issuer)===true)&&(n.subject.isEqual(m.trusted_certs[u].subject)===true)&&(n.serialNumber.isEqual(m.trusted_certs[u].serialNumber)===true)){v=true;break}}if(v===false){return new Promise(function(w,i){i({result:false,result_code:22,result_message:'Self-signed root certificate not in "trusted certificates" array'})})}return(n.verify()).then(function(i){if(i===true){return d(n,n).then(function(){return new Promise(function(x,w){x(l)})},function(w){return new Promise(function(y,x){x({result:false,result_code:12,result_message:w})})})}else{return new Promise(function(x,w){w({result:false,result_code:13,result_message:"Unable to build certificate chain - signature of root certificate is invalid"})})}},function(i){return new Promise(function(x,w){w({result:false,result_code:14,result_message:i})})})}else{if(k.length>0){return r()}else{if(m.trusted_certs.length!==0){k=m.trusted_certs.splice(0);return r()}else{return new Promise(function(w,i){i({result:false,result_code:23,result_message:"Root certificate not found"})})}}}},function(i){return new Promise(function(u,j){j(i)})})}function s(j,i){if(k[i].subject.isEqual(j.issuer)===true){return j.verify({issuerCertificate:k[i]}).then(function(u){if(u===true){return d(j,k[i]).then(function(){return new Promise(function(w,v){w(i)})},function(v){return new Promise(function(x,w){w({result:false,result_code:16,result_message:v})})})}else{if(i<(k.length-1)){return s(j,i+1)}else{return new Promise(function(w,v){v({result:false,result_code:17,result_message:"Unable to build certificate chain - incomplete certificate chain or signature of some certificate is invalid"})})}}},function(u){return new Promise(function(w,v){v({result:false,result_code:18,result_message:"Unable to build certificate chain - error during certificate signature verification"})})})}else{if(i<(k.length-1)){return s(j,i+1)}else{return new Promise(function(v,u){u({result:false,result_code:19,result_message:"Unable to build certificate chain - incomplete certificate chain"})})}}}return r()};b.org.pkijs.simpl.CERT_CHAIN.prototype.verify=function(){if(this.certs.length===0){return new Promise(function(y,x){x("Empty certificate array")})}var k=Promise.resolve();var t=this;var q=new Array();q.push("2.5.29.32.0");var e=false;var j=false;var m=false;var v=new Array();var u=new Array();var p=new Array();var n=new Date();if(arguments[0] instanceof Object){if("initial_policy_set" in arguments[0]){q=arguments[0].initial_policy_set}if("initial_explicit_policy" in arguments[0]){e=arguments[0].initial_explicit_policy}if("initial_policy_mapping_inhibit" in arguments[0]){j=arguments[0].initial_policy_mapping_inhibit}if("initial_inhibit_policy" in arguments[0]){m=arguments[0].initial_inhibit_policy}if("initial_permitted_subtrees_set" in arguments[0]){v=arguments[0].initial_permitted_subtrees_set}if("initial_excluded_subtrees_set" in arguments[0]){u=arguments[0].initial_excluded_subtrees_set}if("initial_required_name_forms" in arguments[0]){p=arguments[0].initial_required_name_forms}}var h=e;var c=j;var w=m;var i=new Array(3);i[0]=false;i[1]=false;i[2]=false;var g=0;var l=0;var s=0;var d=v;var r=u;var o=p;var f=1;k=(b.org.pkijs.simpl.CERT_CHAIN.prototype.sort.call(this)).then(function(x){t.certs=x});k=k.then(function(){var N=new Array();N.push("2.5.29.32.0");var y=new Array();var O=new Array(t.certs.length-1);for(var B=0;B<(t.certs.length-1);B++){O[B]=true}y.push(O);var z=new Array(t.certs.length-1);var Q=new Array(t.certs.length-1);for(var L=(t.certs.length-2);L>=0;L--,f++){if("extensions" in t.certs[L]){for(var K=0;K<t.certs[L].extensions.length;K++){if(t.certs[L].extensions[K].extnID==="2.5.29.32"){Q[L]=t.certs[L].extensions[K].parsedValue;for(var J=0;J<t.certs[L].extensions[K].parsedValue.certificatePolicies.length;J++){var I=(-1);for(var D=0;D<N.length;D++){if(t.certs[L].extensions[K].parsedValue.certificatePolicies[J].policyIdentifier===N[D]){I=D;break}}if(I===(-1)){N.push(t.certs[L].extensions[K].parsedValue.certificatePolicies[J].policyIdentifier);var P=new Array(t.certs.length-1);P[L]=true;y.push(P)}else{(y[I])[L]=true}}}if(t.certs[L].extensions[K].extnID==="2.5.29.33"){z[L]=t.certs[L].extensions[K].parsedValue}if(t.certs[L].extensions[K].extnID==="2.5.29.36"){if(h==false){if(t.certs[L].extensions[K].parsedValue.requireExplicitPolicy===0){h=true}else{if(i[0]===false){i[0]=true;g=t.certs[L].extensions[K].parsedValue.requireExplicitPolicy}else{g=(g>t.certs[L].extensions[K].parsedValue.requireExplicitPolicy)?t.certs[L].extensions[K].parsedValue.requireExplicitPolicy:g}}if(t.certs[L].extensions[K].parsedValue.inhibitPolicyMapping===0){c=true}else{if(i[1]===false){i[1]=true;l=t.certs[L].extensions[K].parsedValue.requireExplicitPolicy}else{l=(l>t.certs[L].extensions[K].parsedValue.requireExplicitPolicy)?t.certs[L].extensions[K].parsedValue.requireExplicitPolicy:l}}}}if(t.certs[L].extensions[K].extnID==="2.5.29.54"){if(w===false){if(t.certs[L].extensions[K].parsedValue.value_block.value_dec===0){w=true}else{if(i[2]===false){i[2]=true;s=t.certs[L].extensions[K].parsedValue.value_block.value_dec}else{s=(s>t.certs[L].extensions[K].parsedValue.value_block.value_dec)?t.certs[L].extensions[K].parsedValue.value_block.value_dec:s}}}}}if(w===true){delete (y[0])[L]}if((typeof Q[L]!=="undefined")&&(typeof z[L]!=="undefined")&&(c===false)){for(var H=0;H<Q[L].certificatePolicies.length;H++){var C="";for(var G=0;G<z[L].mappings.length;G++){if(z[L].mappings[G].subjectDomainPolicy===Q[L].certificatePolicies[H].policyIdentifier){C=z[L].mappings[G].issuerDomainPolicy;break}if(z[L].mappings[G].issuerDomainPolicy===Q[L].certificatePolicies[H].policyIdentifier){C=z[L].mappings[G].subjectDomainPolicy;break}}if(C===""){continue}var M=(-1);for(var E=0;E<N.length;E++){if(N[E]===C){M=E;break}}if(M!==(-1)){(y[M])[L]=true}}}if(h===false){if(i[0]===true){g--;if(g===0){h=true;i[0]=false}}}if(c===false){if(i[1]===true){l--;if(l===0){c=true;i[1]=false}}}if(w===false){if(i[2]===true){s--;if(s===0){w=true;i[2]=false}}}}}var F=new Array();for(var L=0;L<y.length;L++){var A=true;for(var K=0;K<(t.certs.length-1);K++){if(typeof(y[L])[K]==="undefined"){A=false;break}}if(A===true){F.push(N[L])}}var x=new Array();for(var L=0;L<F.length;L++){for(var K=0;K<q.length;K++){if(q[K]===F[L]){x.push(q[K]);break}}}return{result:(x.length>0)?true:false,result_code:0,result_message:(x.length>0)?"":'Zero "user_constr_policies" array, no intersections with "auth_constr_policies"',auth_constr_policies:F,user_constr_policies:x,explicit_policy_indicator:h,policy_mappings:z}});k=k.then(function(F){function M(P,Q){var V=b.org.pkijs.stringPrep(P);var W=b.org.pkijs.stringPrep(Q);var S=V.split(".");var T=W.split(".");var R=S.length;var X=T.length;if((R===0)||(X===0)||(R<X)){return false}for(var U=0;U<R;U++){if(S[U].length===0){return false}}for(var U=0;U<X;U++){if(T[U].length===0){if(U===0){if(X===1){return false}else{continue}}return false}}for(var U=0;U<X;U++){if(T[X-1-U].length===0){continue}if(S[R-1-U].localeCompare(T[X-1-U])!==0){return false}}return true}function C(P,Q){var T=b.org.pkijs.stringPrep(P);var V=b.org.pkijs.stringPrep(Q);var R=T.split("@");var S=V.split("@");if((R.length===0)||(S.length===0)||(R.length<S.length)){return false}if(S.length===1){var X=M(R[1],S[0]);if(X){var W=R[1].split(".");var U=S[0].split(".");if(U[0].length===0){return true}if(W.length!==U.length){return false}else{return true}}else{return false}}else{return(T.localeCompare(V)===0)?true:false}return false}function D(Q,R){var V=b.org.pkijs.stringPrep(Q);var W=b.org.pkijs.stringPrep(R);var Y=V.split("/");var X=W.split("/");if(X.length>1){return false}if(Y.length>1){for(var U=0;U<Y.length;U++){if((Y[U].length>0)&&(Y[U].charAt(Y[U].length-1)!==":")){var P=Y[U].split(":");V=P[0];break}}}var Z=M(V,W);if(Z){var S=V.split(".");var T=W.split(".");if(T[0].length===0){return true}if(S.length!==T.length){return false}else{return true}}else{return false}return false}function N(Q,T){var S=new Uint8Array(Q.value_block.value_hex);var P=new Uint8Array(T.value_block.value_hex);if((S.length===4)&&(P.length===8)){for(var R=0;R<4;R++){if((S[R]^P[R])&P[R+4]){return false}}return true}if((S.length===16)&&(P.length===32)){for(var R=0;R<16;R++){if((S[R]^P[R])&P[R+16]){return false}}return true}return false}function x(S,V){if((S.types_and_values.length===0)||(V.types_and_values.length===0)){return true}if(S.types_and_values.length<V.types_and_values.length){return false}var P=true;var U=0;for(var T=0;T<V.types_and_values.length;T++){var Q=false;for(var R=U;R<S.types_and_values.length;R++){Q=S.types_and_values[R].isEqual(V.types_and_values[T]);if(S.types_and_values[R].type===V.types_and_values[T].type){P=P&&Q}if(Q===true){if((U===0)||(U===R)){U=R+1;break}else{return false}}}if(Q===false){return false}}return(U===0)?false:P}if(F.result===false){return F}f=1;for(var L=(t.certs.length-2);L>=0;L--,f++){var O=new Array();var G=new Array();var z=new Array();if("extensions" in t.certs[L]){for(var K=0;K<t.certs[L].extensions.length;K++){if(t.certs[L].extensions[K].extnID==="2.5.29.30"){if("permittedSubtrees" in t.certs[L].extensions[K].parsedValue){G=G.concat(t.certs[L].extensions[K].parsedValue.permittedSubtrees)}if("excludedSubtrees" in t.certs[L].extensions[K].parsedValue){z=z.concat(t.certs[L].extensions[K].parsedValue.excludedSubtrees)}}if(t.certs[L].extensions[K].extnID==="2.5.29.17"){O=O.concat(t.certs[L].extensions[K].parsedValue.altNames)}if(t.certs[L].extensions[K].extnID==="1.2.840.113549.1.9.1"){email_addresses.push(t.certs[L].extensions[K].parsedValue.value)}}}var y=(o.length>0)?false:true;for(var K=0;K<o.length;K++){switch(o[K].base.NameType){case 4:if(o[K].base.Name.types_and_values.length!==t.certs[L].subject.types_and_values.length){continue}y=true;for(var J=0;J<t.certs[L].subject.types_and_values.length;J++){if(t.certs[L].subject.types_and_values[J].type!==o[K].base.Name.types_and_values[J].type){y=false;break}}if(y===true){break}break;default:}}if(y===false){F.result=false;F.result_code=21;F.result_message="No neccessary name form found";return new Promise(function(Q,P){P(F)})}var A=new Array();A[0]=new Array();A[1]=new Array();A[2]=new Array();A[3]=new Array();A[4]=new Array();for(var K=0;K<d.length;K++){switch(d[K].base.NameType){case 1:A[0].push(d[K]);break;case 2:A[1].push(d[K]);break;case 4:A[2].push(d[K]);break;case 6:A[3].push(d[K]);break;case 7:A[4].push(d[K]);break;default:}}for(var I=0;I<5;I++){var H=false;var B=A[I];for(var K=0;K<B.length;K++){switch(I){case 0:if(O.length>=0){for(var J=0;J<O.length;J++){if(O[J].NameType===1){H=H||C(O[J].Name,B[K].base.Name)}}}else{for(var J=0;J<t.certs[L].subject.types_and_values.length;J++){if((t.certs[L].subject.types_and_values[J].type==="1.2.840.113549.1.9.1")||(t.certs[L].subject.types_and_values[J].type==="0.9.2342.19200300.100.1.3")){H=H||C(t.certs[L].subject.types_and_values[J].value.value_block.value,B[K].base.Name)}}}break;case 1:if(O.length>0){for(var J=0;J<O.length;J++){if(O[J].NameType===2){H=H||M(O[J].Name,B[K].base.Name)}}}break;case 2:H=x(t.certs[L].subject,B[K].base.Name);break;case 3:if(O.length>0){for(var J=0;J<O.length;J++){if(O[J].NameType===6){H=H||D(O[J].Name,B[K].base.Name)}}}break;case 4:if(O.length>0){for(var J=0;J<O.length;J++){if(O[J].NameType===7){H=H||N(O[J].Name,B[K].base.Name)}}}break;default:}if(H){break}}if((H===false)&&(B.length>0)){F.result=false;F.result_code=41;F.result_message='Failed to meet "permitted sub-trees" name constraint';return new Promise(function(Q,P){P(F)})}}var E=false;for(var K=0;K<r.length;K++){switch(r[K].base.NameType){case 1:if(O.length>=0){for(var J=0;J<O.length;J++){if(O[J].NameType===1){E=E||C(O[J].Name,r[K].base.Name)}}}else{for(var J=0;J<t.subject.types_and_values.length;J++){if((t.subject.types_and_values[J].type==="1.2.840.113549.1.9.1")||(t.subject.types_and_values[J].type==="0.9.2342.19200300.100.1.3")){E=E||C(t.subject.types_and_values[J].value.value_block.value,r[K].base.Name)}}}break;case 2:if(O.length>0){for(var J=0;J<O.length;J++){if(O[J].NameType===2){E=E||M(O[J].Name,r[K].base.Name)}}}break;case 4:E=E||x(t.certs[L].subject,r[K].base.Name);break;case 6:if(O.length>0){for(var J=0;J<O.length;J++){if(O[J].NameType===6){E=E||D(O[J].Name,r[K].base.Name)}}}break;case 7:if(O.length>0){for(var J=0;J<O.length;J++){if(O[J].NameType===7){E=E||N(O[J].Name,r[K].base.Name)}}}break;default:}if(E){break}}if(E===true){F.result=false;F.result_code=42;F.result_message='Failed to meet "excluded sub-trees" name constraint';return new Promise(function(Q,P){P(F)})}d=d.concat(G);r=r.concat(z)}return F});return k}})(typeof exports!=="undefined"?exports:window);